high_text,low_text,label
  The DPU-BOOT CSC shall include a DRAM BIT consisting of two write/read/compare tests.  The first test shall write the address of each memory location to that location.  The second test shall write the complement of each memory location to that location.," Startup SequenceThe DPU FSW is booted using PROM-resident bootstrap software.  The bootstrap software performs a basic set of built-in tests, then copies the DPU FSW from EEPROM to DRAM and executes it.  In flight, there are two methods which can trigger the DPU FSW to boot:* power-on (cold boot), or* watchdog reset (warm boot, commanded reboot).",1
  The DPU-BOOT CSC shall include a DRAM BIT consisting of two write/read/compare tests.  The first test shall write the address of each memory location to that location.  The second test shall write the complement of each memory location to that location.,"initial boot sequencethe initial boot sequence, identified as Boot Sequence 1.  This processing takes place when the Bootstrap executes from Programmable Read-Only Memory (PROM).  Boot Sequence 1 is composed primarily of 4 steps as follows.First, in this sequence, EEPROM is updated.  Then, CPU BIT and a portion of DRAM BIT is performed.  Next, DRAM is cleared.  Lastly, Boot Sequence 2 is copied to DRAM and executed. During this sequence, the rest of DRAM is tested if skipBit is not set.  Load parameters are put into registers r13, r14, r15 and r16.  DRAM is cleared up to memSize.  Lastly, either the DPU-RTOS or the Bootstrap Monitor is loaded and executed according to the load parameters.",1
  The DPU-BOOT CSC shall include a DRAM BIT consisting of two write/read/compare tests.  The first test shall write the address of each memory location to that location.  The second test shall write the complement of each memory location to that location.,"DRAM BITPart of the memory is tested in Boot Sequence 1, and part of the memory is tested during Boot Sequence 2.  During Boot Sequence 1, ? KB of DRAM is tested before the Bootstrap is copied to this area.  During Boot Sequence 2, the  remaining memory is tested in ? KB blocks. The DRAM BIT first writes the address of each word in a block to that word in the block.   Then the test flushes the cache and reads back the entire block.  If a single-bit error occurs on the read-back, the location is read again.  If another single-bit error occurs, the test assumes a hard error and marks the whole block bad.  If a multiple-bit error occurs, the whole block is marked bad.  If the value read back does not match the address, the whole block is marked bad.  This same process is repeated with the ones complement of the address. The Bootstrap stores the results of the DRAM BIT in EEPROM as a series of x consecutive y-bit words.  Each bit in a result word represents the result of testing a ? KB block of DRAM.  These bits are mapped to DRAM by proceeding from least-significant bit (LSb) to most-significant bit (MSb) as the addresses of the memory blocks increase.  A set bit indicates that a block of DRAM has failed.  A clear bit indicates that a block of DRAM has passed the test.",1
"  The DPU-BOOT CSC shall create a record of failed DRAM blocks, BIT_DRAM, in the SYSTEM_BLOCK.","initial boot sequencethe initial boot sequence, identified as Boot Sequence 1.  This processing takes place when the Bootstrap executes from Programmable Read-Only Memory (PROM).  Boot Sequence 1 is composed primarily of 4 steps as follows.First, in this sequence, EEPROM is updated.  Then, CPU BIT and a portion of DRAM BIT is performed.  Next, DRAM is cleared.  Lastly, Boot Sequence 2 is copied to DRAM and executed. During this sequence, the rest of DRAM is tested if skipBit is not set.  Load parameters are put into registers r13, r14, r15 and r16.  DRAM is cleared up to memSize.  Lastly, either the DPU-RTOS or the Bootstrap Monitor is loaded and executed according to the load parameters.",1
"  The DPU-BOOT CSC shall create a record of failed DRAM blocks, BIT_DRAM, in the SYSTEM_BLOCK.","DRAM BITPart of the memory is tested in Boot Sequence 1, and part of the memory is tested during Boot Sequence 2.  During Boot Sequence 1, ? KB of DRAM is tested before the Bootstrap is copied to this area.  During Boot Sequence 2, the  remaining memory is tested in ? KB blocks. The DRAM BIT first writes the address of each word in a block to that word in the block.   Then the test flushes the cache and reads back the entire block.  If a single-bit error occurs on the read-back, the location is read again.  If another single-bit error occurs, the test assumes a hard error and marks the whole block bad.  If a multiple-bit error occurs, the whole block is marked bad.  If the value read back does not match the address, the whole block is marked bad.  This same process is repeated with the ones complement of the address. The Bootstrap stores the results of the DRAM BIT in EEPROM as a series of x consecutive y-bit words.  Each bit in a result word represents the result of testing a ? KB block of DRAM.  These bits are mapped to DRAM by proceeding from least-significant bit (LSb) to most-significant bit (MSb) as the addresses of the memory blocks increase.  A set bit indicates that a block of DRAM has failed.  A clear bit indicates that a block of DRAM has passed the test.",1
"  The DPU-BOOT CSC shall create a record of failed DRAM blocks, BIT_DRAM, in the SYSTEM_BLOCK.","Exclude Failed DRAMThe Bootstrap performs a memory test before loading the operating system.  The results of this test are stored in the EEPROM.  The DPU-RTOS uses the results of the memory test to exclude memory segments with bit errors from the system memory pool. The Bootstrap constructs a bit map which effectively implements a list of failed memory blocks during the bootstrap built-in test.  A set of functions have been created to utilize this  bit map to exclude failed memory blocks from the VxWorks system memory pool.  The system memory pool is used by VxWorks to allocate memory dynamically.  In addition, a linked list of good memory segments is created for use by the EDAC Memory Scrubber.  These functions are called from the usrInit() and usrRoot() functions in usrConfig.c.  The dramInit() function must be called prior to kernelInit() in usrInit().  The dramBuildMemPool() function is called just prior to initialization of filesystems and drivers in usrRoot().",1
"  The DPU-BOOT CSC shall create a record of failed DRAM blocks, BIT_DRAM, in the SYSTEM_BLOCK.","Built-In Test CSCThe Built-In Test (BIT) CSC is a Level 2 reuse component from the SSFF and INSTRUMENT Y projects.  The detailed design of the BIT CSC follows. The Built-In Tests CSC, identified DPU-BIT, performs the Stage 2 Built-In Tests (BIT).  The Stage 2 BIT includes a test of the SCM EDAC circuit, a checksum test on SCM PROM, a MIL-STD-1553B internal BIT, and a memory test of the DCI Data Buffers. The results of the BIT are recorded in the SYS_CNFG_AREA in EEPROM and are also maintained in DRAM.  If an error occurs in one of the functions performing the BIT, the test result will be reported as a failure in the test itself.",1
"  The DPU-BOOT CSC shall create a record of failed DRAM blocks, BIT_DRAM, in the SYSTEM_BLOCK.",External Program InterfacesReads the BIT results from the location pointed to by pBitResults (which is assumed to be in EEPROM) into the BIT results data structure in DRAM.,1
  The DPU-BOOT CSC shall provide a monitor which accepts commands over the RS-232 interface.,"Bootstrap MonitorThe Bootstrap Monitor checks entered commands for syntax and number of arguments, and displays an error message to the RS-232 interface if an invalid command or argument is entered.  A complete listing of these messages is given in document 7384-BSPS-01.",1
"  The Bootstrap Monitor of the DPU-BOOT CSC shall provide the capability to read from Dynamic Random Access Memory (DRAM), the VME bus, and the Input/Output Channel Controller (IOCC) on command.","Built-In TestThere are two stages of Built-In Tests (BIT) for the DPU.  The Stage 1 BIT is included in the Bootstrap program and consists of Central Processing Unit (CPU) BIT, and Dynamic Random Access Memory (DRAM) BIT.  The Stage 2 BIT is executed after the operating system is booted and is not part of the Bootstrap program.",1
"  The Bootstrap Monitor of the DPU-BOOT CSC shall provide the capability to write to Dynamic Random Access Memory (DRAM), the VME bus, and the Input/Output Channel Controller (IOCC) on command.","Built-In TestThere are two stages of Built-In Tests (BIT) for the DPU.  The Stage 1 BIT is included in the Bootstrap program and consists of Central Processing Unit (CPU) BIT, and Dynamic Random Access Memory (DRAM) BIT.  The Stage 2 BIT is executed after the operating system is booted and is not part of the Bootstrap program.",1
"  The Bootstrap Monitor of the DPU-BOOT CSC shall provide the capability to write to Dynamic Random Access Memory (DRAM), the VME bus, and the Input/Output Channel Controller (IOCC) on command.",Generic VME Driver CSCThe Generic VME (GVME) Driver CSC is a Level 1 reuse component from the INSTRUMENT Y project.  The GVME Driver provides a set of convenience routines which are useful when accessing registers and memory in the VME memory space.,1
  The Bootstrap Monitor of the DPU-BOOT CSC shall provide the capability to download configurations of the DPU-RTOS from the RS-232 interface to EEPROM on command.,"initial boot sequencethe initial boot sequence, identified as Boot Sequence 1.  This processing takes place when the Bootstrap executes from Programmable Read-Only Memory (PROM).  Boot Sequence 1 is composed primarily of 4 steps as follows.First, in this sequence, EEPROM is updated.  Then, CPU BIT and a portion of DRAM BIT is performed.  Next, DRAM is cleared.  Lastly, Boot Sequence 2 is copied to DRAM and executed. During this sequence, the rest of DRAM is tested if skipBit is not set.  Load parameters are put into registers r13, r14, r15 and r16.  DRAM is cleared up to memSize.  Lastly, either the DPU-RTOS or the Bootstrap Monitor is loaded and executed according to the load parameters.",1
  The Bootstrap Monitor of the DPU-BOOT CSC shall provide the capability to load a configuration of the DPU-RTOS from EEPROM to DRAM and start its execution on command.," Startup Sequence On flight, a power cycle can only be effected by the SCU.  A watchdog reset could be induced by the DPU FSW due to a detected, unrecoverable error, or it could occur as a by-product of the FSW entering a state in which it fails to strobe the watchdog timer.  On boot, the bootstrap tests and clears DRAM, and then proceeds to load the DPU FSW from EEPROM and executes it.  The DPU FSW then loads configuration information from EEPROM (which establishes various operational defaults) and spawns the various DPU FSW tasks. ",1
  The Bootstrap Monitor of the DPU-BOOT CSC shall provide the capability to load a configuration of the DPU-RTOS from EEPROM to DRAM and start its execution on command.,"initial boot sequencethe initial boot sequence, identified as Boot Sequence 1.  This processing takes place when the Bootstrap executes from Programmable Read-Only Memory (PROM).  Boot Sequence 1 is composed primarily of 4 steps as follows.First, in this sequence, EEPROM is updated.  Then, CPU BIT and a portion of DRAM BIT is performed.  Next, DRAM is cleared.  Lastly, Boot Sequence 2 is copied to DRAM and executed. During this sequence, the rest of DRAM is tested if skipBit is not set.  Load parameters are put into registers r13, r14, r15 and r16.  DRAM is cleared up to memSize.  Lastly, either the DPU-RTOS or the Bootstrap Monitor is loaded and executed according to the load parameters.",1
  The Bootstrap Monitor of the DPU-BOOT CSC shall provide the capability to load a configuration of the DPU-RTOS from EEPROM to DRAM and start its execution on command.,"Hardware InterfacesThe DPU-BOOTSTRAP must interface directly with the EEPROM on the Company X Communication Module.  The DPU-BOOTSTRAP accesses EEPROM as ?-bit words only.  The specific timing requirements of the EEPROM are satisfied in one of three ways:* the timing requirements are met by inserting specific wait loops (typical),* the timing requirements are met by use of the EEPROM Driver (DOWNLOAD command), andthe timing requirements are met implicitly by the amount of time which will be required to execute the intervening instructions regardless of the CPU speed setting (DRAM test logic).",1
The DPU-BOOT CSC shall test and clear DRAM on power-on using the COLD_MEM_SIZE obtained from the SYSTEM_BLOCK.,"initial boot sequencethe initial boot sequence, identified as Boot Sequence 1.  This processing takes place when the Bootstrap executes from Programmable Read-Only Memory (PROM).  Boot Sequence 1 is composed primarily of 4 steps as follows.First, in this sequence, EEPROM is updated.  Then, CPU BIT and a portion of DRAM BIT is performed.  Next, DRAM is cleared.  Lastly, Boot Sequence 2 is copied to DRAM and executed. During this sequence, the rest of DRAM is tested if skipBit is not set.  Load parameters are put into registers r13, r14, r15 and r16.  DRAM is cleared up to memSize.  Lastly, either the DPU-RTOS or the Bootstrap Monitor is loaded and executed according to the load parameters.",1
  The DPU-BOOT CSC shall provide the capability to automatically load a configuration of DPU-RTOS from EEPROM to DRAM and start its execution.," Startup SequenceThe DPU FSW is booted using PROM-resident bootstrap software.  The bootstrap software performs a basic set of built-in tests, then copies the DPU FSW from EEPROM to DRAM and executes it.  In flight, there are two methods which can trigger the DPU FSW to boot:* power-on (cold boot), or* watchdog reset (warm boot, commanded reboot).",1
  The DPU-BOOT CSC shall provide the capability to automatically load a configuration of DPU-RTOS from EEPROM to DRAM and start its execution.," Startup Sequence On flight, a power cycle can only be effected by the SCU.  A watchdog reset could be induced by the DPU FSW due to a detected, unrecoverable error, or it could occur as a by-product of the FSW entering a state in which it fails to strobe the watchdog timer.  On boot, the bootstrap tests and clears DRAM, and then proceeds to load the DPU FSW from EEPROM and executes it.  The DPU FSW then loads configuration information from EEPROM (which establishes various operational defaults) and spawns the various DPU FSW tasks. ",1
  The DPU-BOOT CSC shall provide the capability to automatically load a configuration of DPU-RTOS from EEPROM to DRAM and start its execution.,"initial boot sequencethe initial boot sequence, identified as Boot Sequence 1.  This processing takes place when the Bootstrap executes from Programmable Read-Only Memory (PROM).  Boot Sequence 1 is composed primarily of 4 steps as follows.First, in this sequence, EEPROM is updated.  Then, CPU BIT and a portion of DRAM BIT is performed.  Next, DRAM is cleared.  Lastly, Boot Sequence 2 is copied to DRAM and executed. During this sequence, the rest of DRAM is tested if skipBit is not set.  Load parameters are put into registers r13, r14, r15 and r16.  DRAM is cleared up to memSize.  Lastly, either the DPU-RTOS or the Bootstrap Monitor is loaded and executed according to the load parameters.",1
  The DPU-BOOT CSC shall provide the capability to automatically load a configuration of DPU-RTOS from EEPROM to DRAM and start its execution.,External Program InterfacesReads the BIT results from the location pointed to by pBitResults (which is assumed to be in EEPROM) into the BIT results data structure in DRAM.,1
"  The DPU-BOOT CSC shall include a CPU BIT consisting of a branch test, a fixed point test, a floating point test, an interrupt test, a timer test, and a register test.","CPU BITThe CPU BIT consists of a series of tests designed to test each of the functional units of the processor.  These include test for the Branch-Unit, the Fixed-Point Unit, the Floating-Point Unit, the Interrupt-Unit, and the Timer Unit.   Each of these tests consists of executing a few selected instructions from the this functional unit. The General Purpose Registers (GPR), the Segment Registers (SR), the Counter Register (CTR), and the Condition Register are tested for stuck-bits as part of the Branch-Unit test.  This is done by writing a 1s pattern (verified by reading it back) and then writing a 0s pattern (verified by reading it back).",1
  The DPU-BOOT CSC shall create a record of the CPU BIT in the SYSTEM_BLOCK.,"CPU BITThe CPU BIT consists of a series of tests designed to test each of the functional units of the processor.  These include test for the Branch-Unit, the Fixed-Point Unit, the Floating-Point Unit, the Interrupt-Unit, and the Timer Unit.   Each of these tests consists of executing a few selected instructions from the this functional unit. The General Purpose Registers (GPR), the Segment Registers (SR), the Counter Register (CTR), and the Condition Register are tested for stuck-bits as part of the Branch-Unit test.  This is done by writing a 1s pattern (verified by reading it back) and then writing a 0s pattern (verified by reading it back).",1
  The DPU-BOOT CSC shall create a record of the CPU BIT in the SYSTEM_BLOCK.,"Exclude Failed DRAMThe Bootstrap performs a memory test before loading the operating system.  The results of this test are stored in the EEPROM.  The DPU-RTOS uses the results of the memory test to exclude memory segments with bit errors from the system memory pool. The Bootstrap constructs a bit map which effectively implements a list of failed memory blocks during the bootstrap built-in test.  A set of functions have been created to utilize this  bit map to exclude failed memory blocks from the VxWorks system memory pool.  The system memory pool is used by VxWorks to allocate memory dynamically.  In addition, a linked list of good memory segments is created for use by the EDAC Memory Scrubber.  These functions are called from the usrInit() and usrRoot() functions in usrConfig.c.  The dramInit() function must be called prior to kernelInit() in usrInit().  The dramBuildMemPool() function is called just prior to initialization of filesystems and drivers in usrRoot().",1
  The DPU-BOOT CSC shall create a record of the CPU BIT in the SYSTEM_BLOCK.,"Built-In Test CSCThe Built-In Test (BIT) CSC is a Level 2 reuse component from the SSFF and INSTRUMENT Y projects.  The detailed design of the BIT CSC follows. The Built-In Tests CSC, identified DPU-BIT, performs the Stage 2 Built-In Tests (BIT).  The Stage 2 BIT includes a test of the SCM EDAC circuit, a checksum test on SCM PROM, a MIL-STD-1553B internal BIT, and a memory test of the DCI Data Buffers. The results of the BIT are recorded in the SYS_CNFG_AREA in EEPROM and are also maintained in DRAM.  If an error occurs in one of the functions performing the BIT, the test result will be reported as a failure in the test itself.",1
"  The DPU-BOOT CSC shall complete Stage 1 BIT, and load DPU-RTOS in less than A seconds following a hardware reset if CTS is not asserted."," Startup Sequence On flight, a power cycle can only be effected by the SCU.  A watchdog reset could be induced by the DPU FSW due to a detected, unrecoverable error, or it could occur as a by-product of the FSW entering a state in which it fails to strobe the watchdog timer.  On boot, the bootstrap tests and clears DRAM, and then proceeds to load the DPU FSW from EEPROM and executes it.  The DPU FSW then loads configuration information from EEPROM (which establishes various operational defaults) and spawns the various DPU FSW tasks. ",1
"  The DPU-BOOT CSC shall complete Stage 1 BIT, and load DPU-RTOS in less than A seconds following a hardware reset if CTS is not asserted.","initial boot sequencethe initial boot sequence, identified as Boot Sequence 1.  This processing takes place when the Bootstrap executes from Programmable Read-Only Memory (PROM).  Boot Sequence 1 is composed primarily of 4 steps as follows.First, in this sequence, EEPROM is updated.  Then, CPU BIT and a portion of DRAM BIT is performed.  Next, DRAM is cleared.  Lastly, Boot Sequence 2 is copied to DRAM and executed. During this sequence, the rest of DRAM is tested if skipBit is not set.  Load parameters are put into registers r13, r14, r15 and r16.  DRAM is cleared up to memSize.  Lastly, either the DPU-RTOS or the Bootstrap Monitor is loaded and executed according to the load parameters.",1
"  The DPU-BOOT CSC shall complete Stage 1 BIT, and load DPU-RTOS in less than A seconds following a hardware reset if CTS is not asserted.","Built-In TestThere are two stages of Built-In Tests (BIT) for the DPU.  The Stage 1 BIT is included in the Bootstrap program and consists of Central Processing Unit (CPU) BIT, and Dynamic Random Access Memory (DRAM) BIT.  The Stage 2 BIT is executed after the operating system is booted and is not part of the Bootstrap program.",1
"  The DPU-BOOT CSC shall complete Stage 1 BIT, and load DPU-RTOS in less than A seconds following a hardware reset if CTS is not asserted.","Built-In Test CSCThe Built-In Test (BIT) CSC is a Level 2 reuse component from the SSFF and INSTRUMENT Y projects.  The detailed design of the BIT CSC follows. The Built-In Tests CSC, identified DPU-BIT, performs the Stage 2 Built-In Tests (BIT).  The Stage 2 BIT includes a test of the SCM EDAC circuit, a checksum test on SCM PROM, a MIL-STD-1553B internal BIT, and a memory test of the DCI Data Buffers. The results of the BIT are recorded in the SYS_CNFG_AREA in EEPROM and are also maintained in DRAM.  If an error occurs in one of the functions performing the BIT, the test result will be reported as a failure in the test itself.",1
  The DPU-BOOT CSC shall attempt to complete its normal execution sequence following detection of any failure.,"DRAM BITPart of the memory is tested in Boot Sequence 1, and part of the memory is tested during Boot Sequence 2.  During Boot Sequence 1, ? KB of DRAM is tested before the Bootstrap is copied to this area.  During Boot Sequence 2, the  remaining memory is tested in ? KB blocks. The DRAM BIT first writes the address of each word in a block to that word in the block.   Then the test flushes the cache and reads back the entire block.  If a single-bit error occurs on the read-back, the location is read again.  If another single-bit error occurs, the test assumes a hard error and marks the whole block bad.  If a multiple-bit error occurs, the whole block is marked bad.  If the value read back does not match the address, the whole block is marked bad.  This same process is repeated with the ones complement of the address. The Bootstrap stores the results of the DRAM BIT in EEPROM as a series of x consecutive y-bit words.  Each bit in a result word represents the result of testing a ? KB block of DRAM.  These bits are mapped to DRAM by proceeding from least-significant bit (LSb) to most-significant bit (MSb) as the addresses of the memory blocks increase.  A set bit indicates that a block of DRAM has failed.  A clear bit indicates that a block of DRAM has passed the test.",1
  The DPU-BOOT CSC shall attempt to complete its normal execution sequence following detection of any failure.,"Exclude Failed DRAMThe Bootstrap performs a memory test before loading the operating system.  The results of this test are stored in the EEPROM.  The DPU-RTOS uses the results of the memory test to exclude memory segments with bit errors from the system memory pool. The Bootstrap constructs a bit map which effectively implements a list of failed memory blocks during the bootstrap built-in test.  A set of functions have been created to utilize this  bit map to exclude failed memory blocks from the VxWorks system memory pool.  The system memory pool is used by VxWorks to allocate memory dynamically.  In addition, a linked list of good memory segments is created for use by the EDAC Memory Scrubber.  These functions are called from the usrInit() and usrRoot() functions in usrConfig.c.  The dramInit() function must be called prior to kernelInit() in usrInit().  The dramBuildMemPool() function is called just prior to initialization of filesystems and drivers in usrRoot().",1
  The DPU-BOOT CSC shall attempt to complete its normal execution sequence following detection of any failure.,"Built-In Test CSCThe Built-In Test (BIT) CSC is a Level 2 reuse component from the SSFF and INSTRUMENT Y projects.  The detailed design of the BIT CSC follows. The Built-In Tests CSC, identified DPU-BIT, performs the Stage 2 Built-In Tests (BIT).  The Stage 2 BIT includes a test of the SCM EDAC circuit, a checksum test on SCM PROM, a MIL-STD-1553B internal BIT, and a memory test of the DCI Data Buffers. The results of the BIT are recorded in the SYS_CNFG_AREA in EEPROM and are also maintained in DRAM.  If an error occurs in one of the functions performing the BIT, the test result will be reported as a failure in the test itself.",1
  The DPU-BOOT CSC shall attempt to complete its normal execution sequence following detection of any failure.,Error Detection and Correction CSCThe Error Detection and Correction (EDAC) CSC is a Level 1 reuse component from the SSFF and INSTRUMENT Y projects.  The EDAC CSC consists of a set of Interrupt Service Routines (ISRs) and a Memory Scrubber Task.  The design of the INSTRUMENT Y EDAC CSC is described in document CIDPSDS-01.The only design change was to add logic to check for excessive external (SCM) EDAC interrupts.,1
The DPU-BOOT CSC shall disable write-protection of the EEPROM on the SCM.,"Built-In Test CSCThe Built-In Test (BIT) CSC is a Level 2 reuse component from the SSFF and INSTRUMENT Y projects.  The detailed design of the BIT CSC follows. The Built-In Tests CSC, identified DPU-BIT, performs the Stage 2 Built-In Tests (BIT).  The Stage 2 BIT includes a test of the SCM EDAC circuit, a checksum test on SCM PROM, a MIL-STD-1553B internal BIT, and a memory test of the DCI Data Buffers. The results of the BIT are recorded in the SYS_CNFG_AREA in EEPROM and are also maintained in DRAM.  If an error occurs in one of the functions performing the BIT, the test result will be reported as a failure in the test itself.",1
The DPU-BOOT CSC shall enable EDAC on the SCM.,"Built-In Test CSCThe Built-In Test (BIT) CSC is a Level 2 reuse component from the SSFF and INSTRUMENT Y projects.  The detailed design of the BIT CSC follows. The Built-In Tests CSC, identified DPU-BIT, performs the Stage 2 Built-In Tests (BIT).  The Stage 2 BIT includes a test of the SCM EDAC circuit, a checksum test on SCM PROM, a MIL-STD-1553B internal BIT, and a memory test of the DCI Data Buffers. The results of the BIT are recorded in the SYS_CNFG_AREA in EEPROM and are also maintained in DRAM.  If an error occurs in one of the functions performing the BIT, the test result will be reported as a failure in the test itself.",1
The DPU-BOOT CSC shall enable EDAC on the SCM.,"InitializationThe DPU-BIT should be initialized every time the DPU boots.  The startup task, usrRoot() should call bitPart1() before initializing the device drivers and bitPart2() after initializing EDAC and the device drivers.",1
The DPU-BOOT CSC shall enable EDAC on the SCM.,"External Program InterfacesPerforms the SCM EDAC test, PROM checksum test, and device loopback tests for those devices which support it.",1
  The DPU-BOOT CSC shall log detected BIT failures to the SYSTEM_BLOCK.,"Built-In TestThere are two stages of Built-In Tests (BIT) for the DPU.  The Stage 1 BIT is included in the Bootstrap program and consists of Central Processing Unit (CPU) BIT, and Dynamic Random Access Memory (DRAM) BIT.  The Stage 2 BIT is executed after the operating system is booted and is not part of the Bootstrap program.",1
  The DPU-BOOT CSC shall log detected BIT failures to the SYSTEM_BLOCK.,"DRAM BITPart of the memory is tested in Boot Sequence 1, and part of the memory is tested during Boot Sequence 2.  During Boot Sequence 1, ? KB of DRAM is tested before the Bootstrap is copied to this area.  During Boot Sequence 2, the  remaining memory is tested in ? KB blocks. The DRAM BIT first writes the address of each word in a block to that word in the block.   Then the test flushes the cache and reads back the entire block.  If a single-bit error occurs on the read-back, the location is read again.  If another single-bit error occurs, the test assumes a hard error and marks the whole block bad.  If a multiple-bit error occurs, the whole block is marked bad.  If the value read back does not match the address, the whole block is marked bad.  This same process is repeated with the ones complement of the address. The Bootstrap stores the results of the DRAM BIT in EEPROM as a series of x consecutive y-bit words.  Each bit in a result word represents the result of testing a ? KB block of DRAM.  These bits are mapped to DRAM by proceeding from least-significant bit (LSb) to most-significant bit (MSb) as the addresses of the memory blocks increase.  A set bit indicates that a block of DRAM has failed.  A clear bit indicates that a block of DRAM has passed the test.",1
  The DPU-BOOT CSC shall log detected BIT failures to the SYSTEM_BLOCK.,"Exclude Failed DRAMThe Bootstrap performs a memory test before loading the operating system.  The results of this test are stored in the EEPROM.  The DPU-RTOS uses the results of the memory test to exclude memory segments with bit errors from the system memory pool. The Bootstrap constructs a bit map which effectively implements a list of failed memory blocks during the bootstrap built-in test.  A set of functions have been created to utilize this  bit map to exclude failed memory blocks from the VxWorks system memory pool.  The system memory pool is used by VxWorks to allocate memory dynamically.  In addition, a linked list of good memory segments is created for use by the EDAC Memory Scrubber.  These functions are called from the usrInit() and usrRoot() functions in usrConfig.c.  The dramInit() function must be called prior to kernelInit() in usrInit().  The dramBuildMemPool() function is called just prior to initialization of filesystems and drivers in usrRoot().",1
  The DPU-BOOT CSC shall log detected BIT failures to the SYSTEM_BLOCK.,"Built-In Test CSCThe Built-In Test (BIT) CSC is a Level 2 reuse component from the SSFF and INSTRUMENT Y projects.  The detailed design of the BIT CSC follows. The Built-In Tests CSC, identified DPU-BIT, performs the Stage 2 Built-In Tests (BIT).  The Stage 2 BIT includes a test of the SCM EDAC circuit, a checksum test on SCM PROM, a MIL-STD-1553B internal BIT, and a memory test of the DCI Data Buffers. The results of the BIT are recorded in the SYS_CNFG_AREA in EEPROM and are also maintained in DRAM.  If an error occurs in one of the functions performing the BIT, the test result will be reported as a failure in the test itself.",1
  The DPU-BOOT CSC shall log detected BIT failures to the SYSTEM_BLOCK.,External Program InterfacesReads the BIT results from the location pointed to by pBitResults (which is assumed to be in EEPROM) into the BIT results data structure in DRAM.,1
  The DPU-BOOT CSC shall display a message via RS-232 on detection of a BIT failure.,"Built-In Test CSCThe Built-In Test (BIT) CSC is a Level 2 reuse component from the SSFF and INSTRUMENT Y projects.  The detailed design of the BIT CSC follows. The Built-In Tests CSC, identified DPU-BIT, performs the Stage 2 Built-In Tests (BIT).  The Stage 2 BIT includes a test of the SCM EDAC circuit, a checksum test on SCM PROM, a MIL-STD-1553B internal BIT, and a memory test of the DCI Data Buffers. The results of the BIT are recorded in the SYS_CNFG_AREA in EEPROM and are also maintained in DRAM.  If an error occurs in one of the functions performing the BIT, the test result will be reported as a failure in the test itself.",1
  The DPU-BOOT CSC shall initialize the BIT_DATA in the SYSTEM_BLOCK to the incomplete/failure state prior to executing Stage 1 BIT.,"initial boot sequencethe initial boot sequence, identified as Boot Sequence 1.  This processing takes place when the Bootstrap executes from Programmable Read-Only Memory (PROM).  Boot Sequence 1 is composed primarily of 4 steps as follows.First, in this sequence, EEPROM is updated.  Then, CPU BIT and a portion of DRAM BIT is performed.  Next, DRAM is cleared.  Lastly, Boot Sequence 2 is copied to DRAM and executed. During this sequence, the rest of DRAM is tested if skipBit is not set.  Load parameters are put into registers r13, r14, r15 and r16.  DRAM is cleared up to memSize.  Lastly, either the DPU-RTOS or the Bootstrap Monitor is loaded and executed according to the load parameters.",1
  The Bootstrap Monitor of the DPU-BOOT CSC shall validate commands entered for syntax and number of arguments.,"Bootstrap MonitorThe Bootstrap Monitor checks entered commands for syntax and number of arguments, and displays an error message to the RS-232 interface if an invalid command or argument is entered.  A complete listing of these messages is given in document 7384-BSPS-01.",1
  The Bootstrap Monitor of the DPU-BOOT CSC shall output an error message to the RS-232 interface if an invalid command argument option is entered.,"Bootstrap MonitorThe Bootstrap Monitor checks entered commands for syntax and number of arguments, and displays an error message to the RS-232 interface if an invalid command or argument is entered.  A complete listing of these messages is given in document 7384-BSPS-01.",1
  The Bootstrap Monitor of the DPU-BOOT CSC shall output an error message to the RS-232 interface if an incorrect number of command arguments are entered.,"Bootstrap MonitorThe Bootstrap Monitor checks entered commands for syntax and number of arguments, and displays an error message to the RS-232 interface if an invalid command or argument is entered.  A complete listing of these messages is given in document 7384-BSPS-01.",1
  The Bootstrap Monitor of the DPU-BOOT CSC shall output an error message to the RS-232 interface if an incorrect number of command arguments are entered.,"Install Project-Specific Module Error IdentifiersIn order to provide a mechanism by which error numbers can be unique across device drivers and applications, each error number must contain a unique module identifier in the most significant word of the error number.  These module identifiers are defined in a VxWorks header file.",1
"  At the end of a download, the Bootstrap Monitor of the DPU-BOOT CSC shall compute a CHKS_32 on the X stored in EEPROM and compare it against the CHKS_32 sent with the X during the transfer.  The Bootstrap Monitor shall output to to the RS-232 interface both CHKS_32s and a message indicating whether the download was successful.","Checksum LibraryA number of checksum algorithms are required by various system and application software modules.  In order to avoid duplication of code, the various checksum algorithms are encapsulated into a checksum library. ",1
"  At the end of a download, the Bootstrap Monitor of the DPU-BOOT CSC shall compute a CHKS_32 on the X stored in EEPROM and compare it against the CHKS_32 sent with the X during the transfer.  The Bootstrap Monitor shall output to to the RS-232 interface both CHKS_32s and a message indicating whether the download was successful.","Checksum Library This function performs a checksum on a specified memory range.  The checksum is performed as an 8-bit additive checksum, but the accumulated value is stored in a 16-bit variable.",1
"  At the end of a download, the Bootstrap Monitor of the DPU-BOOT CSC shall compute a CHKS_32 on the X stored in EEPROM and compare it against the CHKS_32 sent with the X during the transfer.  The Bootstrap Monitor shall output to to the RS-232 interface both CHKS_32s and a message indicating whether the download was successful.",Checksum LibraryThis function performs a checksum on a specified memory range.  The checksum is performed as an bit XOR.,1
"  At the end of a download, the Bootstrap Monitor of the DPU-BOOT CSC shall compute a CHKS_32 on the X stored in EEPROM and compare it against the CHKS_32 sent with the X during the transfer.  The Bootstrap Monitor shall output to to the RS-232 interface both CHKS_32s and a message indicating whether the download was successful.",Checksum LibraryThis function performs a checksum on a specified memory range.  The checksum is performed as a 32-bit additive checksum.,1
  The DPU-BOOT CSC shall put the processor into diagnostic mode.,"initial boot sequencethe initial boot sequence, identified as Boot Sequence 1.  This processing takes place when the Bootstrap executes from Programmable Read-Only Memory (PROM).  Boot Sequence 1 is composed primarily of 4 steps as follows.First, in this sequence, EEPROM is updated.  Then, CPU BIT and a portion of DRAM BIT is performed.  Next, DRAM is cleared.  Lastly, Boot Sequence 2 is copied to DRAM and executed. During this sequence, the rest of DRAM is tested if skipBit is not set.  Load parameters are put into registers r13, r14, r15 and r16.  DRAM is cleared up to memSize.  Lastly, either the DPU-RTOS or the Bootstrap Monitor is loaded and executed according to the load parameters.",1
  The DPU-BOOT CSC shall put the processor into diagnostic mode.,"Built-In TestThere are two stages of Built-In Tests (BIT) for the DPU.  The Stage 1 BIT is included in the Bootstrap program and consists of Central Processing Unit (CPU) BIT, and Dynamic Random Access Memory (DRAM) BIT.  The Stage 2 BIT is executed after the operating system is booted and is not part of the Bootstrap program.",1
  The DPU-BOOT CSC shall put the processor into diagnostic mode.,"CPU BITThe CPU BIT consists of a series of tests designed to test each of the functional units of the processor.  These include test for the Branch-Unit, the Fixed-Point Unit, the Floating-Point Unit, the Interrupt-Unit, and the Timer Unit.   Each of these tests consists of executing a few selected instructions from the this functional unit. The General Purpose Registers (GPR), the Segment Registers (SR), the Counter Register (CTR), and the Condition Register are tested for stuck-bits as part of the Branch-Unit test.  This is done by writing a 1s pattern (verified by reading it back) and then writing a 0s pattern (verified by reading it back).",1
  The DPU-BOOT CSC shall put the processor into diagnostic mode.,Data Capture Interface Driver CSCThe Data Capture Interface (DCI) Driver CSC is a new driver which provides a standard VxWorks driver interface to the DCI hardware.  The driver features two modes: a test mode and a normal mode.,1
  The DPU-BOOT CSC shall put the processor into diagnostic mode.,"Standard I/O InterfaceThe write primitive does not block.  The buffer passed to write is written directly to the active portion of the ping pong buffer by the driver.  This primitive is valid only in TEST mode.  The write call will set errno to S_dci_MODE_ERROR and return ERROR if the driver is in NORMAL mode.  In TEST mode, the driver returns the number of bytes written.",1
"The Bootstrap Monitor of the DPU-BOOT CSC shall follow the protocol specified in BSPS-01, Bootstrap Monitor Protocol Specification, with the following noted exceptions.","Bootstrap MonitorThe Bootstrap Monitor checks entered commands for syntax and number of arguments, and displays an error message to the RS-232 interface if an invalid command or argument is entered.  A complete listing of these messages is given in document 7384-BSPS-01.",1
"The Bootstrap Monitor of the DPU-BOOT CSC shall follow the protocol specified in BSPS-01, Bootstrap Monitor Protocol Specification, with the following noted exceptions.","Instrument Control Unit Interface CSCThe Instrument Control Unit Interface (ICUI) CSC is a new component that provides support for application-level communication with the INSTRUMENT X ICU.  The ICUI CSC is primarily responsible for implementing the application protocol with the ICU as defined in document DPUICD-01. In order to meet these objectives, ICUI provides: * An ICU Interface Message Send Function, icuiEnq(), which provides an API by which other CSCs can send messages to the ICU.* An ICU Interface Command Reader ISR, icuiCmdReceiveISR(), which receives Telecommands from the ICU and forwards them to the Command and Control Task for processing.* An ICU Interface Housekeeping Function, icuiHkGet(), which gathers ICU Interface housekeeping data at the request of the Command and Control Task.",1
"  The Bootstrap CSC shall address hardware modules as defined in document 1400, Company X Specification for the Company X Communication/Memory Module.","DRAM BITPart of the memory is tested in Boot Sequence 1, and part of the memory is tested during Boot Sequence 2.  During Boot Sequence 1, ? KB of DRAM is tested before the Bootstrap is copied to this area.  During Boot Sequence 2, the  remaining memory is tested in ? KB blocks. The DRAM BIT first writes the address of each word in a block to that word in the block.   Then the test flushes the cache and reads back the entire block.  If a single-bit error occurs on the read-back, the location is read again.  If another single-bit error occurs, the test assumes a hard error and marks the whole block bad.  If a multiple-bit error occurs, the whole block is marked bad.  If the value read back does not match the address, the whole block is marked bad.  This same process is repeated with the ones complement of the address. The Bootstrap stores the results of the DRAM BIT in EEPROM as a series of x consecutive y-bit words.  Each bit in a result word represents the result of testing a ? KB block of DRAM.  These bits are mapped to DRAM by proceeding from least-significant bit (LSb) to most-significant bit (MSb) as the addresses of the memory blocks increase.  A set bit indicates that a block of DRAM has failed.  A clear bit indicates that a block of DRAM has passed the test.",1
The DPU-BOOT CSC shall initialize Error Detection and Correction (EDAC) on the RSC by clearing DRAM.,"InitializationThe DPU-BIT should be initialized every time the DPU boots.  The startup task, usrRoot() should call bitPart1() before initializing the device drivers and bitPart2() after initializing EDAC and the device drivers.",1
The DPU-BOOT CSC shall initialize Error Detection and Correction (EDAC) on the RSC by clearing DRAM.,Error Detection and Correction CSCThe Error Detection and Correction (EDAC) CSC is a Level 1 reuse component from the SSFF and INSTRUMENT Y projects.  The EDAC CSC consists of a set of Interrupt Service Routines (ISRs) and a Memory Scrubber Task.  The design of the INSTRUMENT Y EDAC CSC is described in document CIDPSDS-01.The only design change was to add logic to check for excessive external (SCM) EDAC interrupts.,1
"The DPU-BOOT CSC shall perform successive writes to a word page of EEPROM within C msecs, or wait a minimum of D usecs between successive writes.","Hardware InterfacesThe DPU-BOOTSTRAP must interface directly with the EEPROM on the Company X Communication Module.  The DPU-BOOTSTRAP accesses EEPROM as ?-bit words only.  The specific timing requirements of the EEPROM are satisfied in one of three ways:* the timing requirements are met by inserting specific wait loops (typical),* the timing requirements are met by use of the EEPROM Driver (DOWNLOAD command), andthe timing requirements are met implicitly by the amount of time which will be required to execute the intervening instructions regardless of the CPU speed setting (DRAM test logic).",1
The DPU-BOOT CSC shall wait a minimum of C msecs after a write to EEPROM before performing a read from EEPROM.,"Hardware InterfacesThe DPU-BOOTSTRAP must interface directly with the EEPROM on the Company X Communication Module.  The DPU-BOOTSTRAP accesses EEPROM as ?-bit words only.  The specific timing requirements of the EEPROM are satisfied in one of three ways:* the timing requirements are met by inserting specific wait loops (typical),* the timing requirements are met by use of the EEPROM Driver (DOWNLOAD command), andthe timing requirements are met implicitly by the amount of time which will be required to execute the intervening instructions regardless of the CPU speed setting (DRAM test logic).",1
  The DPU-BOOT CSC shall read from EEPROM in 32-bit words only.,"Hardware InterfacesThe DPU-BOOTSTRAP must interface directly with the EEPROM on the Company X Communication Module.  The DPU-BOOTSTRAP accesses EEPROM as ?-bit words only.  The specific timing requirements of the EEPROM are satisfied in one of three ways:* the timing requirements are met by inserting specific wait loops (typical),* the timing requirements are met by use of the EEPROM Driver (DOWNLOAD command), andthe timing requirements are met implicitly by the amount of time which will be required to execute the intervening instructions regardless of the CPU speed setting (DRAM test logic).",1
  The DPU-BOOT CSC shall read from EEPROM in 32-bit words only.,Hardware InterfacesThe DCI Driver CSC accesses each of the registers on the Company X Communications module using D16 VME access mode.  Reads from DCI memory are performed in VME D32 mode via a special assembly language routine which uses the lwm/stm instructions to minimize the transfer time.,1
"  The DPU-1553 CSC shall address hardware modules as defined in document 1400, Company X Specification for the Company X Communication/Memory Module.","Memory Upload and Download HandlingData can be upload to several types of locations, including* DRAM* EEPROM* hardware registers, and* EEPROM filesystem.ial D_MEM_DAT_UPLD command specify the target location.  If the destination is the EEPROM filesystem, a block number is provided in lieu of a memory address , which is used by the DPU FSW to formulate a filename of the form eefs1:DPU_blk.##, where ## is the block number.  In this case, once the entirety of the uploaded data is received by the DPU FSW, the uploaded data is then written to that file in the EEPROM filesystem.  If a file already exists with that name, it is overwritten.  The EEPROM filesystem can be reinitialized using the command D_MEM_DISK_INIT.",1
"  The DPU-1553 CSC shall address hardware modules as defined in document 1400, Company X Specification for the Company X Communication/Memory Module.","Initialization The task invokes the initialization function scuiInit() which sets an instance variable, allocates ring buffers and semaphores for the Low and High Priority Telemetry Queues, initializes a buffer and semaphore for pending RT-RT command messages, creates the scuiTask() wakeup semaphore, initializes internal data structures, opens and initializes file descriptors for each of the required MIL-STD-1553 subaddresses and installs ISRs.  When the CCM CSC spawns the scuiTask(), it will block on a semaphore (ccmSemScuiSpawn) awaiting SCUI initialization.  Once initialization is complete, the SCUI CSC will signal successful initialization by giving the semaphore, and then write an empty STPDU to the 1553 shared memory.",1
"  The DPU-1553 CSC shall address hardware modules as defined in document 1400, Company X Specification for the Company X Communication/Memory Module.","Install Exception Handlers Certain conditions can cause the VxWorks? exception handler to reboot the DPU.  These conditions include a Data Storage Interrupt from within an interrupt context, a Multiple-Bit Error (MBE), and a deferred-work queue overrun.  Under these circumstances, interrupting devices on the Company X Communication/Memory Module must be stopped prior to jumping back to the Bootstrap.  This can be done by installing a hook routine to perform the cleanup in sysHwInit() using the function rebootHookAdd().  However, to avoid the need to cleanup interrupts, an exception handler is installed which forces a watchdog reset, which will effectively clean up the pending interrupt problem.  The exception hook saves the contents of the Exception Stack Frame to EEPROM and waits for a watchdog timeout.  The following call is added to the usrRoot() function in usrConfig.c:",1
  Tthe DPU-CCM shall create DPU_HK_START and forward it to DPU-SCUI at bootup.,"Command and Control CSCThe Command and Control (CCM) CSC is a Level 2 reuse component from the INSTRUMENT Y project.  The Command and Control CSC includes the following components:* A Control Task, ccmCtrlTask(), which initializes the DPU FSW and spawns other tasks at bootup, schedules the production of DPU housekeeping data packets, monitors the execution of other tasks, and schedules the execution of other periodic tasks such as the heartbeat message and the watchdog strobe; and* A Command Dispatch Task, ccmCmdTask(), which receives and dispatches real-time commands received from the SCU or the ICU.Major data structures include:* A Static Data table that keeps track of the operational state.  Data included in this table includes housekeeping production rates, CCM specific flags, and the number of commands executed.* A Command Queue into which commands are placed when they arrive, via interrupt, from the ICU or the SCU.* An Error/Event Queue which accumulates error and event codes which are reported by the DPU FSW.  These error and event codes are removed from the queue and placed into a telemetry packet at a given interval and included in DPU housekeeping data.DPUSDS5.12.1.1.1Flight Software InitializationThe Command and Control CSC is initialized by spawning the CCM Control Task, ccmCtrlTask(), from the operating system startup task, usrRoot().  After the task is spawned it calls a function, ccmInit(), which creates the error/event queue, instantiates needed semaphores and installs various ISRs.  Finally, it spawns the remaining tasks which comprise the DPU FSW. When the CCM Control Task starts up, it reads DPU configuration startup defaults from the SYSTEM_CONFIG_AREA in EEPROM.  If the SYSTEM_CONFIG_AREA checksum is bad, hard-coded defaults are used.  The CCM Control Task initializes the remaining CSCs by calling the applicable initialization function, or if the CSC has an associated task, by spawning the task using the VxWorks function, taskSpawn().  When the CCM Control Task initializes a CSC, it passes the startup defaults read from EEPROM as parameters to the task initialization function. In addition to its task initialization activities, ccmInit(), also initializes the command length verification table by calling ccmCmdLengthInit().  The command processor uses the created table to verify expected command lengths for newly received commands.",1
  The DPU-CCM shall strobe the Watchdog timer  by writing to the SCM_WDR at an interval of 1 second.," Startup Sequence On flight, a power cycle can only be effected by the SCU.  A watchdog reset could be induced by the DPU FSW due to a detected, unrecoverable error, or it could occur as a by-product of the FSW entering a state in which it fails to strobe the watchdog timer.  On boot, the bootstrap tests and clears DRAM, and then proceeds to load the DPU FSW from EEPROM and executes it.  The DPU FSW then loads configuration information from EEPROM (which establishes various operational defaults) and spawns the various DPU FSW tasks. ",1
  The DPU-CCM shall strobe the Watchdog timer  by writing to the SCM_WDR at an interval of 1 second.,"Control and MonitoringEvery time the CCM Control executes, it calls ccmPerProcess() to handle periodic processing responsibilities.  Such responsibilities include analog to digital conversion updates, DPU task monitoring, ICU heartbeat message production, and watchdog strobe. The ccmHealthChk() function, called by ccmPerProcess() verifies the execution of other tasks by monitoring the amount of time that has elapsed since each task last reported.  Other tasks report their execution to the CCM Control Task by calling the function, ccmTaskReport(), providing their task index.  Each task has an expected execution frequency, and if a task does not execute as expected, an error is reported in DPU housekeeping.  If the Command Dispatch Task fails to report for an extended period, the DPU will execute a reboot, since it is impossible to command the DPU if this task is not executing, otherwise it will strobe the watchdog",1
  The DPU-CCM shall strobe the Watchdog timer  by writing to the SCM_WDR at an interval of 1 second.,Watchdog LibraryThe DPU contains a hardware watchdog which must be strobed periodically in order to prevent a DPU reboot.  ,1
  The DPU-CCM shall strobe the Watchdog timer  by writing to the SCM_WDR at an interval of 1 second.,Watchdog LibraryThis function strobes the system watchdog to prevent a watchdog reset.,1
  The DPU-CCM shall interpret and execute/dispatch real-time DPU_CMDs.,"Command and Control CSCThe Command and Control (CCM) CSC is a Level 2 reuse component from the INSTRUMENT Y project.  The Command and Control CSC includes the following components:* A Control Task, ccmCtrlTask(), which initializes the DPU FSW and spawns other tasks at bootup, schedules the production of DPU housekeeping data packets, monitors the execution of other tasks, and schedules the execution of other periodic tasks such as the heartbeat message and the watchdog strobe; and* A Command Dispatch Task, ccmCmdTask(), which receives and dispatches real-time commands received from the SCU or the ICU.Major data structures include:* A Static Data table that keeps track of the operational state.  Data included in this table includes housekeeping production rates, CCM specific flags, and the number of commands executed.* A Command Queue into which commands are placed when they arrive, via interrupt, from the ICU or the SCU.* An Error/Event Queue which accumulates error and event codes which are reported by the DPU FSW.  These error and event codes are removed from the queue and placed into a telemetry packet at a given interval and included in DPU housekeeping data.DPUSDS5.12.1.1.1Flight Software InitializationThe Command and Control CSC is initialized by spawning the CCM Control Task, ccmCtrlTask(), from the operating system startup task, usrRoot().  After the task is spawned it calls a function, ccmInit(), which creates the error/event queue, instantiates needed semaphores and installs various ISRs.  Finally, it spawns the remaining tasks which comprise the DPU FSW. When the CCM Control Task starts up, it reads DPU configuration startup defaults from the SYSTEM_CONFIG_AREA in EEPROM.  If the SYSTEM_CONFIG_AREA checksum is bad, hard-coded defaults are used.  The CCM Control Task initializes the remaining CSCs by calling the applicable initialization function, or if the CSC has an associated task, by spawning the task using the VxWorks function, taskSpawn().  When the CCM Control Task initializes a CSC, it passes the startup defaults read from EEPROM as parameters to the task initialization function. In addition to its task initialization activities, ccmInit(), also initializes the command length verification table by calling ccmCmdLengthInit().  The command processor uses the created table to verify expected command lengths for newly received commands.",1
  The DPU-CCM shall interpret and execute/dispatch real-time DPU_CMDs.,Real-Time Clock InterfaceThis routine gets the value of the Real-Time Clock (RTC) Registers and places the results in variables rtcu and rtcl.,1
  The DPU-CCM shall provide the capability to echo to the spacecraft each received command from the spacecraft or the ICU.,"Command HandlingThe DPU accepts commands via two interfaces  from the Spacecraft via the MIL-STD-1553 interface, and from the ICU via the SSI interface.  Any of the DPU commands can be sent from the SCU or the ICU.  The source for a command from the DPU is one of the following:* ICU  command is generated and sent by the ICU via the SSI.* SCU  command is generated and sent by the SCU via the 1553.* G-ICU  command is generated on the ground and sent to the DPU via the ICU/SSI.* G-SCU  command is generated on the ground and sent to the DPU via the SCU/1553.",1
  The DPU-CCM shall provide the capability to echo to the spacecraft each received command from the spacecraft or the ICU.,"Command HandlingCommands are dequeued from the Command Queue and executed by the Command Dispatch Task, ccmCmdTask().  This task blocks on a semaphore which is given by ccmCmdEnq(). The ccmCmdTask() wakes on the semaphore and calls ccmCmdProcess() to process waiting commands.  The ccmCmdProcess() function subsequently retrieves waiting commands from the Command Queue and invokes ccmCmdDispatch() to verify the expected length of the command and execute it.  If command echo is enabled, ccmCmdDispatch() will call ccmHkMkCmdEcho() to blindly echo the command back to the ground.  Counts for both rejected and executed commands are maintained. If the command sent to ccmCmdEnq() is either a 1 Hz Clock Time message or an Attitude message from the spacecraft, the command will not be forwarded to the Command Queue, but instead will be executed directly while still in interrupt context.  Attitude messages are forwarded to dpaCommandSend(), while the 1 Hz Clock Time messages parameters are passed to tisTimeSync() in order to synchronize the current time.  Any other non DPU or spacecraft observatory messages are quietly discarded without reporting an error.In order to guarantee that ccmCmdTask() task reports in with the CCM Control Task periodically in absence of a ground command, the semaphore has a timeout value of 20 seconds.  If the semaphore times out, the task will verify no commands are on the Command Queue, and then report in to the CCM Control Task by calling ccmTaskReport().",1
  The DPU-CCM shall provide the capability to echo to the spacecraft each received command from the spacecraft or the ICU.,"Time SynchronizationThe interface with the spacecraft as described in document 1143-EI-S19121 specifies that the spacecraft will provide a Clock Message to each Instrument at a 1 Hz rate.  The Clock Message contains both two values: a value representing the current spacecraft time, and a value representing the delta from the spacecraft time and the Univeral Time (UT), based on an epoch of TBD.",1
  The DPU-CCM shall provide the capability to echo to the spacecraft each received command from the spacecraft or the ICU.,"Public FunctionsThis routine provides a means for the CCM task to send a Purge Science Queue command from the ICU to the DPA software. The Purge Science Queue command shall be used to command the DPU to delete all data currently in the science telemetry output queue (i.e., data pending transmission to the spacecraft).",1
 The DPU-CCM shall provide a command to reboot the DPU.," Startup SequenceThe DPU FSW is booted using PROM-resident bootstrap software.  The bootstrap software performs a basic set of built-in tests, then copies the DPU FSW from EEPROM to DRAM and executes it.  In flight, there are two methods which can trigger the DPU FSW to boot:* power-on (cold boot), or* watchdog reset (warm boot, commanded reboot).",1
 The DPU-CCM shall provide a command to reboot the DPU.,Watchdog LibraryThe DPU contains a hardware watchdog which must be strobed periodically in order to prevent a DPU reboot.  ,1
  The DPU-CCM shall forward CLK_MSGs to the DPU-TIS for processing immediately upon receipt (I.e. shall not enqueue the message to the command dispatcher queue).,"Transmitting Telemetry to the SpacecraftThe SCUI CSC receives telemetry as input Data Packages via queues populated by other tasksthe Science Data Processing Task, the Data Compression Task, and the Command and Control Task.  The SCUI CSC has a High Priority Queue and a Low Priority Queue.  The two queues are implemented in an identical manner with the exception that the scuiTask() gives processing preference to the High Priority Queue.  The purpose of the High Priority Queue is to provide a means by which the Parameterized Finding Chart and DPU housekeeping can be transmitted to the SCU ahead of the potentially large amounts of buffered science data.",1
  The DPU-CCM shall forward CLK_MSGs to the DPU-TIS for processing immediately upon receipt (I.e. shall not enqueue the message to the command dispatcher queue).,"Data ProcessingThe DCX CSC is a task which receives data packages from other tasks, compresses the data using the VBTWL algorithm, and then forwards the compressed data package to the SCUI CSC.",1
  The DPU-CCM shall utilize bootup default values stored in the SYSTEM_CONFIG_AREA in EEPROM when initializing the FSW,"Command and Control CSCThe Command and Control (CCM) CSC is a Level 2 reuse component from the INSTRUMENT Y project.  The Command and Control CSC includes the following components:* A Control Task, ccmCtrlTask(), which initializes the DPU FSW and spawns other tasks at bootup, schedules the production of DPU housekeeping data packets, monitors the execution of other tasks, and schedules the execution of other periodic tasks such as the heartbeat message and the watchdog strobe; and* A Command Dispatch Task, ccmCmdTask(), which receives and dispatches real-time commands received from the SCU or the ICU.Major data structures include:* A Static Data table that keeps track of the operational state.  Data included in this table includes housekeeping production rates, CCM specific flags, and the number of commands executed.* A Command Queue into which commands are placed when they arrive, via interrupt, from the ICU or the SCU.* An Error/Event Queue which accumulates error and event codes which are reported by the DPU FSW.  These error and event codes are removed from the queue and placed into a telemetry packet at a given interval and included in DPU housekeeping data.DPUSDS5.12.1.1.1Flight Software InitializationThe Command and Control CSC is initialized by spawning the CCM Control Task, ccmCtrlTask(), from the operating system startup task, usrRoot().  After the task is spawned it calls a function, ccmInit(), which creates the error/event queue, instantiates needed semaphores and installs various ISRs.  Finally, it spawns the remaining tasks which comprise the DPU FSW. When the CCM Control Task starts up, it reads DPU configuration startup defaults from the SYSTEM_CONFIG_AREA in EEPROM.  If the SYSTEM_CONFIG_AREA checksum is bad, hard-coded defaults are used.  The CCM Control Task initializes the remaining CSCs by calling the applicable initialization function, or if the CSC has an associated task, by spawning the task using the VxWorks function, taskSpawn().  When the CCM Control Task initializes a CSC, it passes the startup defaults read from EEPROM as parameters to the task initialization function. In addition to its task initialization activities, ccmInit(), also initializes the command length verification table by calling ccmCmdLengthInit().  The command processor uses the created table to verify expected command lengths for newly received commands.",1
  The DPU-CCM shall forward ACS_MSGs to the DPU-DPA for processing immediately upon receipt (I.e. shall not enqueue the message to the command dispatcher queue).,"Error Collection and ReportingThe DPU-CCM CSC provides a centralized error reporting interface, ccmErrEnq(), that other FSW tasks use to report errors.  Each time it wakes, ccmTask() checks to see if it is time to form an error/event packet for transmission to the ground.  If so, ccmTask() calls ccmHkMkError() to actually create the packet and forward it to DPU-SCUI for transmission to the ground.",1
  The DPU-CCM shall forward ACS_MSGs to the DPU-DPA for processing immediately upon receipt (I.e. shall not enqueue the message to the command dispatcher queue).,"Data ProcessingThe DCX CSC is a task which receives data packages from other tasks, compresses the data using the VBTWL algorithm, and then forwards the compressed data package to the SCUI CSC.",1
  The DPU-CCM shall forward ACS_MSGs to the DPU-DPA for processing immediately upon receipt (I.e. shall not enqueue the message to the command dispatcher queue).,"ACS Message ProcessingThe SCUI task will send the ACS message to the DPA by calling the function dpaACSReceive().  Because the SCUI task will be calling dpaACSReceive() from an ISR, dpaACSReceive() must return quickly.  If commanded by the ICU in the Mode command, the ACS message will be saved along with the event data product.  To return quickly, dpaACSReceive() will place the ACS message in a data queue then return.  The Event Processor Task will remove the ACS messages from the queue and send them to the spacecraft.",1
  The DPU-CCM shall quietly discard any unrecognized observatory messages (I.e. messages which do not have a DPU command APID).,"Memory Upload and Download HandlingIf more than 65535 bytes need to be uploaded, the upload file must be broken up into multiple smaller files, each less than or equal to 65535 bytes, and then each of the virtual uploads should be sent in series.  Because of the sequence numbers, the DPU FSW can receive individual upload commands out of sequence.  There is no time limit for the accomplishment of a single virtual upload, and so a long upload can continue across ground contacts.  If an upload is in progress, the last sequence number can be sent to the DPU FSW and it will report the list of missing sequence numbers via event number S_ccm_MISSING_SEQNO.  If an upload is in progress and needs to be cancelled, it can be discarded by issuing the D_MEM_DAT_CNCL command.",1
  The DPU-CCM shall quietly discard any unrecognized observatory messages (I.e. messages which do not have a DPU command APID).,"Data Transfer to QueueWhen the tmaliTransferToQueueISR() ISR is invoked, it gives a semaphore to awaken tmaliTask() that will transfer data to the  queue over the VME bus.  The tmaliTask() uses the read() function in the DCI Driver, which implements a data transfer using a high speed assembly language routine.  Because the TMALI ring buffer is implemented as an array, the tmaliTask() function must first examine the TMALI_EVENT_QUEUE to determine whether the data resident in the DCI buffer can be retrieved using a single read() call, or whether two calls are required in order to correctly handle the wrap-around case at the end of the ring buffer.  In addition, the tmaliTask() function must perform an error check to verify that there is sufficient space to receive the data available in the Ping-Pong buffer.  If there is insufficient space for the complete set of frames, the entire contents of the readable Ping-Pong buffer are discarded and the error S_TMALI_QUEUE_FULL is reported using ccmErrEnq mechanism.  Such discarded data constitutes an integral number of CCD frames, since the DCI hardware design ensures that Ping-Pong transitions occur at CCD frame boundaries.  This policy of discarding the newer data supports the scientific viewpoint that events collected right after a burst have more scientific value than events collected later.",1
  The DPU-CCM shall quietly discard any unrecognized observatory messages (I.e. messages which do not have a DPU command APID).,"Data ProcessingWhen the DCX CSC compresses a data package, the given APID is incremented by one.  If the compressed copy of data is larger than original data set, the original data set will be forwarded to the SCUI CSC, an event S_dcx_UNC_USED is enqueued to ccmErrEnq(), and the APID is not incremented.  In this way, the ground systems can discern compressed packets from non-compressed packets.",1
  The DPU-CCM shall quietly discard any unrecognized observatory messages (I.e. messages which do not have a DPU command APID).,"Time SynchronizationThe time contained in the Clock Message is specified to be valid on the rising edge of the next 1PPS signal.  When the DPU receives the Clock Message, the 1553 ISR calls the tisTimeSync() function, forwarding the data portion of the clock message to the TIS CSC via the TIS_CLK_MSG data structure..  The tisTimeSync() function will immediately copy the spacecraft clock value to the DPU clock hardware registers. The DPU hardware is designed to latch in the new time on the rising edge of the next 1 PPS signal (the act of writing a new time to the hardware registers arms the latch function in the hardware).  Once the new time is latched, the hardware automatically disables the time latch function to avoid the potential of latching in an old time at the next 1 PPS signal.will be received within one second.  In the unlikely event a UT Delta is discarded, an event message is enqueued to ccmErrEnq() for informational purposes.",1
 The DPU-CCM shall notify the ICU upon completion of boot and flight software initialization.," Startup Sequence On flight, a power cycle can only be effected by the SCU.  A watchdog reset could be induced by the DPU FSW due to a detected, unrecoverable error, or it could occur as a by-product of the FSW entering a state in which it fails to strobe the watchdog timer.  On boot, the bootstrap tests and clears DRAM, and then proceeds to load the DPU FSW from EEPROM and executes it.  The DPU FSW then loads configuration information from EEPROM (which establishes various operational defaults) and spawns the various DPU FSW tasks. ",1
 The DPU-CCM shall notify the ICU upon completion of boot and flight software initialization.,"Control and Monitoringthe CCM Control Task initializes the DPU FSW. It is the responsibility of the CCM Control Task to establish a successful boot.  It does so by blocking on temporary semaphores, each with a 5 second timeout, after spawning the SCU Interface Task and the CCM Command Task.  If both of these tasks report a successful initialization by giving the semaphore, the CCM Control Task toggles the BC_INDEX parameter in EEPROM to indicate a successful boot.  If either task does not report a successful initialization, the CCM Control Task disables the watchdog strobe to effect a reboot of the DPU.  The rationale for selecting the successful initialization of these two tasks as the definition of a successful boot is that the DPU FSW requires these tasks, as a minimum, to establish ground contact and provide commandability.Once this initialization is complete, the task blocks on a binary semaphore which is given by the SCUI Command ISR upon arrival of the 1 Hz Clock Message.  In the event a Clock Message does not arrive, the semaphore will time out after 1.5 seconds.  The CCM Control Task remains alive to create and transmit DPU housekeeping at the appropriate intervals, perform various periodic processing tasks, and to process memory dump commands.The final call to ccmErrEnq() is performed in order that if an error occurs in an interrupt service routine, a global variable is set to the value of the errno which is then enqueued into the Error/Event Queue as part of this tasks normal processing.",1
" The DPU-CCM shall spawn tasks for DPU-CCM, DPU-DPA, DPU-DCX, DPU-SCUI, and DPU-TMALI at bootup.","Command and Control CSCThe Command and Control (CCM) CSC is a Level 2 reuse component from the INSTRUMENT Y project.  The Command and Control CSC includes the following components:* A Control Task, ccmCtrlTask(), which initializes the DPU FSW and spawns other tasks at bootup, schedules the production of DPU housekeeping data packets, monitors the execution of other tasks, and schedules the execution of other periodic tasks such as the heartbeat message and the watchdog strobe; and* A Command Dispatch Task, ccmCmdTask(), which receives and dispatches real-time commands received from the SCU or the ICU.Major data structures include:* A Static Data table that keeps track of the operational state.  Data included in this table includes housekeeping production rates, CCM specific flags, and the number of commands executed.* A Command Queue into which commands are placed when they arrive, via interrupt, from the ICU or the SCU.* An Error/Event Queue which accumulates error and event codes which are reported by the DPU FSW.  These error and event codes are removed from the queue and placed into a telemetry packet at a given interval and included in DPU housekeeping data.DPUSDS5.12.1.1.1Flight Software InitializationThe Command and Control CSC is initialized by spawning the CCM Control Task, ccmCtrlTask(), from the operating system startup task, usrRoot().  After the task is spawned it calls a function, ccmInit(), which creates the error/event queue, instantiates needed semaphores and installs various ISRs.  Finally, it spawns the remaining tasks which comprise the DPU FSW. When the CCM Control Task starts up, it reads DPU configuration startup defaults from the SYSTEM_CONFIG_AREA in EEPROM.  If the SYSTEM_CONFIG_AREA checksum is bad, hard-coded defaults are used.  The CCM Control Task initializes the remaining CSCs by calling the applicable initialization function, or if the CSC has an associated task, by spawning the task using the VxWorks function, taskSpawn().  When the CCM Control Task initializes a CSC, it passes the startup defaults read from EEPROM as parameters to the task initialization function. In addition to its task initialization activities, ccmInit(), also initializes the command length verification table by calling ccmCmdLengthInit().  The command processor uses the created table to verify expected command lengths for newly received commands.",1
" The DPU-CCM shall spawn tasks for DPU-CCM, DPU-DPA, DPU-DCX, DPU-SCUI, and DPU-TMALI at bootup.","Control and Monitoringthe CCM Control Task initializes the DPU FSW. It is the responsibility of the CCM Control Task to establish a successful boot.  It does so by blocking on temporary semaphores, each with a 5 second timeout, after spawning the SCU Interface Task and the CCM Command Task.  If both of these tasks report a successful initialization by giving the semaphore, the CCM Control Task toggles the BC_INDEX parameter in EEPROM to indicate a successful boot.  If either task does not report a successful initialization, the CCM Control Task disables the watchdog strobe to effect a reboot of the DPU.  The rationale for selecting the successful initialization of these two tasks as the definition of a successful boot is that the DPU FSW requires these tasks, as a minimum, to establish ground contact and provide commandability.Once this initialization is complete, the task blocks on a binary semaphore which is given by the SCUI Command ISR upon arrival of the 1 Hz Clock Message.  In the event a Clock Message does not arrive, the semaphore will time out after 1.5 seconds.  The CCM Control Task remains alive to create and transmit DPU housekeeping at the appropriate intervals, perform various periodic processing tasks, and to process memory dump commands.The final call to ccmErrEnq() is performed in order that if an error occurs in an interrupt service routine, a global variable is set to the value of the errno which is then enqueued into the Error/Event Queue as part of this tasks normal processing.",1
" The DPU-CCM shall spawn tasks for DPU-CCM, DPU-DPA, DPU-DCX, DPU-SCUI, and DPU-TMALI at bootup.","Error Collection and ReportingThe DPU-CCM CSC provides a centralized error reporting interface, ccmErrEnq(), that other FSW tasks use to report errors.  Each time it wakes, ccmTask() checks to see if it is time to form an error/event packet for transmission to the ground.  If so, ccmTask() calls ccmHkMkError() to actually create the packet and forward it to DPU-SCUI for transmission to the ground.",1
" The DPU-CCM shall spawn tasks for DPU-CCM, DPU-DPA, DPU-DCX, DPU-SCUI, and DPU-TMALI at bootup.","InitializationThe TMALI CSC is initialized by spawning the tmaliTask() with the startup default parameters.  This task will allocate memory for the TMALI_EVENT_QUEUE, install DCI ISRs, initialize static variables and data structures, and then enter an end-less loop in which it transfers the data from the DCI to the TMALI queue, throttled by the semaphore semDciWait.",1
" The DPU-CCM shall spawn tasks for DPU-CCM, DPU-DPA, DPU-DCX, DPU-SCUI, and DPU-TMALI at bootup.","InitializationThe SCUI CSC is initialized when the scuiTask() is spawned by the CCM CSC.  Initialization parameters which are passed into the scuiTask() include:* Poll Rate  rate at which the S/C will poll the DPU for telemetry.  The rate is specified in Hz, and has a default of X Hz based on the INSTRUMENT X-DPU poll rate in the Company X 1553 ICD.* Buffer Rate  value used to rate buffer data to the S/C.  The rate is specified in bits per telemetry poll, and has a default of 7664 which is equal to one STPDU per poll (*** bytes per STPDU times V bits/byte).  This default value effectively disables rate buffering.* Size of Low Priority Queue  size in bytes of the low priority telemetry queue.  If the amount requested cannot be allocated, the buffer will be allocated at  the amount of memory contained in the largest free memory block.Size of High Priority Queue  size in bytes of the high priority telemetry queue. If the amount requested cannot be allocated, the buffer will be allocated at  the amount of memory contained in the largest free memory block.",1
" The DPU-CCM shall spawn tasks for DPU-CCM, DPU-DPA, DPU-DCX, DPU-SCUI, and DPU-TMALI at bootup.","Public FunctionsThis routine is spawned by the Command and Control Task to initialize and execute the SCU Interface Data Processor Task.  This task initializes the SCUI CSC and then enters an infinite loop to process telemetry and produce STPDUs.  Once initialized, the task is awakened by a semaphore given when the SCU writes the telemetry done subaddress.",1
" The DPU-CCM shall spawn tasks for DPU-CCM, DPU-DPA, DPU-DCX, DPU-SCUI, and DPU-TMALI at bootup.","InitializationThe DCX CSC is initialized when the dcxTask() is spawned by the CCM CSC.  During initialization, the DCX CSC creates a compression queue to contain data packages which are pending compression.  Access to the compression queue is protected by a mutual exclusion semaphore.  The size of the compression queue is controlled by an initialization parameters which is passed into the dcxTask().  If the amount of memory requested cannot be allocated, initialization of the DCX CSC will fail.",1
" The DPU-CCM shall spawn tasks for DPU-CCM, DPU-DPA, DPU-DCX, DPU-SCUI, and DPU-TMALI at bootup.",InitializationThe DPA CSC is initialized by spawning the tasks dpaEventTask() and dpaInstrument YTask().  After the tasks are spawned they create the needed memory buffers.  The dpaEventTask() then enters the Idle state waiting for a Mode command from the ICU.  The dpaInstrument YTask also enters the Idle state waiting to process either the Ping or Pong buffer.  The default setting for compression (on or off) is retrieved from EEPROM.,1
" The DPU-CCM shall spawn tasks for DPU-CCM, DPU-DPA, DPU-DCX, DPU-SCUI, and DPU-TMALI at bootup.",Public FunctionsThis routine is spawned by the Command and Control Task to initialize and execute the DPA Instrument Y Processing Task.,1
" The DPU-CCM shall spawn tasks for DPU-CCM, DPU-DPA, DPU-DCX, DPU-SCUI, and DPU-TMALI at bootup.",Public FunctionsThis routine is spawned by the Command and Control Task to initialize and execute the DPA Event Processing Task.,1
  The DPU-CCM shall collect DPU_HK and forward it to the DPU-SCUI.,"Error Collection and ReportingThe DPU-CCM CSC provides a centralized error reporting interface, ccmErrEnq(), that other FSW tasks use to report errors.  Each time it wakes, ccmTask() checks to see if it is time to form an error/event packet for transmission to the ground.  If so, ccmTask() calls ccmHkMkError() to actually create the packet and forward it to DPU-SCUI for transmission to the ground.",1
  The DPU-CCM shall collect DPU_HK and forward it to the DPU-SCUI.,"Receiving Commands from the SpacecraftThe DPU/SCU interface specifies that commands for the DPU will be transmitted from the SCU to the DPU on a separate MIL-STD-1553 subaddress.  The SCU Interface Command Reader ISR, scuiCmdReadISR(). consists of an ISR installed on a specific MIL-STD-1553 subaddress corresponding to the command subaddress for the INSTRUMENT X DPU. This ISR is installed at initialization by scuiInit().  Upon interrupt, the scuiCmdReadISR() reads a single telecommand from the 1553 bus, checks the length and checksum, and then forwards valid commands to the Command and Control CSC for dispatch via ccmCmdEnq().  Errors are reported by incrementing an invalid command counter.",1
  The DPU-CCM shall collect DPU_HK and forward it to the DPU-SCUI.,"Data ProcessingThe DCX CSC is a task which receives data packages from other tasks, compresses the data using the VBTWL algorithm, and then forwards the compressed data package to the SCUI CSC.",1
"  On boot, the DPU-CCM shall toggle the BC_INDEX if the boot is successful.  A boot is successful if command and telemetry communications have been established with the spacecraft.","Public FunctionsThis routine manually sets the values of the spacecraft time maintained in the DPU hardware, and the UT Delta maintained in a static variable, to the given values.",1
"  The DPU-CCM shall produce DPU_HK at a commandable rate, with a default of 10 seconds.","Setting Frame Depth in DCIThe optimum frame depth will be determined with benchmark testing.  The default frame depth is 10 frames.  Given the above data, it will take approximately 24 msec to read 10 maximum-sized frames at the maximum data transfer rate.",1
"  The DPU-CCM shall produce DPU_HK at a commandable rate, with a default of 10 seconds.",SCU Interface CSCThis CSC performs rate-buffering of the downlink telemetry to the SCU according to a commandable parameter.  The rate at which the SCU polls the DPU is also commandable.  The CSC installs an ISR to collect telecommands from the SCU via the MILSTD1553B Interface.,1
"  The DPU-CCM shall monitor the status of DPU-SCUI, DPU-CCM, DPU-DCX, DPU-TMALI, and DPU-DPA by examining their TASK_INFO and report this information in DPU_HK.","Bootstrap MonitorThe Bootstrap Monitor checks entered commands for syntax and number of arguments, and displays an error message to the RS-232 interface if an invalid command or argument is entered.  A complete listing of these messages is given in document 7384-BSPS-01.",1
"  The DPU-CCM shall monitor the status of DPU-SCUI, DPU-CCM, DPU-DCX, DPU-TMALI, and DPU-DPA by examining their TASK_INFO and report this information in DPU_HK.",Control and MonitoringThe DPU produces eight types of housekeeping packets.,1
"  The DPU-CCM shall monitor the status of DPU-SCUI, DPU-CCM, DPU-DCX, DPU-TMALI, and DPU-DPA by examining their TASK_INFO and report this information in DPU_HK.","Error Collection and ReportingThe DPU-CCM CSC provides a centralized error reporting interface, ccmErrEnq(), that other FSW tasks use to report errors.  Each time it wakes, ccmTask() checks to see if it is time to form an error/event packet for transmission to the ground.  If so, ccmTask() calls ccmHkMkError() to actually create the packet and forward it to DPU-SCUI for transmission to the ground.",1
"  The DPU-CCM shall monitor the status of DPU-SCUI, DPU-CCM, DPU-DCX, DPU-TMALI, and DPU-DPA by examining their TASK_INFO and report this information in DPU_HK.","Error Collection and ReportingIn order to insure that error counts are not lost due to rollover, ccmErrEnq(), checks to insure that the count for a given error has not gone above 250 in one high rate housekeeping reporting period.  If the error count exceeds 250 for a particular reporting period, ccmErrEnq() will enqueue S_ccm_ERR_REPEAT error with the current error count and will clear its error tracking mechanism.",1
"  The DPU-CCM shall monitor the status of DPU-SCUI, DPU-CCM, DPU-DCX, DPU-TMALI, and DPU-DPA by examining their TASK_INFO and report this information in DPU_HK.",Public FunctionsThis routine provides a means for the CCM task to get the housekeeping info from the DPA software.  The CCM task will call this function and pass a pointer to the location that DPA is to store its housekeeping. ,1
  The DPU-CCM shall process real-time non-deferred commands within B ms of receipt from the ICU or the SCU.,"Command and Control CSCThe Command and Control (CCM) CSC is a Level 2 reuse component from the INSTRUMENT Y project.  The Command and Control CSC includes the following components:* A Control Task, ccmCtrlTask(), which initializes the DPU FSW and spawns other tasks at bootup, schedules the production of DPU housekeeping data packets, monitors the execution of other tasks, and schedules the execution of other periodic tasks such as the heartbeat message and the watchdog strobe; and* A Command Dispatch Task, ccmCmdTask(), which receives and dispatches real-time commands received from the SCU or the ICU.Major data structures include:* A Static Data table that keeps track of the operational state.  Data included in this table includes housekeeping production rates, CCM specific flags, and the number of commands executed.* A Command Queue into which commands are placed when they arrive, via interrupt, from the ICU or the SCU.* An Error/Event Queue which accumulates error and event codes which are reported by the DPU FSW.  These error and event codes are removed from the queue and placed into a telemetry packet at a given interval and included in DPU housekeeping data.DPUSDS5.12.1.1.1Flight Software InitializationThe Command and Control CSC is initialized by spawning the CCM Control Task, ccmCtrlTask(), from the operating system startup task, usrRoot().  After the task is spawned it calls a function, ccmInit(), which creates the error/event queue, instantiates needed semaphores and installs various ISRs.  Finally, it spawns the remaining tasks which comprise the DPU FSW. When the CCM Control Task starts up, it reads DPU configuration startup defaults from the SYSTEM_CONFIG_AREA in EEPROM.  If the SYSTEM_CONFIG_AREA checksum is bad, hard-coded defaults are used.  The CCM Control Task initializes the remaining CSCs by calling the applicable initialization function, or if the CSC has an associated task, by spawning the task using the VxWorks function, taskSpawn().  When the CCM Control Task initializes a CSC, it passes the startup defaults read from EEPROM as parameters to the task initialization function. In addition to its task initialization activities, ccmInit(), also initializes the command length verification table by calling ccmCmdLengthInit().  The command processor uses the created table to verify expected command lengths for newly received commands.",1
  The DPU-CCM shall process real-time non-deferred commands within B ms of receipt from the ICU or the SCU.,"Command HandlingThe DPU accepts commands via two interfaces  from the Spacecraft via the MIL-STD-1553 interface, and from the ICU via the SSI interface.  Any of the DPU commands can be sent from the SCU or the ICU.  The source for a command from the DPU is one of the following:* ICU  command is generated and sent by the ICU via the SSI.* SCU  command is generated and sent by the SCU via the 1553.* G-ICU  command is generated on the ground and sent to the DPU via the ICU/SSI.* G-SCU  command is generated on the ground and sent to the DPU via the SCU/1553.",1
  The DPU-CCM shall process real-time non-deferred commands within B ms of receipt from the ICU or the SCU.,"Data Transfer to QueueDuring initialization, the TMALI CSC installs an ISR hook routine, tmaliTransferToQueueISR(),  into the DCI Driver which is invoked when:* the DCI interface reaches the programmed frame limit in the Ping-Pong buffer, or* the DCI interface detects a data receipt timeout.",1
 The DPU-CCM shall record an error to the LAST_BOOT_IVEC location in EEPROM and discontinue strobing the Watchdog Timer should an unrecoverable software error occur.  An unrecoverable software error is defined as an error that causes a loss of commandability or ground communication.,"Control and MonitoringEvery time the CCM Control executes, it calls ccmPerProcess() to handle periodic processing responsibilities.  Such responsibilities include analog to digital conversion updates, DPU task monitoring, ICU heartbeat message production, and watchdog strobe. The ccmHealthChk() function, called by ccmPerProcess() verifies the execution of other tasks by monitoring the amount of time that has elapsed since each task last reported.  Other tasks report their execution to the CCM Control Task by calling the function, ccmTaskReport(), providing their task index.  Each task has an expected execution frequency, and if a task does not execute as expected, an error is reported in DPU housekeeping.  If the Command Dispatch Task fails to report for an extended period, the DPU will execute a reboot, since it is impossible to command the DPU if this task is not executing, otherwise it will strobe the watchdog",1
 The DPU-CCM shall record an error to the LAST_BOOT_IVEC location in EEPROM and discontinue strobing the Watchdog Timer should an unrecoverable software error occur.  An unrecoverable software error is defined as an error that causes a loss of commandability or ground communication.,"Error Collection and ReportingThe DPU-CCM CSC provides a centralized error reporting interface, ccmErrEnq(), that other FSW tasks use to report errors.  Each time it wakes, ccmTask() checks to see if it is time to form an error/event packet for transmission to the ground.  If so, ccmTask() calls ccmHkMkError() to actually create the packet and forward it to DPU-SCUI for transmission to the ground.",1
 The DPU-CCM shall provide a mechanism for other CSCs to report errors for inclusion in the DPU_HK.,"Command and Control CSCThe Command and Control (CCM) CSC is a Level 2 reuse component from the INSTRUMENT Y project.  The Command and Control CSC includes the following components:* A Control Task, ccmCtrlTask(), which initializes the DPU FSW and spawns other tasks at bootup, schedules the production of DPU housekeeping data packets, monitors the execution of other tasks, and schedules the execution of other periodic tasks such as the heartbeat message and the watchdog strobe; and* A Command Dispatch Task, ccmCmdTask(), which receives and dispatches real-time commands received from the SCU or the ICU.Major data structures include:* A Static Data table that keeps track of the operational state.  Data included in this table includes housekeeping production rates, CCM specific flags, and the number of commands executed.* A Command Queue into which commands are placed when they arrive, via interrupt, from the ICU or the SCU.* An Error/Event Queue which accumulates error and event codes which are reported by the DPU FSW.  These error and event codes are removed from the queue and placed into a telemetry packet at a given interval and included in DPU housekeeping data.DPUSDS5.12.1.1.1Flight Software InitializationThe Command and Control CSC is initialized by spawning the CCM Control Task, ccmCtrlTask(), from the operating system startup task, usrRoot().  After the task is spawned it calls a function, ccmInit(), which creates the error/event queue, instantiates needed semaphores and installs various ISRs.  Finally, it spawns the remaining tasks which comprise the DPU FSW. When the CCM Control Task starts up, it reads DPU configuration startup defaults from the SYSTEM_CONFIG_AREA in EEPROM.  If the SYSTEM_CONFIG_AREA checksum is bad, hard-coded defaults are used.  The CCM Control Task initializes the remaining CSCs by calling the applicable initialization function, or if the CSC has an associated task, by spawning the task using the VxWorks function, taskSpawn().  When the CCM Control Task initializes a CSC, it passes the startup defaults read from EEPROM as parameters to the task initialization function. In addition to its task initialization activities, ccmInit(), also initializes the command length verification table by calling ccmCmdLengthInit().  The command processor uses the created table to verify expected command lengths for newly received commands.",1
 The DPU-CCM shall provide a mechanism for other CSCs to report errors for inclusion in the DPU_HK.,"Control and MonitoringEvery time the CCM Control executes, it calls ccmPerProcess() to handle periodic processing responsibilities.  Such responsibilities include analog to digital conversion updates, DPU task monitoring, ICU heartbeat message production, and watchdog strobe. The ccmHealthChk() function, called by ccmPerProcess() verifies the execution of other tasks by monitoring the amount of time that has elapsed since each task last reported.  Other tasks report their execution to the CCM Control Task by calling the function, ccmTaskReport(), providing their task index.  Each task has an expected execution frequency, and if a task does not execute as expected, an error is reported in DPU housekeeping.  If the Command Dispatch Task fails to report for an extended period, the DPU will execute a reboot, since it is impossible to command the DPU if this task is not executing, otherwise it will strobe the watchdog",1
 The DPU-CCM shall provide a mechanism for other CSCs to report errors for inclusion in the DPU_HK.,"Error Collection and ReportingThe DPU-CCM CSC provides a centralized error reporting interface, ccmErrEnq(), that other FSW tasks use to report errors.  Each time it wakes, ccmTask() checks to see if it is time to form an error/event packet for transmission to the ground.  If so, ccmTask() calls ccmHkMkError() to actually create the packet and forward it to DPU-SCUI for transmission to the ground.",1
 The DPU-CCM shall provide a mechanism for other CSCs to report errors for inclusion in the DPU_HK.,"Public FunctionsThis routine is called by any CSC in order to report an error or event that should be included in DPU housekeeping.  If this routine is called from interrupt context a static global variable, ccmISRError, is set so that the error can be enqueued later (see ccmCtrlTask()).  This is done since the error/event queue is semaphore-protected and a semaphore cannot be taken in an ISR.  The error queue semaphore has priority inversion set to reduce conflicts between multiple callers should a priority inversion situation arise. This routine also replaces frequently occuring errors with a special repeat error code.  The repeat error code is a special error code that follows a normally reported error code to indicate that the normally reported error code previously reported has occurred more than once in the last high rate reporting period",1
" The DPU-CCM shall collect a TASK_HBEAT from  DPU-SCUI, DPU-CCM, DPU-DCX, DPU-TMALI, and DPU-DPA .  Non-responsive tasks will be reported in DPU_HK.","Event ProcessingThe Event Processor Task, after receiving a Mode command from the ICU, configures the DPU DCI hardware, responds to the ICU with a Mode Ready message then receives detector events by calling functions tmaliWait() and tmaliNextEvent().  The Event Processor Task will collect detector events for the time period specified in the Mode command then issue a Mode Complete message to the ICU.  After issuing the Mode Complete message, the Event Processor Task will enter the Idle state.",1
"  The DPU-CCM shall be able to count a consecutively reported error.  When the the count for a particular error ID, exceeds 250 for a particular reporting period, the error code will be replaced with a error code sequence which shall include the original error code and the number of times the error was reported.  ","Control and Monitoringthe CCM Control Task also handles memory dump commands.  In the event of a data dump command, the CCM Control Task will break the dump into manageable pieces and dump a small portion at a time, each time the task is awakened.  The purpose of this deferred activity is to prevent a large dump from consuming available CPU time by keeping the high-priority CCM Command Dispatch Task busy for an extended period.",1
"  The DPU-CCM shall be able to count a consecutively reported error.  When the the count for a particular error ID, exceeds 250 for a particular reporting period, the error code will be replaced with a error code sequence which shall include the original error code and the number of times the error was reported.  ","Error Collection and ReportingThe ccmErrEnq() function tracks the last error reported and its frequency of occurrence.  Once an error code has been reported it becomes the previously reported error code maintained by ccmErrEnq().  A repetition count is then incremented for each subsequent, consecutively reported, identical instance of this previously reported error.  If this error code is reported more than once in one high-rate housekeeping reporting period, then a special error, S_ccm_ERR_REPEAT is enqueued with the repetition count for the error encoded in the least significant byte. This mechanism effectively reduces the potential for housekeeping telemetry to become flooded with a single repeated error.",1
"  The DPU-CCM shall be able to count a consecutively reported error.  When the the count for a particular error ID, exceeds 250 for a particular reporting period, the error code will be replaced with a error code sequence which shall include the original error code and the number of times the error was reported.  ","Public FunctionsThis routine is called by any CSC in order to report an error or event that should be included in DPU housekeeping.  If this routine is called from interrupt context a static global variable, ccmISRError, is set so that the error can be enqueued later (see ccmCtrlTask()).  This is done since the error/event queue is semaphore-protected and a semaphore cannot be taken in an ISR.  The error queue semaphore has priority inversion set to reduce conflicts between multiple callers should a priority inversion situation arise. This routine also replaces frequently occuring errors with a special repeat error code.  The repeat error code is a special error code that follows a normally reported error code to indicate that the normally reported error code previously reported has occurred more than once in the last high rate reporting period",1
"  The DPU-CCM shall check the length of a received DPU_CMD against an expected value from a lookup table indexed by FUNCTION code.  If the received value does not match the expected, then the command will be discarded, and an error will be enqueued.","Error Collection and ReportingThe ccmErrEnq() function tracks the last error reported and its frequency of occurrence.  Once an error code has been reported it becomes the previously reported error code maintained by ccmErrEnq().  A repetition count is then incremented for each subsequent, consecutively reported, identical instance of this previously reported error.  If this error code is reported more than once in one high-rate housekeeping reporting period, then a special error, S_ccm_ERR_REPEAT is enqueued with the repetition count for the error encoded in the least significant byte. This mechanism effectively reduces the potential for housekeeping telemetry to become flooded with a single repeated error.",1
"  The DPU-CCM shall check the length of a received DPU_CMD against an expected value from a lookup table indexed by FUNCTION code.  If the received value does not match the expected, then the command will be discarded, and an error will be enqueued.","Error RecoveryExcept for the modification described in Sections 5.2.3.6, no further modifications to the existing task error-handling mechanisms are required. VxWorks? uses a global mechanism for returning status codes when errors occur.  This is accomplished  by using the task variable, errno (stored in the task control block).  Most VxWorks? functions return a STATUS value.  This value can either be OK or ERROR.  If a function returns ERROR, then the errno variable must indicate a specific error code.",1
"  The DPU-CCM shall, in rejecting a command, report an error in DPU_HK indicating  the byte-code of the command being rejected in the LSB of the errno as described in 03691-DPUSDP-01.  ","Error Collection and ReportingThe ccmErrEnq() function tracks the last error reported and its frequency of occurrence.  Once an error code has been reported it becomes the previously reported error code maintained by ccmErrEnq().  A repetition count is then incremented for each subsequent, consecutively reported, identical instance of this previously reported error.  If this error code is reported more than once in one high-rate housekeeping reporting period, then a special error, S_ccm_ERR_REPEAT is enqueued with the repetition count for the error encoded in the least significant byte. This mechanism effectively reduces the potential for housekeeping telemetry to become flooded with a single repeated error.",1
"  The DPU-CCM shall, in rejecting a command, report an error in DPU_HK indicating  the byte-code of the command being rejected in the LSB of the errno as described in 03691-DPUSDP-01.  ","Public FunctionsThis routine returns OK, or ERROR and sets errno if the passed parameter is NULL.  The following error codes may be returned in errno ",1
"  The DPU-CCM shall, in rejecting a command, report an error in DPU_HK indicating  the byte-code of the command being rejected in the LSB of the errno as described in 03691-DPUSDP-01.  ","Error RecoveryExcept for the modification described in Sections 5.2.3.6, no further modifications to the existing task error-handling mechanisms are required. VxWorks? uses a global mechanism for returning status codes when errors occur.  This is accomplished  by using the task variable, errno (stored in the task control block).  Most VxWorks? functions return a STATUS value.  This value can either be OK or ERROR.  If a function returns ERROR, then the errno variable must indicate a specific error code.",1
  The DPU-CCM shall maintain counts of both the number of commands successfully received and rejected and report the parameters in DPU_HK.,"Command HandlingCommands are dequeued from the Command Queue and executed by the Command Dispatch Task, ccmCmdTask().  This task blocks on a semaphore which is given by ccmCmdEnq(). The ccmCmdTask() wakes on the semaphore and calls ccmCmdProcess() to process waiting commands.  The ccmCmdProcess() function subsequently retrieves waiting commands from the Command Queue and invokes ccmCmdDispatch() to verify the expected length of the command and execute it.  If command echo is enabled, ccmCmdDispatch() will call ccmHkMkCmdEcho() to blindly echo the command back to the ground.  Counts for both rejected and executed commands are maintained. If the command sent to ccmCmdEnq() is either a 1 Hz Clock Time message or an Attitude message from the spacecraft, the command will not be forwarded to the Command Queue, but instead will be executed directly while still in interrupt context.  Attitude messages are forwarded to dpaCommandSend(), while the 1 Hz Clock Time messages parameters are passed to tisTimeSync() in order to synchronize the current time.  Any other non DPU or spacecraft observatory messages are quietly discarded without reporting an error.In order to guarantee that ccmCmdTask() task reports in with the CCM Control Task periodically in absence of a ground command, the semaphore has a timeout value of 20 seconds.  If the semaphore times out, the task will verify no commands are on the Command Queue, and then report in to the CCM Control Task by calling ccmTaskReport().",1
  The DPU-CCM shall maintain counts of both the number of commands successfully received and rejected and report the parameters in DPU_HK.,"Error Collection and ReportingThe ccmErrEnq() function tracks the last error reported and its frequency of occurrence.  Once an error code has been reported it becomes the previously reported error code maintained by ccmErrEnq().  A repetition count is then incremented for each subsequent, consecutively reported, identical instance of this previously reported error.  If this error code is reported more than once in one high-rate housekeeping reporting period, then a special error, S_ccm_ERR_REPEAT is enqueued with the repetition count for the error encoded in the least significant byte. This mechanism effectively reduces the potential for housekeeping telemetry to become flooded with a single repeated error.",1
  The DPU-CCM shall maintain counts of both the number of commands successfully received and rejected and report the parameters in DPU_HK.,"Public FunctionsThis routine gets housekeeping data stored for the TMALI CSC including some DCI parameters and resets the tmali internal counters to zero.  When the caller supplied pointer to a TMALI_HK structure is NIL no data is returned but the tmali internal counters are still reset to zero.Two of the four error counters are updated within an ISR context, this requires a task switch safe implementation of these counters.  Within VxWorks this could be solved using a counting semaphore.  In the TMALI CSC design a faster method was used by using a free running error counter and a careful update of the reported number of errors, using an extra temporary variable.  As the increment and assignment of the 32 bit unsigned integers themselves are atomic operations the resulting counters are task safe and no error events are lost.  This means that the sum of the errors reported by the tmaliHkGet() function is equal to the total numbers of errors that occurred, no error reports are lost due to the update of the internal structures.",1
 The DPU-CCM shall use DPU-EEPRM to access the EEPROM.,Real-Time Clock InterfaceThe Real-Time Clock (RTC) Registers of the RAD6000 are special-purpose registers not normally accessible to C language programs.  Some assembler wrapper functions provide access to these.  ,1
 The DPU-CCM shall use DPU-ICUI to communicate with the ICU.,"Instrument Control Unit Interface CSCThe Instrument Control Unit Interface (ICUI) CSC is a new component that provides support for application-level communication with the INSTRUMENT X ICU.  The ICUI CSC is primarily responsible for implementing the application protocol with the ICU as defined in document DPUICD-01. In order to meet these objectives, ICUI provides: * An ICU Interface Message Send Function, icuiEnq(), which provides an API by which other CSCs can send messages to the ICU.* An ICU Interface Command Reader ISR, icuiCmdReceiveISR(), which receives Telecommands from the ICU and forwards them to the Command and Control Task for processing.* An ICU Interface Housekeeping Function, icuiHkGet(), which gathers ICU Interface housekeeping data at the request of the Command and Control Task.",1
" The DPU-TMALI shall install callbacks for handling all DPU-DCI interrupts including Error interrupt, Ping-Pong Timeout interrupt, and Ping-Pong Complete Flag interrupt.",Install Exception HandlersThis routine installs a hook routine for the Memory Error Interrupt.  The hook routine will be called from the interrupt context.  This function returns OK always.,1
 The DPU-TMALI shall be capable of making data available from the DCI to DPU-DPA.  DPU-TMALI will populate a ring buffer with frames of data for application task retrieval.,"Ring buffer data structureThe  CSC maintains a FIFO implemented as a ring buffer to temporarily store the data received from the DCI before it is processed. The ring buffer uses two pointers called pIn and pOut to keep track of the data in the buffer. The pointers were defined such that reading from the buffer is the simplest operation and only a single compare is needed to verify if the buffer is empty. The buffer only stores Events so the pointers point to these four byte entities. As the DCI specifies all data in bytes, sizes have to be converted before reading data.",1
 The DPU-TMALI shall be capable of making data available from the DCI to DPU-DPA.  DPU-TMALI will populate a ring buffer with frames of data for application task retrieval.,"Public FunctionsThis function returns the next EVENT in the queue to the caller.  The caller should store the value returned by this function in a variable defined locally within the scope of the function from which it is called.  If the return value is stored as described above, the EVENT value is stored in a RAD6000 register rather than memory.  Processing is therefore much faster since register accesses on the RAD6000 are much faster than memory accesses.A compilation option TMALI_NOCHECKS is provided for the disabling of buffer empty checks. This results in slightly faster code but should only be used when the application using this function is known to make proper calls to the function.  If the TMALI module is compiled with the TMALI_NOCHECKS option an improper call to the tmaliNextEvent function (calling it when no data is available in the TMALI buffer) will compromise the TMALI buffer data structure.The queue structure and the related pointers are described in the local tmaliP.h header file. As only the write pointer (pOut) is manipulated here and the operations on the 32 bit pointers themselves are 'atomic' no mutual exclusion problem can occur.  ",1
 The DPU-TMALI shall be capable of making data available from the DCI to DPU-DPA.  DPU-TMALI will populate a ring buffer with frames of data for application task retrieval.,"Public FunctionsThis task initializes the TMALI CSC and then continues to read data from the DCI and store it in the TMALI buffer each time the DCI driver signals that data is available in the Ping-Pong buffer.  The availability of data in the DCI Ping-Pong buffer is signaled to the tmaliTask using a semaphore.  Unless a fatal error is detected during initialization this task will never terminate.The specified 3 parameters specify the size of the TMALI queue and the initial parameters for the DCI, if the specified values are outside the allowed range default values will be used.The specified QueueSize is the allocated buffersize (in 4 byte EVENTS), the ring buffer is full when QueueSize-1 EVENTS are stored in the buffer.",1
  The DPU-TMALI shall provide a function which sets the current event bit ordering mode in the DCI driver.,"Public FunctionsThis routine provides a means to set the bit arrangement used by the DCI.  When bSpecialArrangement is TRUE, the DCI is set to special bit arrangement mode, otherwise the default mode of no rearrangement is set.",1
  The DPU-TMALI shall provide a function which sets the current event bit ordering mode in the DCI driver.,"Event ProcessingIf the Mode command is Instrument Y Mode, the detector events are spatially filtered to the Instrument Y window specified in the Mode command then the corresponding pixel in the Ping or Pong buffer is incremented.  If specified in the Mode command, pixels will be binned at AxA or BxB.  Also, if specified in the Mode command, a tracking frame data product will be produced for every Ping/Pong tracking frame. Instrument Y and Event Mode may be commanded simultaneously in the Mode command. If the ICU sends an XRT Position command, the Instrument Y mode and Event Mode windows will be resized to match the new window sizes in the command.",1
  The DPU-TMALI shall provide a function which sets the current event bit ordering mode in the DCI driver.,Raw Event List (RE) Engineering ModeThe purpose of Raw Event List Engineering Mode is to diagnose problems with the detector. Detector events produced in a given detector mode are collected over a commanded integration time and transmitted to the ground as a list of raw events.,1
 The DPU-TMALI  shall provide TMALI_HK to the DPU-CCM on request.,HousekeepingThe TMALI CSC collects housekeeping data that can be retrieved via a call to tmaliHkGet().   TMALI CSC housekeeping is returned via the TMALI_HK data structure.,1
 The DPU-TMALI  shall provide TMALI_HK to the DPU-CCM on request.,"Public FunctionsWhen no data is available in the TMALI queue this routine blocks on a semaphore awaiting availability of events on the TMALI queue as indicated by the ISR.  When data is already available on the TMALI queue, or the semaphore is taken, the number of events on the TMALI queue is determined and returned to the caller.  The parameter TickstoWait specifies the maximum time which the function can wait until data becomes available in kernel-ticks.  The parameter may be set to a symbolic value FOREVER which causes the function only to return when data is available.  When the function is called with a timeout value and no data becomes avialable within that period the function will return zero (events available).If the tmali task has not been initialized the function returns an error.",1
 The DPU-TMALI shall allocate a ring buffer of size specified by TMALI_BUFFER_SIZE provided during initialization for storing incoming frames of data.  The default buffer size shall be 15 MB.,"Public FunctionsThis task initializes the TMALI CSC and then continues to read data from the DCI and store it in the TMALI buffer each time the DCI driver signals that data is available in the Ping-Pong buffer.  The availability of data in the DCI Ping-Pong buffer is signaled to the tmaliTask using a semaphore.  Unless a fatal error is detected during initialization this task will never terminate.The specified 3 parameters specify the size of the TMALI queue and the initial parameters for the DCI, if the specified values are outside the allowed range default values will be used.The specified QueueSize is the allocated buffersize (in 4 byte EVENTS), the ring buffer is full when QueueSize-1 EVENTS are stored in the buffer.",1
 The DPU-TMALI shall configure the ping-pong frame limit at startup as specified by TMALI_PP_LIMIT provided during initialization.  The default value shall be M frames and shall be capable of being modified dynamically.,Normal Data Exchange SequenceThe TMALI CSC serves as an intermediate manager of EVENT data supplied by the DCI Driver CSC and eventually delivered to the DPA CSC.  The TMALI CSC waits for notification from the DCI CSC that a frame limit (or data timeout) has been reached in the Ping-Pong buffer indicating the EVENT data is ready to be served to TMALI.   TMALI reads all EVENT data from the DCI and notifies the DCI that it can swap Ping-Pong buffers when ready.   TMALI gives a semaphore to unblock the tmaliWait() call from the DPA.,1
 The DPU-TMALI shall configure the ping-pong frame limit at startup as specified by TMALI_PP_LIMIT provided during initialization.  The default value shall be M frames and shall be capable of being modified dynamically.,"Public FunctionsThis function gets the frame depth of the Ping-Pong buffers used by the DCI CSC.  The frame depth determines how many frames are read into the selected Ping-Pong buffer before interrupting.  The initial value for the frame depth setting is determined by the parameter provided when stating the tmaliTask.  The returned value is the current active value, this may differ from the last commanded value as the commanded value only takes effect when data is transferred from the hardware Ping-Pong buffer to the TMALI queue (in response to a frame or timeout interrupt, see section 5.13.2.3).",1
 The DPU-TMALI shall configure the ping-pong frame limit at startup as specified by TMALI_PP_LIMIT provided during initialization.  The default value shall be M frames and shall be capable of being modified dynamically.,"Public FunctionsThis function sets the frame depth of the Ping-Pong buffers used by the DCI CSC.  The frame depth determines how many frames are read into the selected Ping-Pong buffer before interrupting.  The initial value for the frame depth setting is determined by the parameter provided when starting the tmaliTask.  The maximum value to which the frame depth can be commanded is 64 frames, an attempt to command the frame depth to a value larger than this maximum will result in setting the timeout to the default value of V frames.The actual setting of the frame depth could be delayed by a small amount of time if there is activity on the DCI bus, and is typically changed when the DCI has just reported a frame level reached or timeout condition.  This minimizes the chance of changing the setting while the hardware is close to detecting a frame event.  Changing the frame depth while the DCI CSC is processing data could cause unpredictable results.  When a new tmaliDciFrameDepthSet command is send before the previous setting has been activated the new request will overwrite the previous request and the DCI will be commanded to the new value at the first available opportunity.",1
 The DPU-TMALI shall configure the DCI interface data timeout at startup as specified by TMALI_TIMEOUT provided during initialization.  The default value shall be N milliseconds and shall be capable of being modified dynamically.,"Setting Data Timeout in DCIDuring nominal operation, frames arrive approximately every 11 msecs.  The DCI hardware will generate an interrupt if event data has been received in one of the Ping-Pong buffers, and a configurable amount of time has passed during which no additional events have been received.  A data timeout interrupt is not an error, but rather typically indicates that the current exposure has been completed.  The data timeout interrupt allows the TMALI CSC to retrieve the trailing events from the DCI Ping-Pong buffer.  The function tmaliDciTimeoutSet() provides an API to the DCI Driver to allow the timeout setting to be altered.",1
 The DPU-TMALI shall configure the DCI interface data timeout at startup as specified by TMALI_TIMEOUT provided during initialization.  The default value shall be N milliseconds and shall be capable of being modified dynamically.,"Public FunctionsThis routine provides a means to set the bit arrangement used by the DCI.  When bSpecialArrangement is TRUE, the DCI is set to special bit arrangement mode, otherwise the default mode of no rearrangement is set.",1
 The DPU-TMALI shall configure the DCI interface data timeout at startup as specified by TMALI_TIMEOUT provided during initialization.  The default value shall be N milliseconds and shall be capable of being modified dynamically.,"Public FunctionsThis routine provides a means to get the current data timeout value used by the DCI.  The returned value is the current timeout in milliseconds.The timeout is discussed in document 036911400, section 4.3.2.4.1.3.",1
 The DPU-TMALI shall configure the DCI interface data timeout at startup as specified by TMALI_TIMEOUT provided during initialization.  The default value shall be N milliseconds and shall be capable of being modified dynamically.,"Public FunctionsThis routine provides a means to set the data timeout used by the DCI, the value requested indicates the timeout in milliseconds.  The initial value for the frame depth setting is determined by the parameter provided when starting the tmaliTask.  The maximum value to which the timeout can be commanded is X seconds, an attempt to set the timeout to a number larger than this maximum will result in setting the timeout to the default value of X milliseconds",1
" The DPU-TMALI shall utilize SCM_DCI_SR, along with ERRNO provided by DPU-DCI to decode errors and place them on an error queue for DPU-CCM.","Error Collection and ReportingThe DPU-CCM CSC provides a centralized error reporting interface, ccmErrEnq(), that other FSW tasks use to report errors.  Each time it wakes, ccmTask() checks to see if it is time to form an error/event packet for transmission to the ground.  If so, ccmTask() calls ccmHkMkError() to actually create the packet and forward it to DPU-SCUI for transmission to the ground.",1
" The DPU-TMALI shall utilize SCM_DCI_SR, along with ERRNO provided by DPU-DCI to decode errors and place them on an error queue for DPU-CCM.","Error Collection and ReportingAt boot time, no error queue exists because it has yet to be created.  Errors that occur in this early stage of error reporting are assigned directly to the global task variable errno.  The reader may refer to the VxWorks Programmers Guide, section 2.3.7 for more information on errno.  If errno is set after the error queues are created, it is queued to the Error Queue by calling ccmErrEnq(). ",1
" The DPU-TMALI shall utilize SCM_DCI_SR, along with ERRNO provided by DPU-DCI to decode errors and place them on an error queue for DPU-CCM.","Public FunctionsThis routine returns OK, or ERROR and sets errno if the passed parameter is NULL.  The following error codes may be returned in errno ",1
 The DPU-TMALI shall install a callback routine to respond to the DCI Error Interrupt.,"Public FunctionsThis routine initializes the interface to the ICU.  This routine opens SSI Driver port, installs the SSI interface interrupt callbacks, and enables Transmit Message Mode in the SSI Driver.",1
 The DPU-TMALI shall install a callback routine to respond to the DCI Error Interrupt.,Install Exception HandlersThis routine installs a hook routine for the Memory Error Interrupt.  The hook routine will be called from the interrupt context.  This function returns OK always.,1
  The DPU-TMALI shall place the starting address of the event ring buffer in TMALI_HK.,"DRAM BITPart of the memory is tested in Boot Sequence 1, and part of the memory is tested during Boot Sequence 2.  During Boot Sequence 1, ? KB of DRAM is tested before the Bootstrap is copied to this area.  During Boot Sequence 2, the  remaining memory is tested in ? KB blocks. The DRAM BIT first writes the address of each word in a block to that word in the block.   Then the test flushes the cache and reads back the entire block.  If a single-bit error occurs on the read-back, the location is read again.  If another single-bit error occurs, the test assumes a hard error and marks the whole block bad.  If a multiple-bit error occurs, the whole block is marked bad.  If the value read back does not match the address, the whole block is marked bad.  This same process is repeated with the ones complement of the address. The Bootstrap stores the results of the DRAM BIT in EEPROM as a series of x consecutive y-bit words.  Each bit in a result word represents the result of testing a ? KB block of DRAM.  These bits are mapped to DRAM by proceeding from least-significant bit (LSb) to most-significant bit (MSb) as the addresses of the memory blocks increase.  A set bit indicates that a block of DRAM has failed.  A clear bit indicates that a block of DRAM has passed the test.",1
  The DPU-TMALI shall place the starting address of the event ring buffer in TMALI_HK.,"Ring buffer data structureThe  CSC maintains a FIFO implemented as a ring buffer to temporarily store the data received from the DCI before it is processed. The ring buffer uses two pointers called pIn and pOut to keep track of the data in the buffer. The pointers were defined such that reading from the buffer is the simplest operation and only a single compare is needed to verify if the buffer is empty. The buffer only stores Events so the pointers point to these four byte entities. As the DCI specifies all data in bytes, sizes have to be converted before reading data.",1
  The DPU-TMALI shall place the starting address of the event ring buffer in TMALI_HK.,Ring buffer data structureThe pIn and pOut pointers are defined  as follows:* pIn- last location filled with data* pOut- last empty location,1
  The DPU-TMALI shall place the starting address of the event ring buffer in TMALI_HK.,"Public FunctionsThis routine initializes the interface to the ICU.  This routine opens SSI Driver port, installs the SSI interface interrupt callbacks, and enables Transmit Message Mode in the SSI Driver.",1
  The DPU-TMALI shall place the starting address of the event ring buffer in TMALI_HK.,Install Exception HandlersThis routine installs a hook routine for the Memory Error Interrupt.  The hook routine will be called from the interrupt context.  This function returns OK always.,1
 The DPU-SCUI shall time stamp the secondary header of the Source Packets with the current SC_TIME retrieved from the DPU-TIS module.,"Time SynchronizationThe interface with the spacecraft as described in document 1143-EI-S19121 specifies that the spacecraft will provide a Clock Message to each Instrument at a 1 Hz rate.  The Clock Message contains both two values: a value representing the current spacecraft time, and a value representing the delta from the spacecraft time and the Univeral Time (UT), based on an epoch of TBD.",1
 The DPU-SCUI shall time stamp the secondary header of the Source Packets with the current SC_TIME retrieved from the DPU-TIS module.,"Time SynchronizationThe time contained in the Clock Message is specified to be valid on the rising edge of the next 1PPS signal.  When the DPU receives the Clock Message, the 1553 ISR calls the tisTimeSync() function, forwarding the data portion of the clock message to the TIS CSC via the TIS_CLK_MSG data structure..  The tisTimeSync() function will immediately copy the spacecraft clock value to the DPU clock hardware registers. The DPU hardware is designed to latch in the new time on the rising edge of the next 1 PPS signal (the act of writing a new time to the hardware registers arms the latch function in the hardware).  Once the new time is latched, the hardware automatically disables the time latch function to avoid the potential of latching in an old time at the next 1 PPS signal.will be received within one second.  In the unlikely event a UT Delta is discarded, an event message is enqueued to ccmErrEnq() for informational purposes.",1
 The DPU-SCUI shall time stamp the secondary header of the Source Packets with the current SC_TIME retrieved from the DPU-TIS module.,"Time RetrievalThe DPU maintains a local copy of the spacecraft clock and current UT Delta in order that the DPU FSW can timestamp data products and packets.  The TIS CSC provides a function, tisTimeGet(), which retrieves a copy of both the current DPU clock value and the most recent UT Delta value.  Time is communicated among DPU FSW applications via the TIS_TIME data structure.",1
 The DPU-SCUI  shall be capable of packing created CCSDS Source Packets into STPDUs using segmented (grouped) packets for transfer to the SCU as defined by CCSDS-102.0-B-4 and in accordance with interface control document 1143-EI-S19121.,"remaining DPU FSW tasksFollowing startup, the Command and Control Task spawns the remaining DPU FSW tasks, which are described below:* The Command Dispatch Task (ccmCmdTask) is an Application Framework Software task which is responsible for dispatching commands which arrive from the ICU or the SCU.  Commands are executed directly by this task by calling the applicable CSC function* The SCU Interface Task (scuiDPTask) receives telemetry data from other tasks, converts them to CCSDS Version1 Source Packets, forms Company X Telemetry Protocol Data Units (STPDUs) from the Source Packets, and transmits the STPDUs to the SCU via the MIL-STD-1553B Interface.* The Telescope Module Event Transfer Task (tmaliTask) is an Application Framework Software task which is responsible for transferring data from the DCI ping/pong buffers to the TMALI data buffer in response to a DCI frame limit or data timeout interrupt.* The Data Compression Task (dcxTask) receives telemetry data from other tasks, uses a lossless data compression algorithm to compress the data, and then enqueues the data to the SCU Interface Task.* The Data Processing Algorithms Tasks (dpaIMTask and dpaEPTask) process incoming detector events according to the commanded mode, create data products, and enqueue those data products to the Data Compression Task (if compression is enabled) or to the SCU Interface Task.* The Error Detection and Correction Memory Scrubber Task (edacTask) cycles through the text and data segments of the DPU to trigger the correction of single-bit errors which may have occurred, in order to help prevent the occurrence of uncorrectable multiple-bit errors.",1
 The DPU-SCUI  shall notify the SCU of new data by using the Transfer Request Counter in accordance with interface control document 1143-EI-S19121.,"Telemetry Output to the Spacecraft 1553 BusThe SCU, which is a MIL-STD-1553 Bus Controller (BC), periodically reads the STPDU contained in the fifteen telemetry subaddresses, and then writes to the telemetry done subaddress.  When the telemetry done subaddress is written, the scuiTlmDoneISR() is called which gives a semaphore to awaken the scuiTask().  The software provides fault tolerance by automatically awaking after approximately two polling periods.  This timeout is automatically adjusted any time the SCU Poll Rate value is changed by command.",1
 The DPU-SCUI  shall notify the SCU of new data by using the Transfer Request Counter in accordance with interface control document 1143-EI-S19121.,"Public FunctionsThis routine is spawned by the Command and Control Task to initialize and execute the SCU Interface Data Processor Task.  This task initializes the SCUI CSC and then enters an infinite loop to process telemetry and produce STPDUs.  Once initialized, the task is awakened by a semaphore given when the SCU writes the telemetry done subaddress.",1
 The DPU-SCUI shall receive command messages in the form of Telecommand Packets from the SCU and make them available to the DPU-CCM.,"Command HandlingWhen a command arrives from the SCU (via the 1553 interface) or the ICU (via the SSI interface), the respective ISR will enqueue the command packet into a Command Queue, and then give the semaphore to awaken the ccmCmdTask().  Since it is possible for the DPU to send a command to itself, commands may arrive at interrupt context or task context.  Therefore the CCM maintains two queues  one for interrupt context which is not semaphore protected, and one for task context which is semaphore protected.",1
 The DPU-SCUI shall receive command messages in the form of Telecommand Packets from the SCU and make them available to the DPU-CCM.,SCU Interface CSCThe SCU Interface (SCUI) CSC is a Level 3 reuse component from the INSTRUMENT Y project.  The SCUI CSC is primarily responsible for implementing the application protocol with the SCU. The SCUI CSC provides CCSDS packetization services and manages the interface between the DPU and the SCU.,1
 The DPU-SCUI shall receive command messages in the form of Telecommand Packets from the SCU and make them available to the DPU-CCM.,"Receiving Commands from the SpacecraftThe DPU/SCU interface specifies that commands for the DPU will be transmitted from the SCU to the DPU on a separate MIL-STD-1553 subaddress.  The SCU Interface Command Reader ISR, scuiCmdReadISR(). consists of an ISR installed on a specific MIL-STD-1553 subaddress corresponding to the command subaddress for the INSTRUMENT X DPU. This ISR is installed at initialization by scuiInit().  Upon interrupt, the scuiCmdReadISR() reads a single telecommand from the 1553 bus, checks the length and checksum, and then forwards valid commands to the Command and Control CSC for dispatch via ccmCmdEnq().  Errors are reported by incrementing an invalid command counter.",1
 The DPU-SCUI shall receive command messages in the form of Telecommand Packets from the SCU and make them available to the DPU-CCM.,"Public FunctionsThe routine formats the given data into a CCSDS Telecommand Packet and writes it to the 1553 bus shared memory for transmission to the SCU.  If a message is already pending in the 1553 shared memory, the pending messages will be replaced in 1553 shared memory with the new message, and an error will be reported.",1
" The DPU-SCUI  shall provide the capability to handle high priority data.  High priority data shall be processed before low priority data.  In the condition  that low priority data is being processed when new high priority data arrives, DPU-SCUI shall finish processing the low priority data and then  immediately shift all resources to processing the high priority data.","InitializationThe SCUI CSC is initialized when the scuiTask() is spawned by the CCM CSC.  Initialization parameters which are passed into the scuiTask() include:* Poll Rate  rate at which the S/C will poll the DPU for telemetry.  The rate is specified in Hz, and has a default of X Hz based on the INSTRUMENT X-DPU poll rate in the Company X 1553 ICD.* Buffer Rate  value used to rate buffer data to the S/C.  The rate is specified in bits per telemetry poll, and has a default of 7664 which is equal to one STPDU per poll (*** bytes per STPDU times V bits/byte).  This default value effectively disables rate buffering.* Size of Low Priority Queue  size in bytes of the low priority telemetry queue.  If the amount requested cannot be allocated, the buffer will be allocated at  the amount of memory contained in the largest free memory block.Size of High Priority Queue  size in bytes of the high priority telemetry queue. If the amount requested cannot be allocated, the buffer will be allocated at  the amount of memory contained in the largest free memory block.",1
 The DPU-SCUI shall be capable of receiving a telecommand from the SCU every N ms and forward it to DPU-CCM for processing.,"Command and Control CSCThe Command and Control (CCM) CSC is a Level 2 reuse component from the INSTRUMENT Y project.  The Command and Control CSC includes the following components:* A Control Task, ccmCtrlTask(), which initializes the DPU FSW and spawns other tasks at bootup, schedules the production of DPU housekeeping data packets, monitors the execution of other tasks, and schedules the execution of other periodic tasks such as the heartbeat message and the watchdog strobe; and* A Command Dispatch Task, ccmCmdTask(), which receives and dispatches real-time commands received from the SCU or the ICU.Major data structures include:* A Static Data table that keeps track of the operational state.  Data included in this table includes housekeeping production rates, CCM specific flags, and the number of commands executed.* A Command Queue into which commands are placed when they arrive, via interrupt, from the ICU or the SCU.* An Error/Event Queue which accumulates error and event codes which are reported by the DPU FSW.  These error and event codes are removed from the queue and placed into a telemetry packet at a given interval and included in DPU housekeeping data.DPUSDS5.12.1.1.1Flight Software InitializationThe Command and Control CSC is initialized by spawning the CCM Control Task, ccmCtrlTask(), from the operating system startup task, usrRoot().  After the task is spawned it calls a function, ccmInit(), which creates the error/event queue, instantiates needed semaphores and installs various ISRs.  Finally, it spawns the remaining tasks which comprise the DPU FSW. When the CCM Control Task starts up, it reads DPU configuration startup defaults from the SYSTEM_CONFIG_AREA in EEPROM.  If the SYSTEM_CONFIG_AREA checksum is bad, hard-coded defaults are used.  The CCM Control Task initializes the remaining CSCs by calling the applicable initialization function, or if the CSC has an associated task, by spawning the task using the VxWorks function, taskSpawn().  When the CCM Control Task initializes a CSC, it passes the startup defaults read from EEPROM as parameters to the task initialization function. In addition to its task initialization activities, ccmInit(), also initializes the command length verification table by calling ccmCmdLengthInit().  The command processor uses the created table to verify expected command lengths for newly received commands.",1
 The DPU-SCUI shall be capable of receiving a telecommand from the SCU every N ms and forward it to DPU-CCM for processing.,"Command HandlingThe DPU accepts commands via two interfaces  from the Spacecraft via the MIL-STD-1553 interface, and from the ICU via the SSI interface.  Any of the DPU commands can be sent from the SCU or the ICU.  The source for a command from the DPU is one of the following:* ICU  command is generated and sent by the ICU via the SSI.* SCU  command is generated and sent by the SCU via the 1553.* G-ICU  command is generated on the ground and sent to the DPU via the ICU/SSI.* G-SCU  command is generated on the ground and sent to the DPU via the SCU/1553.",1
 The DPU-SCUI shall be capable of receiving a telecommand from the SCU every N ms and forward it to DPU-CCM for processing.,"Command HandlingWhen a command arrives from the SCU (via the 1553 interface) or the ICU (via the SSI interface), the respective ISR will enqueue the command packet into a Command Queue, and then give the semaphore to awaken the ccmCmdTask().  Since it is possible for the DPU to send a command to itself, commands may arrive at interrupt context or task context.  Therefore the CCM maintains two queues  one for interrupt context which is not semaphore protected, and one for task context which is semaphore protected.",1
 The DPU-SCUI shall be capable of receiving a telecommand from the SCU every N ms and forward it to DPU-CCM for processing.,"Transmitting Telemetry to the SpacecraftThe SCUI CSC receives telemetry as input Data Packages via queues populated by other tasksthe Science Data Processing Task, the Data Compression Task, and the Command and Control Task.  The SCUI CSC has a High Priority Queue and a Low Priority Queue.  The two queues are implemented in an identical manner with the exception that the scuiTask() gives processing preference to the High Priority Queue.  The purpose of the High Priority Queue is to provide a means by which the Parameterized Finding Chart and DPU housekeeping can be transmitted to the SCU ahead of the potentially large amounts of buffered science data.",1
 The DPU-SCUI shall be capable of receiving a telecommand from the SCU every N ms and forward it to DPU-CCM for processing.,"Data ProcessingThe DCX CSC is a task which receives data packages from other tasks, compresses the data using the VBTWL algorithm, and then forwards the compressed data package to the SCUI CSC.",1
 The DPU-SCUI shall rate-buffer the delivery of STPDUs to the SCU according to the SCU_BUFFER_RATE parameter provided during initialization.  The default value shall provide data to the SCU at a rate of X Kbps and shall be capable of being modified dynamically.,"Public FunctionsSets the poll rate and buffer rate to the given values.  If the values are out of range, the prior values are retained and an error is reported.  The scuiTask() semaphore timeout (scuiTaskTimeout) is automatically adjusted based on the given poll rate, by setting the timeout to approximately  the poll rate (not that the timeout is expressed in clock ticks, and so the resolution is low and only approximates  of the poll rate).",1
" The DPU-SCUI shall be capable of preparing one STPDU for delivery to the SCU every M milliseconds, or shall indicate a No Data condition to the SCU by maintaining an un-incremented ST_PDU Transfer Request Counter field.","Telemetry Output to the Spacecraft 1553 BusThe SCUI CSC reads the Data Packages from the queues and transforms them into CCSDS Version 1 Source Packets.  These Source Packets are then packed into the STPDU for transmission to the SCU.  This processing is performed by scuiConvertToSTPDU().   The STPDU, prefixed with a Transfer Request Counter (TRC), is then written to fifteen sequential 1553 subaddresses (as described in the Company X 1553 ICD) by the function scuiWrite().",1
" The DPU-SCUI, in the event of a buffer full condition, shall discard new data, return an error to the caller, and report an error condition to the DPU-CCM.","Error Collection and ReportingThe DPU-CCM CSC provides a centralized error reporting interface, ccmErrEnq(), that other FSW tasks use to report errors.  Each time it wakes, ccmTask() checks to see if it is time to form an error/event packet for transmission to the ground.  If so, ccmTask() calls ccmHkMkError() to actually create the packet and forward it to DPU-SCUI for transmission to the ground.",1
" The DPU-SCUI, in the event of a buffer full condition, shall discard new data, return an error to the caller, and report an error condition to the DPU-CCM.","Public FunctionsThis task initializes the TMALI CSC and then continues to read data from the DCI and store it in the TMALI buffer each time the DCI driver signals that data is available in the Ping-Pong buffer.  The availability of data in the DCI Ping-Pong buffer is signaled to the tmaliTask using a semaphore.  Unless a fatal error is detected during initialization this task will never terminate.The specified 3 parameters specify the size of the TMALI queue and the initial parameters for the DCI, if the specified values are outside the allowed range default values will be used.The specified QueueSize is the allocated buffersize (in 4 byte EVENTS), the ring buffer is full when QueueSize-1 EVENTS are stored in the buffer.",1
" The DPU-SCUI shall detect the condition in which the SCU fails to read one or more MIL-STD-1553B subaddresses during the transmission of a STPDU, shall cancel the write on those subaddresses, record new data to those subaddresses, and report an error to the DPU-CCM.","Telemetry Output to the Spacecraft 1553 BusThe SCU, which is a MIL-STD-1553 Bus Controller (BC), periodically reads the STPDU contained in the fifteen telemetry subaddresses, and then writes to the telemetry done subaddress.  When the telemetry done subaddress is written, the scuiTlmDoneISR() is called which gives a semaphore to awaken the scuiTask().  The software provides fault tolerance by automatically awaking after approximately two polling periods.  This timeout is automatically adjusted any time the SCU Poll Rate value is changed by command.",1
" The DPU-SCUI shall cancel the write to each subaddress if the SCU fails to read a pending STPDU after a timeout specified by a value calculated based on the SCU_POLL_RATE parameter provided during initialization, shall record new data to those subaddresses, and report an error to the DPU-CCM.  The SCU_POLL RATE parameter shall have a default setting of J ms and shall be capable of being modified dynamically.","Public FunctionsSets the poll rate and buffer rate to the given values.  If the values are out of range, the prior values are retained and an error is reported.  The scuiTask() semaphore timeout (scuiTaskTimeout) is automatically adjusted based on the given poll rate, by setting the timeout to approximately  the poll rate (not that the timeout is expressed in clock ticks, and so the resolution is low and only approximates  of the poll rate).",1
 The DPU-SCUI shall report errors to the DPU-CCM for inclusion in the DPU Housekeeping information.,External Program InterfacesThis routine copies the BIT Results into bitHk for inclusion in the DPU Housekeeping.,1
"  The DPU-SCUI shall compute a CHKS16 for telecommands received from the SCU.  If the CHKS16 does not match the value included in the telecommand,  an error will be reported to DPU-CCM.  If the checksum computes correctly, the command will be forwarded to DPU-CCM for execution.",SCU Interface CSCThis CSC performs rate-buffering of the downlink telemetry to the SCU according to a commandable parameter.  The rate at which the SCU polls the DPU is also commandable.  The CSC installs an ISR to collect telecommands from the SCU via the MILSTD1553B Interface.,1
"  The DPU-SCUI shall compute a CHKS16 for telecommands received from the SCU.  If the CHKS16 does not match the value included in the telecommand,  an error will be reported to DPU-CCM.  If the checksum computes correctly, the command will be forwarded to DPU-CCM for execution.","Receiving Commands from the SpacecraftThe DPU/SCU interface specifies that commands for the DPU will be transmitted from the SCU to the DPU on a separate MIL-STD-1553 subaddress.  The SCU Interface Command Reader ISR, scuiCmdReadISR(). consists of an ISR installed on a specific MIL-STD-1553 subaddress corresponding to the command subaddress for the INSTRUMENT X DPU. This ISR is installed at initialization by scuiInit().  Upon interrupt, the scuiCmdReadISR() reads a single telecommand from the 1553 bus, checks the length and checksum, and then forwards valid commands to the Command and Control CSC for dispatch via ccmCmdEnq().  Errors are reported by incrementing an invalid command counter.",1
"  The DPU-SCUI shall compute a CHKS16 for telecommands received from the SCU.  If the CHKS16 does not match the value included in the telecommand,  an error will be reported to DPU-CCM.  If the checksum computes correctly, the command will be forwarded to DPU-CCM for execution.","Data ProcessingData requiring compression is received via the dcxEnq() function, which has an API definition which matches the scuiEnq() API.  The DCX CSC handles the PKG_CTRL flags as described below:* PKG_COMPRESS  this flag is set to indicate if the package is actually compressed.* PKG_PRIORITY_HIGH  this flag is ignored by the DCX CSC but is forwarded to the SCUI CSC.* PKG_SEGMENT  this flag is ignored by the DCX CSC but is forwarded to the SCUI CSC.PKG_CHECKSUM  if set, the dcxEnq() function will compute a checksum which is appended to the data, and then the flag is negated.  The checksum will be compressed with the rest of the data, so that when the data is decompressed on the ground, the checksum can be recomputed and compared to provide a good indication of whether the decompressed copy of the data matches the original data set.",1
 The DPU-SCUI shall communicate with the SCU according to the protocol defined in document 1143-EI-S19121.,"Time SynchronizationThe interface with the spacecraft as described in document 1143-EI-S19121 specifies that the spacecraft will provide a Clock Message to each Instrument at a 1 Hz rate.  The Clock Message contains both two values: a value representing the current spacecraft time, and a value representing the delta from the spacecraft time and the Univeral Time (UT), based on an epoch of TBD.",1
  The DPU compression software shall forward compressed data  to DPU-SCUI.,"Data ProcessingThe DCX CSC is a task which receives data packages from other tasks, compresses the data using the VBTWL algorithm, and then forwards the compressed data package to the SCUI CSC.",1
 The DPU compression software shall report errors to the DPU-CCM for inclusion in the DPU Housekeeping information.,"Public FunctionsThis routine is called by any CSC in order to report an error or event that should be included in DPU housekeeping.  If this routine is called from interrupt context a static global variable, ccmISRError, is set so that the error can be enqueued later (see ccmCtrlTask()).  This is done since the error/event queue is semaphore-protected and a semaphore cannot be taken in an ISR.  The error queue semaphore has priority inversion set to reduce conflicts between multiple callers should a priority inversion situation arise. This routine also replaces frequently occuring errors with a special repeat error code.  The repeat error code is a special error code that follows a normally reported error code to indicate that the normally reported error code previously reported has occurred more than once in the last high rate reporting period",1
 The DPU compression software shall report errors to the DPU-CCM for inclusion in the DPU Housekeeping information.,External Program InterfacesThis routine copies the BIT Results into bitHk for inclusion in the DPU Housekeeping.,1
  The DPU-TIS shall provide the capability for application programs to access the SC_TIME from the SCM.,Real-Time Clock InterfaceThe Real-Time Clock (RTC) Registers of the RAD6000 are special-purpose registers not normally accessible to C language programs.  Some assembler wrapper functions provide access to these.  ,1
  The DPU-TIS shall provide the capability for application programs to access the current UT_DELTA.,"Structural DesignThe TIS CSC provides a library of functions to* initialize the DPU clock hardware at startup,* maintain synchronization of the DPU clock with the Spacecraft clock,* provide a function for use by other applications to retrieve the current values of the DPU clock and the UT Delta, and provide functions for use by the CCM command dispatcher to alter the configuration of the clock interface.",1
  The DPU-TIS shall provide the capability for application programs to access the current UT_DELTA.,"Time RetrievalThe DPU maintains a local copy of the spacecraft clock and current UT Delta in order that the DPU FSW can timestamp data products and packets.  The TIS CSC provides a function, tisTimeGet(), which retrieves a copy of both the current DPU clock value and the most recent UT Delta value.  Time is communicated among DPU FSW applications via the TIS_TIME data structure.",1
  The DPU-TIS shall provide the capability for application programs to access the current UT_DELTA.,"Public FunctionsThis routine returns a copy of the local copy of the spacecraft time maintained in the DPU hardware, and the UT Delta from the most recent Clock Message which is maintained in a static variable.  The caller may pass in NULL for either parameter.  If NULL is passed for both parameters, the function performs no action and returns OK.",1
  The DPU-TIS shall provide the capability for application programs to access the current UT_DELTA.,"Public FunctionsThis routine manually sets the values of the spacecraft time maintained in the DPU hardware, and the UT Delta maintained in a static variable, to the given values.",1
  The DPU-TIS shall provide the capability for application programs to access the current UT_DELTA.,"Public FunctionsThis routine extracts the current spacecraft time from the clock message and writes in to the hardware clock registers to be latched by the hardware at the next 1PPS signal, and maintains a copy of the UT Delta provided in the clock message.  If the UT Delta is currently being copied by an application, the UT Delta from the current message is discarded and an event is enqueued to ccmErrEnq().  If automatic time synchronization is disabled, this routine returns with no action taken. THIS ROUTINE IS INVOKED AT INTERRUPT CONTEXT.",1
"  The DPU-TIS shall provide the capability for an application program to set the value of the SC_TIME register(s) on the SCM and enable the 1PPS clock jam register, if automatic time synchronization is enabled.","Structural DesignThe TIS CSC provides a library of functions to* initialize the DPU clock hardware at startup,* maintain synchronization of the DPU clock with the Spacecraft clock,* provide a function for use by other applications to retrieve the current values of the DPU clock and the UT Delta, and provide functions for use by the CCM command dispatcher to alter the configuration of the clock interface.",1
"  The DPU-TIS shall provide the capability for an application program to set the value of the SC_TIME register(s) on the SCM and enable the 1PPS clock jam register, if automatic time synchronization is enabled.","Time Interface ConfigurationThe DPU hardware provides two configuration options to the software:* selection of the active A PPS signal, and* the option to manually jam a value into the clock registers without the A PPS signal.",1
"  The DPU-TIS shall provide the capability for an application program to set the value of the SC_TIME register(s) on the SCM and enable the 1PPS clock jam register, if automatic time synchronization is enabled.","Time Interface ConfigurationThe TIS CSC provides three functions for use by the CCM command dispatcher to control these values:* tis1ppsSet()  select active A PPS signal,* tisSyncModeSet()  set whether manual clock jamming is enabled, and        tisTimeSet()  manually jam a value into the DPU clock.",1
"  The DPU-TIS shall provide the capability for an application program to set the value of the SC_TIME register(s) on the SCM and enable the 1PPS clock jam register, if automatic time synchronization is enabled.","Time Interface ConfigurationThe TIS CSC utilizes the manual jam bit in the DCI CSR to indicate whether automatic time synchronization is enabled or disabled.  If automatic time synchronization is enabled, and a command is issued to manually jam the DPU clock, the command will be rejected - see tisTimeSet().",1
"  The DPU-TIS shall provide the capability for an application program to set the value of the SC_TIME register(s) on the SCM and enable the 1PPS clock jam register, if automatic time synchronization is enabled.","Public FunctionsInitializes the TIS CSC by initializing the hardware register convenience pointers and selecting the commanded 1PPS signal, and enables or disables automatic time synchronization with the S/C according to the passed parameter. THIS FUNCTION ALTERS THE VALUE OF THE DCI CSR AND SHOULD NOT BE INVOKED WHEN DCI INTERRUPTS ARE ACTIVE.",1
"  The DPU-TIS shall provide the capability for an application program to set the value of the SC_TIME register(s) on the SCM and enable the 1PPS clock jam register, if automatic time synchronization is enabled.","Public FunctionsOperationally, the DPU uses the Jam bit in the DCI CSR to indicate whether the DPU is actively syncing its clock with the spacecraft or not.  This function sets the Jam bit if autoSync is FALSE, and negates the Jam bit otherwise. THIS FUNCTION ALTERS THE VALUE OF THE DCI CSR AND SHOULD NOT BE INVOKED WHEN DCI INTERRUPTS ARE ACTIVE.",1
  The DPU-TIS shall provide the capability for an application program to select the active 1PPS signal.,"CPU BITThe CPU BIT consists of a series of tests designed to test each of the functional units of the processor.  These include test for the Branch-Unit, the Fixed-Point Unit, the Floating-Point Unit, the Interrupt-Unit, and the Timer Unit.   Each of these tests consists of executing a few selected instructions from the this functional unit. The General Purpose Registers (GPR), the Segment Registers (SR), the Counter Register (CTR), and the Condition Register are tested for stuck-bits as part of the Branch-Unit test.  This is done by writing a 1s pattern (verified by reading it back) and then writing a 0s pattern (verified by reading it back).",1
  The DPU-TIS shall provide the capability for an application program to select the active 1PPS signal.,InitializationThe TIS CSC is initialized by calling the tisInit() function.  The TIS CSC does not have an associated operating system task.  The TIS CSC will initialize the DPU hardware to perform or not perform automatic time synchronization with the spacecraft as indicated by an initialization parameter passed to the tisInit() function.  There are two 1 PPS signals between the DPU and the Spacecraft (a primary and alternate);  the TIS CSC will select the active 1 PPS signal according to the parameter passed to the tisInit() function.,1
  The DPU-TIS shall provide the capability for an application program to select the active 1PPS signal.,"Time Interface ConfigurationThe DPU hardware provides two configuration options to the software:* selection of the active A PPS signal, and* the option to manually jam a value into the clock registers without the A PPS signal.",1
  The DPU-TIS shall provide the capability for an application program to select the active 1PPS signal.,"Time Interface ConfigurationThe TIS CSC provides three functions for use by the CCM command dispatcher to control these values:* tis1ppsSet()  select active A PPS signal,* tisSyncModeSet()  set whether manual clock jamming is enabled, and        tisTimeSet()  manually jam a value into the DPU clock.",1
  The DPU-TIS shall provide the capability for an application program to select the active 1PPS signal.,"Public FunctionsInitializes the TIS CSC by initializing the hardware register convenience pointers and selecting the commanded 1PPS signal, and enables or disables automatic time synchronization with the S/C according to the passed parameter. THIS FUNCTION ALTERS THE VALUE OF THE DCI CSR AND SHOULD NOT BE INVOKED WHEN DCI INTERRUPTS ARE ACTIVE.",1
  The DPU-TIS shall report errors to an application program by setting the ERRNO task variable and returning ERROR.,"Error Collection and ReportingAt boot time, no error queue exists because it has yet to be created.  Errors that occur in this early stage of error reporting are assigned directly to the global task variable errno.  The reader may refer to the VxWorks Programmers Guide, section 2.3.7 for more information on errno.  If errno is set after the error queues are created, it is queued to the Error Queue by calling ccmErrEnq(). ",1
  The DPU-TIS shall report errors to an application program by setting the ERRNO task variable and returning ERROR.,"Public FunctionsThis routine returns OK, or ERROR and sets errno if the passed parameter is NULL.  The following error codes may be returned in errno ",1
  The DPU-ICUI shall receive real-time DPU_CMDs from the ICU via SSI and forward them to DPU-CCM.,"Command HandlingThe DPU accepts commands via two interfaces  from the Spacecraft via the MIL-STD-1553 interface, and from the ICU via the SSI interface.  Any of the DPU commands can be sent from the SCU or the ICU.  The source for a command from the DPU is one of the following:* ICU  command is generated and sent by the ICU via the SSI.* SCU  command is generated and sent by the SCU via the 1553.* G-ICU  command is generated on the ground and sent to the DPU via the ICU/SSI.* G-SCU  command is generated on the ground and sent to the DPU via the SCU/1553.",1
  The DPU-ICUI shall receive real-time DPU_CMDs from the ICU via SSI and forward them to DPU-CCM.,"Receiving Commands from the ICUThe interface to the ICU is via a synchronous serial interface (SSI) bus, which utilizes an inter-block gap (IBG) to delineate complete messages from one another.  The DPU hardware produces an interrupt when it detects an IBG, and the SSI Driver provides a mechanism by which an application can install an interrupt hook routine to respond to an IBG interrupt.  Upon initialization, the ICUI CSC installs a hook routine into the SSI Driver called icuiCommandReceiveISR(), which verifies the checksum of an incoming command, transmits an ACK/NAK message to the ICU, and then enqueues the command for later processing by calling ccmCmdEnq().  ",1
 The DPU-ICUI shall provide an API for other CSCs to transmit messages to the ICU.,"Telescope Module Access Library and Interface CSCThe TMALI CSC includes the following components:* A queue, TMALI_EVENT_QUEUE, implemented using a ring buffer, which contains the detector events which have been received over the data capture interface from the DCI Driver, but which have not yet been retrieved by the DPA CSC;* An API which facilitates the retrieval of detector events from the queue by the DPA CSC.  The API consists of the tmaliNextEvent() and tmaliWait() functions.* An set of API functions used by the DPA CSC to configure the DCI interface, including tmaliBitArrangementSet(), tmaliDciFrameDepthGet(), tmaliDciFrameDepthSet(), tmaliDciWindowSet(), tmaliDataTimeoutSet(), and tmaliDataTimeoutGet().* An API housekeeping function, tmaliHkGet(), which gathers  CSC housekeeping data at the request of the Command and Control Task.* The task tmaliTask() and an ISR tmaliTransferToQueueISR() work together via a semaphore to synchronize the transfer of data from the DCI to the  queueAn error handling ISR, tmaliDciErrorReportedISR(), is installed as a hook routine to the DCI Driver, and is used to keep track of the number of errors reported by the DCI driver.",1
 The DPU-ICUI shall provide an API for other CSCs to transmit messages to the ICU.,"Time Synchronization CSCThe Time Synchronization (TIS) CSC is a new component which provides services to maintain time synchronization between the DPU and the spacecraft, and which provides an API for retrieval of the current system time.",1
 The DPU-ICUI shall provide an API for other CSCs to transmit messages to the ICU.,"Instrument Control Unit Interface CSCThe Instrument Control Unit Interface (ICUI) CSC is a new component that provides support for application-level communication with the INSTRUMENT X ICU.  The ICUI CSC is primarily responsible for implementing the application protocol with the ICU as defined in document DPUICD-01. In order to meet these objectives, ICUI provides: * An ICU Interface Message Send Function, icuiEnq(), which provides an API by which other CSCs can send messages to the ICU.* An ICU Interface Command Reader ISR, icuiCmdReceiveISR(), which receives Telecommands from the ICU and forwards them to the Command and Control Task for processing.* An ICU Interface Housekeeping Function, icuiHkGet(), which gathers ICU Interface housekeeping data at the request of the Command and Control Task.",1
 The DPU-ICUI shall provide an API for other CSCs to transmit messages to the ICU.,"InitializationThe ICUI CSC is initialized by calling icuiInit().  The icuiInit() function opens the SSI interface port to the ICU, installs the transmit and receive ISRs, and enables Transmit Message Mode in the SSI Driver CSC.  The icuiInit() function is called by the CCM Control Task at bootup.",1
 The DPU-ICUI shall provide an API for other CSCs to transmit messages to the ICU.,"Receiving Commands from the ICUThe interface to the ICU is via a synchronous serial interface (SSI) bus, which utilizes an inter-block gap (IBG) to delineate complete messages from one another.  The DPU hardware produces an interrupt when it detects an IBG, and the SSI Driver provides a mechanism by which an application can install an interrupt hook routine to respond to an IBG interrupt.  Upon initialization, the ICUI CSC installs a hook routine into the SSI Driver called icuiCommandReceiveISR(), which verifies the checksum of an incoming command, transmits an ACK/NAK message to the ICU, and then enqueues the command for later processing by calling ccmCmdEnq().  ",1
 The DPU-ICUI shall provide an API for other CSCs to transmit messages to the ICU.,"Event ProcessingThe Event Processor Task, after receiving a Mode command from the ICU, configures the DPU DCI hardware, responds to the ICU with a Mode Ready message then receives detector events by calling functions tmaliWait() and tmaliNextEvent().  The Event Processor Task will collect detector events for the time period specified in the Mode command then issue a Mode Complete message to the ICU.  After issuing the Mode Complete message, the Event Processor Task will enter the Idle state.",1
  The DPU-ICUI shall report errors to DPU-CCM for inclusion in the DPU_HK.,"Control and MonitoringEvery time the CCM Control executes, it calls ccmPerProcess() to handle periodic processing responsibilities.  Such responsibilities include analog to digital conversion updates, DPU task monitoring, ICU heartbeat message production, and watchdog strobe. The ccmHealthChk() function, called by ccmPerProcess() verifies the execution of other tasks by monitoring the amount of time that has elapsed since each task last reported.  Other tasks report their execution to the CCM Control Task by calling the function, ccmTaskReport(), providing their task index.  Each task has an expected execution frequency, and if a task does not execute as expected, an error is reported in DPU housekeeping.  If the Command Dispatch Task fails to report for an extended period, the DPU will execute a reboot, since it is impossible to command the DPU if this task is not executing, otherwise it will strobe the watchdog",1
  The DPU-ICUI shall report errors to DPU-CCM for inclusion in the DPU_HK.,"Error Collection and ReportingThe DPU-CCM CSC provides a centralized error reporting interface, ccmErrEnq(), that other FSW tasks use to report errors.  Each time it wakes, ccmTask() checks to see if it is time to form an error/event packet for transmission to the ground.  If so, ccmTask() calls ccmHkMkError() to actually create the packet and forward it to DPU-SCUI for transmission to the ground.",1
  The DPU-ICUI shall report errors to DPU-CCM for inclusion in the DPU_HK.,"Error Collection and ReportingThe ccmErrEnq() function tracks the last error reported and its frequency of occurrence.  Once an error code has been reported it becomes the previously reported error code maintained by ccmErrEnq().  A repetition count is then incremented for each subsequent, consecutively reported, identical instance of this previously reported error.  If this error code is reported more than once in one high-rate housekeeping reporting period, then a special error, S_ccm_ERR_REPEAT is enqueued with the repetition count for the error encoded in the least significant byte. This mechanism effectively reduces the potential for housekeeping telemetry to become flooded with a single repeated error.",1
  The DPU-ICUI shall report errors to DPU-CCM for inclusion in the DPU_HK.,External Program InterfacesThis routine copies the BIT Results into bitHk for inclusion in the DPU Housekeeping.,1
"  The DPU-ICUI shall compute a CHKS_16 for DPU_CMDs received from the ICU.  If the expected checksum is not computed, the command will be discarded, an error will be enqueued to DPU-CCM, and a NAK message transmitted to the ICU within a second.","Sending Messages to the ICUSome special processing and checking is required in this function to handle the transmission of the ACK/NAK message.  When a command arrives from the ICU, the icuiCmdReceiveISR() will verify the message checksum and then send an ACK/NAK message to the ICU.  It is possible that an application is in the midst of sending a message to the ICU at the time a command interrupt occurs.  However, since it is not possible for an ISR to take a semaphore, an additional mechanism is required in order to provide mutual exclusion between a task an the ISR.  To accommodate this problem, the icuiEnq() function first determines whether it is being invoked from interrupt context.  If so, it then tests the value of a static variable, icuiEnqBusy.  If the variable is set, the function will save the given ACK/NAK message parameters in static variables and return.  If the variable is not set, the function will continue as normal (avoiding the semTake() and semGive() calls).  In normal execution, the icuiEnqBusy variable is set on entry and negated on exit, after which the static variables containing the ACK/NAK message parameters will be checked to determine whether an ACK/NAK is pending.",1
"  The DPU-ICUI shall check the length of a received DPU_CMD against the message length determined by the Inter-Block Gap.  If the received value does not match, then the command will be discarded, and an error will be enqueued to DPU-CCM, and a NAK message transmitted to the ICU within a second.","Sending Messages to the ICUSome special processing and checking is required in this function to handle the transmission of the ACK/NAK message.  When a command arrives from the ICU, the icuiCmdReceiveISR() will verify the message checksum and then send an ACK/NAK message to the ICU.  It is possible that an application is in the midst of sending a message to the ICU at the time a command interrupt occurs.  However, since it is not possible for an ISR to take a semaphore, an additional mechanism is required in order to provide mutual exclusion between a task an the ISR.  To accommodate this problem, the icuiEnq() function first determines whether it is being invoked from interrupt context.  If so, it then tests the value of a static variable, icuiEnqBusy.  If the variable is set, the function will save the given ACK/NAK message parameters in static variables and return.  If the variable is not set, the function will continue as normal (avoiding the semTake() and semGive() calls).  In normal execution, the icuiEnqBusy variable is set on entry and negated on exit, after which the static variables containing the ACK/NAK message parameters will be checked to determine whether an ACK/NAK is pending.",1
"  The DPU-ICUI shall check the length of a received DPU_CMD against the message length determined by the Inter-Block Gap.  If the received value does not match, then the command will be discarded, and an error will be enqueued to DPU-CCM, and a NAK message transmitted to the ICU within a second.","Receiving Commands from the ICUThe interface to the ICU is via a synchronous serial interface (SSI) bus, which utilizes an inter-block gap (IBG) to delineate complete messages from one another.  The DPU hardware produces an interrupt when it detects an IBG, and the SSI Driver provides a mechanism by which an application can install an interrupt hook routine to respond to an IBG interrupt.  Upon initialization, the ICUI CSC installs a hook routine into the SSI Driver called icuiCommandReceiveISR(), which verifies the checksum of an incoming command, transmits an ACK/NAK message to the ICU, and then enqueues the command for later processing by calling ccmCmdEnq().  ",1
 The DPU-ICUI shall use DPU-SSI to communicate with the SSI Interface.,"Public FunctionsThis routine is called by the MIL-STD-1553 Command ISR and the SSI Interface ISR any time a command arrives from the SCU or the ICU, to enqueue the command and to wakeup the CCM Command Dispatch Task so that the command can be executed.",1
 The DPU-ICUI shall use DPU-SSI to communicate with the SSI Interface.,"InitializationThe ICUI CSC is initialized by calling icuiInit().  The icuiInit() function opens the SSI interface port to the ICU, installs the transmit and receive ISRs, and enables Transmit Message Mode in the SSI Driver CSC.  The icuiInit() function is called by the CCM Control Task at bootup.",1
 The DPU-ICUI shall use DPU-SSI to communicate with the SSI Interface.,"Sending Messages to the ICUIn order to send messages to the ICU, the DPU FSW tasks call icuiEnq().  The calling application passes the function code of the message to be sent, as well as a pointer to a data structure containing the message parameters associated with the given function code.  The icuiEnq() function formats the message according to the ICU/DPU ICD using icuiMsgFormat(), and then writes the message to SSI Driver transmitter buffer by calling the driver write() function. A mutual exclusion semaphore, icuiSemWrite, protects the SSI Driver from being written by multiple tasks simultaneously.  A timeout parameter lets the caller control how long it is willing to block on this semaphore if there is an access conflict.",1
 The DPU-ICUI shall use DPU-SSI to communicate with the SSI Interface.,"Receiving Commands from the ICUThe interface to the ICU is via a synchronous serial interface (SSI) bus, which utilizes an inter-block gap (IBG) to delineate complete messages from one another.  The DPU hardware produces an interrupt when it detects an IBG, and the SSI Driver provides a mechanism by which an application can install an interrupt hook routine to respond to an IBG interrupt.  Upon initialization, the ICUI CSC installs a hook routine into the SSI Driver called icuiCommandReceiveISR(), which verifies the checksum of an incoming command, transmits an ACK/NAK message to the ICU, and then enqueues the command for later processing by calling ccmCmdEnq().  ",1
 The DPU-ICUI shall use DPU-SSI to communicate with the SSI Interface.,"Public FunctionsThis routine is used to format messages for transmission to the ICU and to place those messages on the SSI Driver Transmitter Queue. The functionCode parameter is used to create the CCSDS Packet APID and the Message Identifier (refer to document DPUICD-01).  A mutual exclusion semaphore, icuiSemWrite, protects the SSI Driver from being written by multiple tasks simultaneously.  The timeout parameter lets the caller control how long it is willing to block on this semaphore if there is an access conflict.This routine may be called at interrupt context to transmit an ACK/NAK message.  In that case, the semaphore is not taken since it is not valid to take a semaphore at interrupt context.  Refer to discussion of the design to accommodate the ACK/NAK message.",1
 The DPU-ICUI shall use DPU-SSI to communicate with the SSI Interface.,"Public FunctionsThis routine initializes the interface to the ICU.  This routine opens SSI Driver port, installs the SSI interface interrupt callbacks, and enables Transmit Message Mode in the SSI Driver.",1
 The DPU-ICUI shall use DPU-SSI to communicate with the SSI Interface.,Synchronous Serial Interface Driver CSCThe Synchronous Serial Interface (SSI) Driver CSC is a new driver which provides an application layer interface to the SSI hardware.  The SSI Driver CSC is implemented on top of the VxWorks tyLib library to manage its ring buffers.   The driver features a standard I/O interface which utilizes an extended ioctl() command set to support unique SSI hardware attributes.  This driver is patterned after the older VxWorks 5.2 serial driver architecture rather than the newer Tornado serial driver architecture due to the lack of programmer control over I/O in the newer Tornado driver architecture. ,1
 The DPU-ICUI shall use DPU-SSI to communicate with the SSI Interface.,Standard I/O InterfaceSSI ioctl() commands.,1
 The DPU-ICUI shall use DPU-SSI to communicate with the SSI Interface.,InitializationThe SSI Driver CSC is initialized by calling the function ssiDrv() from the startup task usrRoot().,1
" The DPU-ICUI shall install an ISR to be invoked on the SSI receiver interblock gap interrupt, for the receiving and processing of commands from the ICU.","Public FunctionsThis routine is called by the MIL-STD-1553 Command ISR and the SSI Interface ISR any time a command arrives from the SCU or the ICU, to enqueue the command and to wakeup the CCM Command Dispatch Task so that the command can be executed.",1
" The DPU-ICUI shall install an ISR to be invoked on the SSI receiver interblock gap interrupt, for the receiving and processing of commands from the ICU.","Receiving Commands from the SpacecraftThe DPU/SCU interface specifies that commands for the DPU will be transmitted from the SCU to the DPU on a separate MIL-STD-1553 subaddress.  The SCU Interface Command Reader ISR, scuiCmdReadISR(). consists of an ISR installed on a specific MIL-STD-1553 subaddress corresponding to the command subaddress for the INSTRUMENT X DPU. This ISR is installed at initialization by scuiInit().  Upon interrupt, the scuiCmdReadISR() reads a single telecommand from the 1553 bus, checks the length and checksum, and then forwards valid commands to the Command and Control CSC for dispatch via ccmCmdEnq().  Errors are reported by incrementing an invalid command counter.",1
" The DPU-ICUI shall install an ISR to be invoked on the SSI receiver interblock gap interrupt, for the receiving and processing of commands from the ICU.","InitializationThe ICUI CSC is initialized by calling icuiInit().  The icuiInit() function opens the SSI interface port to the ICU, installs the transmit and receive ISRs, and enables Transmit Message Mode in the SSI Driver CSC.  The icuiInit() function is called by the CCM Control Task at bootup.",1
" The DPU-ICUI shall install an ISR to be invoked on the SSI receiver interblock gap interrupt, for the receiving and processing of commands from the ICU.","Receiving Commands from the ICUThe interface to the ICU is via a synchronous serial interface (SSI) bus, which utilizes an inter-block gap (IBG) to delineate complete messages from one another.  The DPU hardware produces an interrupt when it detects an IBG, and the SSI Driver provides a mechanism by which an application can install an interrupt hook routine to respond to an IBG interrupt.  Upon initialization, the ICUI CSC installs a hook routine into the SSI Driver called icuiCommandReceiveISR(), which verifies the checksum of an incoming command, transmits an ACK/NAK message to the ICU, and then enqueues the command for later processing by calling ccmCmdEnq().  ",1
" The DPU-ICUI shall install an ISR to be invoked on the SSI receiver interblock gap interrupt, for the receiving and processing of commands from the ICU.","Public FunctionsThis routine initializes the interface to the ICU.  This routine opens SSI Driver port, installs the SSI interface interrupt callbacks, and enables Transmit Message Mode in the SSI Driver.",1
" The DPU-ICUI shall install an ISR to be invoked on the SSI receiver interblock gap interrupt, for the receiving and processing of commands from the ICU.","Transmit Message Mode(FIOSSIBGTXMSGENABLE) and Inter-Block Gap interruptsThe SSI Driver CSC supports a message mode to facilitate application level communication.  This mode uses the Inter-Block Gap interrupt generated by the hardware to synchronize message transmission. When in a messaging mode, the driver enables an internal Byte Count queue provides a synchronization mechanism for sending messages.  This Byte Count queue is updated with the message size as Inter-Block Gap interrupts are received. The Transmit Message Mode uses the BGTX interrupt, the Tx FIFO Empty Interrupt, the write() call, and an internal Byte Count queue to synchronize the transmission of messages over SSI.  In this mode, the maxBytes parameter passed to write() is enqueued to the Byte Count queue.  When a period of time equal to or greater than the Interblock Gap time has expired, the BGTX interrupt will be asserted.  At this time, the driver will respond and initiate a new transfer by setting a Byte Transfer Limit for this block and enabling the Tx FIFO Empty Interrupt.  The Byte Transfer Limit corresponds to the entry on the Byte Count queue.  When all bytes in the current block have been sent up to the Byte Transfer Limit, the Tx FIFO ISR will disable itself and reset the Byte Transfer Limit to zero. An application may use this mode by calling write() with a buffer pointer and maxBytes in order to transfer a message of a particular length.",1
"  The DPU-ICUI shall format messages according to DPUICD-01, Section 3.1","Public FunctionsThis routine is used to format messages for transmission to the ICU and to place those messages on the SSI Driver Transmitter Queue. The functionCode parameter is used to create the CCSDS Packet APID and the Message Identifier (refer to document DPUICD-01).  A mutual exclusion semaphore, icuiSemWrite, protects the SSI Driver from being written by multiple tasks simultaneously.  The timeout parameter lets the caller control how long it is willing to block on this semaphore if there is an access conflict.This routine may be called at interrupt context to transmit an ACK/NAK message.  In that case, the semaphore is not taken since it is not valid to take a semaphore at interrupt context.  Refer to discussion of the design to accommodate the ACK/NAK message.",1
 The DPU-DPA shall be able to perform tracking based on data collected from the detector by calculating the spacecraft drift using successive tracking frames using the algorithm described in Appendix C.,"Telemetry Output to the Spacecraft 1553 BusThe SCU, which is a MIL-STD-1553 Bus Controller (BC), periodically reads the STPDU contained in the fifteen telemetry subaddresses, and then writes to the telemetry done subaddress.  When the telemetry done subaddress is written, the scuiTlmDoneISR() is called which gives a semaphore to awaken the scuiTask().  The software provides fault tolerance by automatically awaking after approximately two polling periods.  This timeout is automatically adjusted any time the SCU Poll Rate value is changed by command.",1
" There shall be four engineering modes associated with the detector: raw event list mode, channel boundary mode, centroid confirmation mode, and intensifier characteristics mode.","Full-Frame (FF) Engineering ModeThe purpose of Full-Frame Engineering Mode is to monitor the health of the detector to locate hot spots and dead pixels. Detector events produced in Full Frame High Resolution detector format are received and histogrammed for a commanded integration time.  The entire Instrument Y is transmitted to the ground.  This mode can use high resolution (all pixels) or low resolution imaging (BxB , DxD pixel binning).",1
" There shall be four engineering modes associated with the detector: raw event list mode, channel boundary mode, centroid confirmation mode, and intensifier characteristics mode.",Raw Event List (RE) Engineering ModeThe purpose of Raw Event List Engineering Mode is to diagnose problems with the detector. Detector events produced in a given detector mode are collected over a commanded integration time and transmitted to the ground as a list of raw events.,1
" There shall be four engineering modes associated with the detector: raw event list mode, channel boundary mode, centroid confirmation mode, and intensifier characteristics mode.","Channel Boundary (CB) Engineering ModeThe purpose of Channel Boundary Mode is to derive the optimum channel boundary settings from a flat field. Detector events produced in the M,N detector mode are collected and histogrammed for a commanded integration time.  The pseudo Instrument Y is transmitted to the ground.  Channel boundaries are derived from the Instrument Y and transmitted to the ICU and the ground.  Channel boundaries are sent by the ICU to the BPE and used in the detector event centroiding process.",1
" There shall be four engineering modes associated with the detector: raw event list mode, channel boundary mode, centroid confirmation mode, and intensifier characteristics mode.","Centroiding Confirmation (CC) Engineering ModeThe purpose of Centroiding Confirmation Engineering Mode is to determine the validity of derived channel boundaries. Detector events are collected and histogrammed for a commanded integration time.  The full field is divided into 8x8 sub-Instrument Ys, each of ExEcentroided (by 8) pixels.  These sub-Instrument Ys are then modulo binned to produce a set of 8x8 pixels pseudo-Instrument Ys.  The Instrument Ys are column (y axis) ordered, as are the pixels within them.  These pseudo Instrument Ys are transmitted to the ground.",1
" There shall be four engineering modes associated with the detector: raw event list mode, channel boundary mode, centroid confirmation mode, and intensifier characteristics mode.",Intensifier Characteristics (IC) Engineering ModeThe purpose of Intensifier Characteristics Engineering Mode is to assess detector health and performance. Detector events produced in Full Frame High Resolution detector format are collected and histogrammed for a commanded integration time to produce a pulse-height histogram.,1
" There shall be four engineering modes associated with the detector: raw event list mode, channel boundary mode, centroid confirmation mode, and intensifier characteristics mode.",Public FunctionsThis routine provides a means for the CCM task to send a Mode command from the ICU to the DPA software. The Mode command shall be used to command the DPU into a particular science or engineering event processing mode.  The mode shall become effective after the DPU has sent the Mode Ready message to the ICU.,1
" In Image Mode, the DPU-DPA shall be capable of binning images at different levels.","Event ProcessingIf the Mode command is Instrument Y Mode, the detector events are spatially filtered to the Instrument Y window specified in the Mode command then the corresponding pixel in the Ping or Pong buffer is incremented.  If specified in the Mode command, pixels will be binned at AxA or BxB.  Also, if specified in the Mode command, a tracking frame data product will be produced for every Ping/Pong tracking frame. Instrument Y and Event Mode may be commanded simultaneously in the Mode command. If the ICU sends an XRT Position command, the Instrument Y mode and Event Mode windows will be resized to match the new window sizes in the command.",1
  The  raw event list engineering mode shall collect events for transmission to the ground.,"Data ProcessingData requiring compression is received via the dcxEnq() function, which has an API definition which matches the scuiEnq() API.  The DCX CSC handles the PKG_CTRL flags as described below:* PKG_COMPRESS  this flag is set to indicate if the package is actually compressed.* PKG_PRIORITY_HIGH  this flag is ignored by the DCX CSC but is forwarded to the SCUI CSC.* PKG_SEGMENT  this flag is ignored by the DCX CSC but is forwarded to the SCUI CSC.PKG_CHECKSUM  if set, the dcxEnq() function will compute a checksum which is appended to the data, and then the flag is negated.  The checksum will be compressed with the rest of the data, so that when the data is decompressed on the ground, the checksum can be recomputed and compared to provide a good indication of whether the decompressed copy of the data matches the original data set.",1
  The  raw event list engineering mode shall collect events for transmission to the ground.,"Data ProcessingWhen the DCX CSC compresses a data package, the given APID is incremented by one.  If the compressed copy of data is larger than original data set, the original data set will be forwarded to the SCUI CSC, an event S_dcx_UNC_USED is enqueued to ccmErrEnq(), and the APID is not incremented.  In this way, the ground systems can discern compressed packets from non-compressed packets.",1
" The channel boundary engineering mode shall create an array of look-up table (LUT) channel boundaries, PROD_CHAN_BOUND, from a flat field, and PROD_MN_DATA, using the algorithm described in Appendix C.","Data Processing Algorithm CSCThe DPA CSC includes the following components:* Algorithms  o Choose Guide Stars scans the bright stars in the reference frame, chooses guide stars and sets up tracking windows around the guide stars.o Drift Correction calculates the drift offset and roll of a just-completed tracking frame relative to the reference frame. o Create Finding Chart will use the above Choose Guide Stars Algorithm to find the brightest stars in the finding chart Instrument Y then creates a list of the brightest stars and their intensities.o Derive Channel Boundaries calculates a set of channel boundaries (18 numbers - 9X, 9Y) which are used by the centroiding software in the Blue Processing Electronics (BPE) in the Telescope Module.",1
  The centroid confirmation engineering mode shall produce a PROD_CENTROID_CONF.  This mode shall divide a full frame image into a certain regions.  Each region shall be processed to form an 8x8 confirmation image.  The certain confirmation images shall be sent to the solid state recorder as one data product.,"Centroiding Confirmation (CC) Engineering ModeThe purpose of Centroiding Confirmation Engineering Mode is to determine the validity of derived channel boundaries. Detector events are collected and histogrammed for a commanded integration time.  The full field is divided into 8x8 sub-Instrument Ys, each of ExEcentroided (by 8) pixels.  These sub-Instrument Ys are then modulo binned to produce a set of 8x8 pixels pseudo-Instrument Ys.  The Instrument Ys are column (y axis) ordered, as are the pixels within them.  These pseudo Instrument Ys are transmitted to the ground.",1
"  The Intensifier Characteristics Engineering mode shall produce a pulse-height histogram, PROD_INTENSE_CHAR.","Data Processing Algorithm CSCThe DPA CSC includes the following components:* Instrument Y Processor Task  creates histogrammed Instrument Ys, performs Tracking (choose guide stars, drift correction, shift-and-add), creates the Reference, Accumulation, and Data Product buffers, and provides a task heartbeat to the CCM task.",1
"  The Intensifier Characteristics Engineering mode shall produce a pulse-height histogram, PROD_INTENSE_CHAR.",Intensifier Characteristics (IC) Engineering ModeThe purpose of Intensifier Characteristics Engineering Mode is to assess detector health and performance. Detector events produced in Full Frame High Resolution detector format are collected and histogrammed for a commanded integration time to produce a pulse-height histogram.,1
"  When observing a new GRB, and the XRT_POS becomes available from the ICU, the DPU-DPA shall shift and resize the image and event windows appropriately.","Event ProcessingIf the Mode command is Instrument Y Mode, the detector events are spatially filtered to the Instrument Y window specified in the Mode command then the corresponding pixel in the Ping or Pong buffer is incremented.  If specified in the Mode command, pixels will be binned at AxA or BxB.  Also, if specified in the Mode command, a tracking frame data product will be produced for every Ping/Pong tracking frame. Instrument Y and Event Mode may be commanded simultaneously in the Mode command. If the ICU sends an XRT Position command, the Instrument Y mode and Event Mode windows will be resized to match the new window sizes in the command.",1
"  When observing a new GRB, and the XRT_POS becomes available from the ICU, the DPU-DPA shall shift and resize the image and event windows appropriately.",Public FunctionsThis routine provides a means for the CCM task to send the XRT Position command from the ICU to the DPA software. The XRT Position command shall be used to command the DPU to update the position and window parameters that it uses to spatially filter event data. ,1
"  The DPU-DPA shall command DPU-TMALI to reorder EVENT data bits as a function of the Detector Electronics Output Format (Science Mode 3, Full-Frame High Res), and the commanded DPU science or engineering mode.  ",Telescope Module Access Library and Interface CSCThe Telescope Module Access Library and Interface (TMALI) CSC manages the detector event queue and provides an API for the retrieval of detector events from that queue to the data processing algorithms.,1
  The DPU-DPA will obtain the initial tracking frame time from the ICU.,"Event ProcessingThe Event Processor Task, after receiving a Mode command from the ICU, configures the DPU DCI hardware, responds to the ICU with a Mode Ready message then receives detector events by calling functions tmaliWait() and tmaliNextEvent().  The Event Processor Task will collect detector events for the time period specified in the Mode command then issue a Mode Complete message to the ICU.  After issuing the Mode Complete message, the Event Processor Task will enter the Idle state.",1
  The DPU-DPA will obtain the initial tracking frame time from the ICU.,"Public FunctionsThis routine provides a means for the CCM task to send the Stop Mode command from the ICU to the DPA software. The Stop Mode command shall be used to command the DPU to immediately stop processing events, complete the current data product, purge events from the DPU hardware, and enter Idle Mode.  The data product will include the actual exposure time and the number of frames.  In response to this command, the DPU shall issue a Mode Complete command to the ICU after finishing the before-mentioned tasks.",1
  The DPU-DPA shall provide a task heartbeat to DPU-CCM.,"Data Processing Algorithm CSCThe DPA CSC includes the following components:* Event Processor Task  communicates with the ICU, creates event list data products, creates Tracking Instrument Ys in the Ping/Pong buffers, creates the Finding Chart, performs the Engineering Modes, generates housekeeping data, creates the Event Frame, Ping and Pong buffers, and provides a task heartbeat to the CCM task.",1
  The DPU-DPA shall provide a task heartbeat to DPU-CCM.,"Data Processing Algorithm CSCThe DPA CSC includes the following components:* Instrument Y Processor Task  creates histogrammed Instrument Ys, performs Tracking (choose guide stars, drift correction, shift-and-add), creates the Reference, Accumulation, and Data Product buffers, and provides a task heartbeat to the CCM task.",1
  The DPU-DPA shall be capable of providing DPA_HK on request.,"Telescope Module Access Library and Interface CSCThe TMALI CSC includes the following components:* A queue, TMALI_EVENT_QUEUE, implemented using a ring buffer, which contains the detector events which have been received over the data capture interface from the DCI Driver, but which have not yet been retrieved by the DPA CSC;* An API which facilitates the retrieval of detector events from the queue by the DPA CSC.  The API consists of the tmaliNextEvent() and tmaliWait() functions.* An set of API functions used by the DPA CSC to configure the DCI interface, including tmaliBitArrangementSet(), tmaliDciFrameDepthGet(), tmaliDciFrameDepthSet(), tmaliDciWindowSet(), tmaliDataTimeoutSet(), and tmaliDataTimeoutGet().* An API housekeeping function, tmaliHkGet(), which gathers  CSC housekeeping data at the request of the Command and Control Task.* The task tmaliTask() and an ISR tmaliTransferToQueueISR() work together via a semaphore to synchronize the transfer of data from the DCI to the  queueAn error handling ISR, tmaliDciErrorReportedISR(), is installed as a hook routine to the DCI Driver, and is used to keep track of the number of errors reported by the DCI driver.",1
  The DPU-DPA shall be capable of providing DPA_HK on request.,Public FunctionsThis routine provides a means for the CCM task to get the housekeeping info from the DPA software.  The CCM task will call this function and pass a pointer to the location that DPA is to store its housekeeping. ,1
  The DPU-DPA will complete the exposure in the time specified by the MODE command - even if it's required to truncate the final tracking frame.,Public FunctionsThis routine provides a means for the CCM task to send a Mode command from the ICU to the DPA software. The Mode command shall be used to command the DPU into a particular science or engineering event processing mode.  The mode shall become effective after the DPU has sent the Mode Ready message to the ICU.,1
  The DPU-DPA will complete the exposure in the time specified by the MODE command - even if it's required to truncate the final tracking frame.,"Public FunctionsThis routine provides a means for the CCM task to send the Stop Mode command from the ICU to the DPA software. The Stop Mode command shall be used to command the DPU to immediately stop processing events, complete the current data product, purge events from the DPU hardware, and enter Idle Mode.  The data product will include the actual exposure time and the number of frames.  In response to this command, the DPU shall issue a Mode Complete command to the ICU after finishing the before-mentioned tasks.",1
"  The DPU-DPA shall collect event mode data, preserving the time and spatial resolution in the specified event window.",Public FunctionsThis routine provides a means for the CCM task to send the XRT Position command from the ICU to the DPA software. The XRT Position command shall be used to command the DPU to update the position and window parameters that it uses to spatially filter event data. ,1
  The DPU-DPA shall be capable of collecting detector events over the full  FOV.,Raw Event List (RE) Engineering ModeThe purpose of Raw Event List Engineering Mode is to diagnose problems with the detector. Detector events produced in a given detector mode are collected over a commanded integration time and transmitted to the ground as a list of raw events.,1
  The DPU-DPA shall be capable of collecting detector events over the full  FOV.,Intensifier Characteristics (IC) Engineering ModeThe purpose of Intensifier Characteristics Engineering Mode is to assess detector health and performance. Detector events produced in Full Frame High Resolution detector format are collected and histogrammed for a commanded integration time to produce a pulse-height histogram.,1
"  The DPU-DPA shall transition MODE based on the protocol specified in document DPUICD-01, section 2.2","Instrument Control Unit Interface CSCThe Instrument Control Unit Interface (ICUI) CSC is a new component that provides support for application-level communication with the INSTRUMENT X ICU.  The ICUI CSC is primarily responsible for implementing the application protocol with the ICU as defined in document DPUICD-01. In order to meet these objectives, ICUI provides: * An ICU Interface Message Send Function, icuiEnq(), which provides an API by which other CSCs can send messages to the ICU.* An ICU Interface Command Reader ISR, icuiCmdReceiveISR(), which receives Telecommands from the ICU and forwards them to the Command and Control Task for processing.* An ICU Interface Housekeeping Function, icuiHkGet(), which gathers ICU Interface housekeeping data at the request of the Command and Control Task.",1
"  There DPU-DPA shall have three science modes, X, Y mode, and X/Y mode.","Event ProcessingIf the Mode command is Instrument Y Mode, the detector events are spatially filtered to the Instrument Y window specified in the Mode command then the corresponding pixel in the Ping or Pong buffer is incremented.  If specified in the Mode command, pixels will be binned at AxA or BxB.  Also, if specified in the Mode command, a tracking frame data product will be produced for every Ping/Pong tracking frame. Instrument Y and Event Mode may be commanded simultaneously in the Mode command. If the ICU sends an XRT Position command, the Instrument Y mode and Event Mode windows will be resized to match the new window sizes in the command.",1
"  There DPU-DPA shall have three science modes, X, Y mode, and X/Y mode.","Full-Frame (FF) Engineering ModeThe purpose of Full-Frame Engineering Mode is to monitor the health of the detector to locate hot spots and dead pixels. Detector events produced in Full Frame High Resolution detector format are received and histogrammed for a commanded integration time.  The entire Instrument Y is transmitted to the ground.  This mode can use high resolution (all pixels) or low resolution imaging (BxB , DxD pixel binning).",1
"  There DPU-DPA shall have three science modes, X, Y mode, and X/Y mode.","Instrument Y ProcessingThe Instrument Y Processor Task will perform tracking by breaking the exposure up into 10-second sub-exposures which are shifted and added into a final histogrammed Instrument Y.  Tracking is performed by choosing guide stars from the first 10-second Instrument Y of an exposure.  Then in each subsequent Instrument Y, these guide stars are found and the drift is determined by comparing the two Instrument Ys. The Instrument Y is then shifted by the determined drift and added to the previous Instrument Ys in the accumulation buffer.",1
"  There DPU-DPA shall have three science modes, X, Y mode, and X/Y mode.","Instrument Y ProcessingAt the end of an exposure, the Instrument Y in the accumulation buffer is transferred to the Instrument Y data product buffer one horizontal line at a time, starting at the top of the Instrument Y to form a PROD_INSTRUMENT Y data product.  This rasterized Instrument Y in the Instrument Y data product buffer will be enqueued for transmission to the spacecraft.",1
"  In image mode, the DPU-DPA shall calculate the memory location to increment for each valid detector event received.  The memory location shall be incremented for each valid event.  Each memory location shall be able to count so many events.  An Image mode exposure shall produce a PROD_IMAGE.",Raw Event List (RE) Engineering ModeThe purpose of Raw Event List Engineering Mode is to diagnose problems with the detector. Detector events produced in a given detector mode are collected over a commanded integration time and transmitted to the ground as a list of raw events.,1
The image mode shall shift successive frames according to the calculated spacecraft drift and co-add the frame into an accumulated image.,"Data Transfer to QueueDuring initialization, the TMALI CSC installs an ISR hook routine, tmaliTransferToQueueISR(),  into the DCI Driver which is invoked when:* the DCI interface reaches the programmed frame limit in the Ping-Pong buffer, or* the DCI interface detects a data receipt timeout.",1
"  Image mode shall have the ability to produce a Parameterized Finding Chart, PROD_FINDING_CHART, of the image if commanded, using the algorithm described in Appendix C.  The Parameterized Finding Chart shall consist of the brightest sources. Each source shall be parameterized by its position [X,Y] and Intensity/brightness.","Data Processing Algorithm CSCThe DPA CSC includes the following components:* Event Processor Task  communicates with the ICU, creates event list data products, creates Tracking Instrument Ys in the Ping/Pong buffers, creates the Finding Chart, performs the Engineering Modes, generates housekeeping data, creates the Event Frame, Ping and Pong buffers, and provides a task heartbeat to the CCM task.",1
"  Image mode shall have the ability to produce a Parameterized Finding Chart, PROD_FINDING_CHART, of the image if commanded, using the algorithm described in Appendix C.  The Parameterized Finding Chart shall consist of the brightest sources. Each source shall be parameterized by its position [X,Y] and Intensity/brightness.","Data Processing Algorithm CSCThe DPA CSC includes the following components:* Algorithms  o Choose Guide Stars scans the bright stars in the reference frame, chooses guide stars and sets up tracking windows around the guide stars.o Drift Correction calculates the drift offset and roll of a just-completed tracking frame relative to the reference frame. o Create Finding Chart will use the above Choose Guide Stars Algorithm to find the brightest stars in the finding chart Instrument Y then creates a list of the brightest stars and their intensities.o Derive Channel Boundaries calculates a set of channel boundaries (18 numbers - 9X, 9Y) which are used by the centroiding software in the Blue Processing Electronics (BPE) in the Telescope Module.",1
"  Image mode shall have the ability to produce a Parameterized Finding Chart, PROD_FINDING_CHART, of the image if commanded, using the algorithm described in Appendix C.  The Parameterized Finding Chart shall consist of the brightest sources. Each source shall be parameterized by its position [X,Y] and Intensity/brightness.",Event ProcessingThe Event Processor Task is also responsible for creating the Finding Chart.  The Create Finding Chart Algorithm will use the Choose Guide Stars Algorithm to find the brightest stars in the finding chart Instrument Y.  The parameterized finding chart will be created by listing the X & Y detector location of each star along with a CxC pixel matrix around the star location of the intensities. The Event Processor Task will create the necessary housekeeping for the DPA.,1
" The DPU-DPA shall produce a Parameterized Finding Chart, PROD_FINDING_CHART, that is so many bytes.","Data Processing Algorithm CSCThe DPA CSC includes the following components:* Algorithms  o Choose Guide Stars scans the bright stars in the reference frame, chooses guide stars and sets up tracking windows around the guide stars.o Drift Correction calculates the drift offset and roll of a just-completed tracking frame relative to the reference frame. o Create Finding Chart will use the above Choose Guide Stars Algorithm to find the brightest stars in the finding chart Instrument Y then creates a list of the brightest stars and their intensities.o Derive Channel Boundaries calculates a set of channel boundaries (18 numbers - 9X, 9Y) which are used by the centroiding software in the Blue Processing Electronics (BPE) in the Telescope Module.",1
"  When commanded to event mode by the ICU,  the DPU-DPA shall be capable of collecting time-tagged photon events and producing a PROD_EVENT.","Event ProcessingThe Event Processor Task, after receiving a Mode command from the ICU, configures the DPU DCI hardware, responds to the ICU with a Mode Ready message then receives detector events by calling functions tmaliWait() and tmaliNextEvent().  The Event Processor Task will collect detector events for the time period specified in the Mode command then issue a Mode Complete message to the ICU.  After issuing the Mode Complete message, the Event Processor Task will enter the Idle state.",1
  The DPU-DPA shall calculate drift with respect to the reference frame based on the established guide stars then perform a shift-and-add of the image mode data.,"Event ProcessingIf the Mode command is Instrument Y Mode, the detector events are spatially filtered to the Instrument Y window specified in the Mode command then the corresponding pixel in the Ping or Pong buffer is incremented.  If specified in the Mode command, pixels will be binned at AxA or BxB.  Also, if specified in the Mode command, a tracking frame data product will be produced for every Ping/Pong tracking frame. Instrument Y and Event Mode may be commanded simultaneously in the Mode command. If the ICU sends an XRT Position command, the Instrument Y mode and Event Mode windows will be resized to match the new window sizes in the command.",1
"  The DPU-RTOS shall be a real-time, multi-tasking operating system.","Development PlatformThe DPU FSW will be implemented in the ANSI C programming language, with some PowerPC assembly used in the Bootstrap and to implement the VME data transfer in the DCI Driver.  The host (development) platform and operating system is Sun/Solaris from Sun Microsystems, Inc.  The target platform is the RAD6000 processor which has a POWER (PowerPC-like) architecture, and executes the VxWorks 5.3.1 real-time operating system.  The cross compiler and debugger is MULTI/C/C++ 1.8.9 from Green Hills Software, Inc.",1
  The DPU-RTOS shall provide the capability to invoke user-installed Interrupt Service Routines (ISRs) in response to internal and external (VME) interrupts.,"types of external (VME) interruptsThe DPU has five types of external (VME) interrupts:* MIL-STD-1553 Interface Interrupts,* DCI Interface Interrupts,* SSI Interface Interrupts,* Memory EDAC Interrupt, and* Ethernet Interrupt (ground use only).",1
  The DPU-RTOS shall provide the capability to invoke user-installed Interrupt Service Routines (ISRs) in response to internal and external (VME) interrupts.,"interrupt service routine (ISR)The DPU responds to interrupts via an interrupt service routine (ISR).  VME interrupts are prioritized; however the DPU does not allow nested interrupts, and so any interrupts which occur while servicing another interrupt will pend until the current ISR has returned.",1
  The DPU-RTOS shall provide the capability to invoke user-installed Interrupt Service Routines (ISRs) in response to internal and external (VME) interrupts.,Generic VME Driver CSCThe Generic VME (GVME) Driver CSC is a Level 1 reuse component from the INSTRUMENT Y project.  The GVME Driver provides a set of convenience routines which are useful when accessing registers and memory in the VME memory space.,1
" At startup, the DPU-RTOS shall execute the BIT device RAM tests (cold boot only), install device drivers, execute the BIT driver loopback tests (cold boot only), and then spawn the application flight software.","External Program InterfacesPerforms the SCM EDAC test, PROM checksum test, and device loopback tests for those devices which support it.",1
  The DPU-RTOS shall include the capability to dynamically load object modules from the EEPROM.," Startup Sequence On flight, a power cycle can only be effected by the SCU.  A watchdog reset could be induced by the DPU FSW due to a detected, unrecoverable error, or it could occur as a by-product of the FSW entering a state in which it fails to strobe the watchdog timer.  On boot, the bootstrap tests and clears DRAM, and then proceeds to load the DPU FSW from EEPROM and executes it.  The DPU FSW then loads configuration information from EEPROM (which establishes various operational defaults) and spawns the various DPU FSW tasks. ",1
  The DPU-RTOS shall provide a function to allow an application program to write to the Real-Time Clock registers on the RAD6000SC CPU Module.,"Time SynchronizationThe time contained in the Clock Message is specified to be valid on the rising edge of the next 1PPS signal.  When the DPU receives the Clock Message, the 1553 ISR calls the tisTimeSync() function, forwarding the data portion of the clock message to the TIS CSC via the TIS_CLK_MSG data structure..  The tisTimeSync() function will immediately copy the spacecraft clock value to the DPU clock hardware registers. The DPU hardware is designed to latch in the new time on the rising edge of the next 1 PPS signal (the act of writing a new time to the hardware registers arms the latch function in the hardware).  Once the new time is latched, the hardware automatically disables the time latch function to avoid the potential of latching in an old time at the next 1 PPS signal.will be received within one second.  In the unlikely event a UT Delta is discarded, an event message is enqueued to ccmErrEnq() for informational purposes.",1
  The DPU-RTOS shall provide a function to allow an application program to write to the Real-Time Clock registers on the RAD6000SC CPU Module.,"Public FunctionsThis routine extracts the current spacecraft time from the clock message and writes in to the hardware clock registers to be latched by the hardware at the next 1PPS signal, and maintains a copy of the UT Delta provided in the clock message.  If the UT Delta is currently being copied by an application, the UT Delta from the current message is discarded and an event is enqueued to ccmErrEnq().  If automatic time synchronization is disabled, this routine returns with no action taken. THIS ROUTINE IS INVOKED AT INTERRUPT CONTEXT.",1
  The DPU-RTOS shall provide a function to allow an application program to write to the Real-Time Clock registers on the RAD6000SC CPU Module.,Real-Time Clock InterfaceThe Real-Time Clock (RTC) Registers of the RAD6000 are special-purpose registers not normally accessible to C language programs.  Some assembler wrapper functions provide access to these.  ,1
  The DPU-RTOS shall provide a function to allow an application program to write to the Real-Time Clock registers on the RAD6000SC CPU Module.,Real-Time Clock InterfaceThis routine gets the value of the Real-Time Clock (RTC) Registers and places the results in variables rtcu and rtcl.,1
  The DPU-RTOS shall provide a function to allow an application program to write to the Real-Time Clock registers on the RAD6000SC CPU Module.,Real-Time Clock InterfaceThis routine sets the value of the RTC Registers,1
  The DPU-RTOS shall provide a function to allow an application program to read from the Real-Time Clock registers on the RAD6000SC CPU Module.,"Structural DesignThe TIS CSC provides a library of functions to* initialize the DPU clock hardware at startup,* maintain synchronization of the DPU clock with the Spacecraft clock,* provide a function for use by other applications to retrieve the current values of the DPU clock and the UT Delta, and provide functions for use by the CCM command dispatcher to alter the configuration of the clock interface.",1
  The DPU-RTOS shall provide a function to allow an application program to read from the Real-Time Clock registers on the RAD6000SC CPU Module.,"Time RetrievalThe DPU maintains a local copy of the spacecraft clock and current UT Delta in order that the DPU FSW can timestamp data products and packets.  The TIS CSC provides a function, tisTimeGet(), which retrieves a copy of both the current DPU clock value and the most recent UT Delta value.  Time is communicated among DPU FSW applications via the TIS_TIME data structure.",1
  The DPU-RTOS shall provide a function to allow an application program to read from the Real-Time Clock registers on the RAD6000SC CPU Module.,Real-Time Clock InterfaceThe Real-Time Clock (RTC) Registers of the RAD6000 are special-purpose registers not normally accessible to C language programs.  Some assembler wrapper functions provide access to these.  ,1
  The DPU-RTOS shall provide a function to allow an application program to read from the Real-Time Clock registers on the RAD6000SC CPU Module.,Real-Time Clock InterfaceThis routine gets the value of the Real-Time Clock (RTC) Registers and places the results in variables rtcu and rtcl.,1
"  The DPU-RTOS shall exclude failed DRAM from the system memory pool based on the contents of the BIT_DRAM results in the SYSTEM_BLOCK.  The system memory table does not include the Interrupt Vector Table (IVT), nor the text and data segment.","Exclude Failed DRAMThe Bootstrap performs a memory test before loading the operating system.  The results of this test are stored in the EEPROM.  The DPU-RTOS uses the results of the memory test to exclude memory segments with bit errors from the system memory pool. The Bootstrap constructs a bit map which effectively implements a list of failed memory blocks during the bootstrap built-in test.  A set of functions have been created to utilize this  bit map to exclude failed memory blocks from the VxWorks system memory pool.  The system memory pool is used by VxWorks to allocate memory dynamically.  In addition, a linked list of good memory segments is created for use by the EDAC Memory Scrubber.  These functions are called from the usrInit() and usrRoot() functions in usrConfig.c.  The dramInit() function must be called prior to kernelInit() in usrInit().  The dramBuildMemPool() function is called just prior to initialization of filesystems and drivers in usrRoot().",1
"  The DPU-RTOS shall exclude failed DRAM from the system memory pool based on the contents of the BIT_DRAM results in the SYSTEM_BLOCK.  The system memory table does not include the Interrupt Vector Table (IVT), nor the text and data segment.",External Program InterfacesReads the BIT results from the location pointed to by pBitResults (which is assumed to be in EEPROM) into the BIT results data structure in DRAM.,1
  The DPU-RTOS shall install an hook routine which is invoked on system exception which shall attempt to record the interrupt vector to the LAST_BOOT_IVEC location in EEPROM prior to reboot.,Install Exception Handlersa default interrupt handler and is installed into element five (5) of the system interrupt table.,1
  The DPU-RTOS shall install an hook routine which is invoked on system exception which shall attempt to record the interrupt vector to the LAST_BOOT_IVEC location in EEPROM prior to reboot.,Install Exception HandlersThis routine installs a hook routine for the Memory Error Interrupt.  The hook routine will be called from the interrupt context.  This function returns OK always.,1
  The DPU-RTOS shall install an hook routine which is invoked on system exception which shall attempt to record the interrupt vector to the LAST_BOOT_IVEC location in EEPROM prior to reboot.,"Install Exception Handlers The RSC processor also generates an external interrupt for the Power Fail Interrupt.  The RSCVME Board Support Package of VxWorks? does not directly support access to this interrupt.  Some custom routines must be provided to access this interrupt. These functions are described below, and are contained in sysLibSup.c.",1
  The DPU-RTOS shall install an hook routine which is invoked on system exception which shall attempt to record the interrupt vector to the LAST_BOOT_IVEC location in EEPROM prior to reboot.,Install Exception HandlersThis routine is a default interrupt handler and is installed into element six (6) of the system interrupt table.,1
  The DPU-RTOS shall install an hook routine which is invoked on system exception which shall attempt to record the interrupt vector to the LAST_BOOT_IVEC location in EEPROM prior to reboot.,Install Exception HandlersThis routine installs a hook routine for the Power Failure Interrupt.  The hook routine will be called from the interrupt context.  This function returns OK always.,1
  The DPU-RTOS shall install an hook routine which is invoked on system exception which shall attempt to record the interrupt vector to the LAST_BOOT_IVEC location in EEPROM prior to reboot.,"Install Exception Handlers Certain conditions can cause the VxWorks? exception handler to reboot the DPU.  These conditions include a Data Storage Interrupt from within an interrupt context, a Multiple-Bit Error (MBE), and a deferred-work queue overrun.  Under these circumstances, interrupting devices on the Company X Communication/Memory Module must be stopped prior to jumping back to the Bootstrap.  This can be done by installing a hook routine to perform the cleanup in sysHwInit() using the function rebootHookAdd().  However, to avoid the need to cleanup interrupts, an exception handler is installed which forces a watchdog reset, which will effectively clean up the pending interrupt problem.  The exception hook saves the contents of the Exception Stack Frame to EEPROM and waits for a watchdog timeout.  The following call is added to the usrRoot() function in usrConfig.c:",1
  The DPU-BIT shall perform two write/read/compare tests on the RAM for the MIL-STD-1553B.  The first test shall construct and write half-word (16-bit) values obtained by adding the upper and lower half-words of each each memory address.  The second test shall construct and write the ones complement of the half-word values used in the first test.,"DRAM BITPart of the memory is tested in Boot Sequence 1, and part of the memory is tested during Boot Sequence 2.  During Boot Sequence 1, ? KB of DRAM is tested before the Bootstrap is copied to this area.  During Boot Sequence 2, the  remaining memory is tested in ? KB blocks. The DRAM BIT first writes the address of each word in a block to that word in the block.   Then the test flushes the cache and reads back the entire block.  If a single-bit error occurs on the read-back, the location is read again.  If another single-bit error occurs, the test assumes a hard error and marks the whole block bad.  If a multiple-bit error occurs, the whole block is marked bad.  If the value read back does not match the address, the whole block is marked bad.  This same process is repeated with the ones complement of the address. The Bootstrap stores the results of the DRAM BIT in EEPROM as a series of x consecutive y-bit words.  Each bit in a result word represents the result of testing a ? KB block of DRAM.  These bits are mapped to DRAM by proceeding from least-significant bit (LSb) to most-significant bit (MSb) as the addresses of the memory blocks increase.  A set bit indicates that a block of DRAM has failed.  A clear bit indicates that a block of DRAM has passed the test.",1
  The DPU-BIT shall perform two write/read/compare tests on the RAM for the MIL-STD-1553B.  The first test shall construct and write half-word (16-bit) values obtained by adding the upper and lower half-words of each each memory address.  The second test shall construct and write the ones complement of the half-word values used in the first test.,"Built-In Test CSCThe Built-In Test (BIT) CSC is a Level 2 reuse component from the SSFF and INSTRUMENT Y projects.  The detailed design of the BIT CSC follows. The Built-In Tests CSC, identified DPU-BIT, performs the Stage 2 Built-In Tests (BIT).  The Stage 2 BIT includes a test of the SCM EDAC circuit, a checksum test on SCM PROM, a MIL-STD-1553B internal BIT, and a memory test of the DCI Data Buffers. The results of the BIT are recorded in the SYS_CNFG_AREA in EEPROM and are also maintained in DRAM.  If an error occurs in one of the functions performing the BIT, the test result will be reported as a failure in the test itself.",1
  The DPU-BIT shall perform MIL-STD-1553B internal BIT.,"Built-In Test CSCThe Built-In Test (BIT) CSC is a Level 2 reuse component from the SSFF and INSTRUMENT Y projects.  The detailed design of the BIT CSC follows. The Built-In Tests CSC, identified DPU-BIT, performs the Stage 2 Built-In Tests (BIT).  The Stage 2 BIT includes a test of the SCM EDAC circuit, a checksum test on SCM PROM, a MIL-STD-1553B internal BIT, and a memory test of the DCI Data Buffers. The results of the BIT are recorded in the SYS_CNFG_AREA in EEPROM and are also maintained in DRAM.  If an error occurs in one of the functions performing the BIT, the test result will be reported as a failure in the test itself.",1
  The DPU-BIT shall test the Error Detection and Correction (EDAC) on the Company X Communication/Memory Module by reading preprogrammed error locations in PROM.,"DRAM BITPart of the memory is tested in Boot Sequence 1, and part of the memory is tested during Boot Sequence 2.  During Boot Sequence 1, ? KB of DRAM is tested before the Bootstrap is copied to this area.  During Boot Sequence 2, the  remaining memory is tested in ? KB blocks. The DRAM BIT first writes the address of each word in a block to that word in the block.   Then the test flushes the cache and reads back the entire block.  If a single-bit error occurs on the read-back, the location is read again.  If another single-bit error occurs, the test assumes a hard error and marks the whole block bad.  If a multiple-bit error occurs, the whole block is marked bad.  If the value read back does not match the address, the whole block is marked bad.  This same process is repeated with the ones complement of the address. The Bootstrap stores the results of the DRAM BIT in EEPROM as a series of x consecutive y-bit words.  Each bit in a result word represents the result of testing a ? KB block of DRAM.  These bits are mapped to DRAM by proceeding from least-significant bit (LSb) to most-significant bit (MSb) as the addresses of the memory blocks increase.  A set bit indicates that a block of DRAM has failed.  A clear bit indicates that a block of DRAM has passed the test.",1
  The DPU-BIT shall perform two write/read/compare tests on the RAM for the DCI Data Buffers.  The first test shall write the address of each location to that location.  The second test shall write the ones complement of the values used in the first test.,"Built-In TestThere are two stages of Built-In Tests (BIT) for the DPU.  The Stage 1 BIT is included in the Bootstrap program and consists of Central Processing Unit (CPU) BIT, and Dynamic Random Access Memory (DRAM) BIT.  The Stage 2 BIT is executed after the operating system is booted and is not part of the Bootstrap program.",1
  The DPU-BIT shall perform two write/read/compare tests on the RAM for the DCI Data Buffers.  The first test shall write the address of each location to that location.  The second test shall write the ones complement of the values used in the first test.,"DRAM BITPart of the memory is tested in Boot Sequence 1, and part of the memory is tested during Boot Sequence 2.  During Boot Sequence 1, ? KB of DRAM is tested before the Bootstrap is copied to this area.  During Boot Sequence 2, the  remaining memory is tested in ? KB blocks. The DRAM BIT first writes the address of each word in a block to that word in the block.   Then the test flushes the cache and reads back the entire block.  If a single-bit error occurs on the read-back, the location is read again.  If another single-bit error occurs, the test assumes a hard error and marks the whole block bad.  If a multiple-bit error occurs, the whole block is marked bad.  If the value read back does not match the address, the whole block is marked bad.  This same process is repeated with the ones complement of the address. The Bootstrap stores the results of the DRAM BIT in EEPROM as a series of x consecutive y-bit words.  Each bit in a result word represents the result of testing a ? KB block of DRAM.  These bits are mapped to DRAM by proceeding from least-significant bit (LSb) to most-significant bit (MSb) as the addresses of the memory blocks increase.  A set bit indicates that a block of DRAM has failed.  A clear bit indicates that a block of DRAM has passed the test.",1
  The DPU-BIT shall report errors that occur during tests as failures in the test results.,"DRAM BITPart of the memory is tested in Boot Sequence 1, and part of the memory is tested during Boot Sequence 2.  During Boot Sequence 1, ? KB of DRAM is tested before the Bootstrap is copied to this area.  During Boot Sequence 2, the  remaining memory is tested in ? KB blocks. The DRAM BIT first writes the address of each word in a block to that word in the block.   Then the test flushes the cache and reads back the entire block.  If a single-bit error occurs on the read-back, the location is read again.  If another single-bit error occurs, the test assumes a hard error and marks the whole block bad.  If a multiple-bit error occurs, the whole block is marked bad.  If the value read back does not match the address, the whole block is marked bad.  This same process is repeated with the ones complement of the address. The Bootstrap stores the results of the DRAM BIT in EEPROM as a series of x consecutive y-bit words.  Each bit in a result word represents the result of testing a ? KB block of DRAM.  These bits are mapped to DRAM by proceeding from least-significant bit (LSb) to most-significant bit (MSb) as the addresses of the memory blocks increase.  A set bit indicates that a block of DRAM has failed.  A clear bit indicates that a block of DRAM has passed the test.",1
  The DPU-BIT shall use the 1553 Driver CSC to perform MIL-STD-1553B internal BIT.,"Built-In Test CSCThe Built-In Test (BIT) CSC is a Level 2 reuse component from the SSFF and INSTRUMENT Y projects.  The detailed design of the BIT CSC follows. The Built-In Tests CSC, identified DPU-BIT, performs the Stage 2 Built-In Tests (BIT).  The Stage 2 BIT includes a test of the SCM EDAC circuit, a checksum test on SCM PROM, a MIL-STD-1553B internal BIT, and a memory test of the DCI Data Buffers. The results of the BIT are recorded in the SYS_CNFG_AREA in EEPROM and are also maintained in DRAM.  If an error occurs in one of the functions performing the BIT, the test result will be reported as a failure in the test itself.",1
  The DPU-EDAC shall contain a background task which walks DRAM to trip single-bit errors (SBEs).,"DRAM BITPart of the memory is tested in Boot Sequence 1, and part of the memory is tested during Boot Sequence 2.  During Boot Sequence 1, ? KB of DRAM is tested before the Bootstrap is copied to this area.  During Boot Sequence 2, the  remaining memory is tested in ? KB blocks. The DRAM BIT first writes the address of each word in a block to that word in the block.   Then the test flushes the cache and reads back the entire block.  If a single-bit error occurs on the read-back, the location is read again.  If another single-bit error occurs, the test assumes a hard error and marks the whole block bad.  If a multiple-bit error occurs, the whole block is marked bad.  If the value read back does not match the address, the whole block is marked bad.  This same process is repeated with the ones complement of the address. The Bootstrap stores the results of the DRAM BIT in EEPROM as a series of x consecutive y-bit words.  Each bit in a result word represents the result of testing a ? KB block of DRAM.  These bits are mapped to DRAM by proceeding from least-significant bit (LSb) to most-significant bit (MSb) as the addresses of the memory blocks increase.  A set bit indicates that a block of DRAM has failed.  A clear bit indicates that a block of DRAM has passed the test.",1
  The DPU-EDAC shall record the number of MBEs that have been detected in DRAM since boot and the address of the last two MBEs.,"DRAM BITPart of the memory is tested in Boot Sequence 1, and part of the memory is tested during Boot Sequence 2.  During Boot Sequence 1, ? KB of DRAM is tested before the Bootstrap is copied to this area.  During Boot Sequence 2, the  remaining memory is tested in ? KB blocks. The DRAM BIT first writes the address of each word in a block to that word in the block.   Then the test flushes the cache and reads back the entire block.  If a single-bit error occurs on the read-back, the location is read again.  If another single-bit error occurs, the test assumes a hard error and marks the whole block bad.  If a multiple-bit error occurs, the whole block is marked bad.  If the value read back does not match the address, the whole block is marked bad.  This same process is repeated with the ones complement of the address. The Bootstrap stores the results of the DRAM BIT in EEPROM as a series of x consecutive y-bit words.  Each bit in a result word represents the result of testing a ? KB block of DRAM.  These bits are mapped to DRAM by proceeding from least-significant bit (LSb) to most-significant bit (MSb) as the addresses of the memory blocks increase.  A set bit indicates that a block of DRAM has failed.  A clear bit indicates that a block of DRAM has passed the test.",1
  The DPU-ADC shall create a fixed analog conversion scan list containing the A DPU analog values (active values plus one ground reference value).,"Analog to Digital Converter Driver CSCThe Analog to Digital Converter (ADC) Driver CSC is a new driver which controls and retrieves data from the ADC hardware.  The key elements of the ADC driver include:* A list (array of ADC_LIST_ENTRY) which maintains the setup information and current value (ADC_VALUE) for each of the 24 ADC values. * An API function, adcUpdateNext(), which causes a single ADC_VALUE to be updated every other call to the driver.  A value is updated every other call since each value requires a multiplexer settle time as well as an ADC conversion time.  In order to keep the driver simple, the responsibility for implementing the correct settle time and conversion time rests with the application.* An API function, adcGet(), which returns a copy of the current list of ADC_VALUEs.",1
  The DPU-ADC shall create a fixed analog conversion scan list containing the A DPU analog values (active values plus one ground reference value).,"InitializationThe driver is initialized by invoking the initialization function adcInit().  The function initializes the ADC_LIST_ENTRY array, sets up convenience pointers to the ADC hardware registers, and sets up the ADC multiplexer for the first conversion (otherwise the very first ADC value requires three calls to adcUpdateNext()).  The ADC Driver can be re-initialized, which will result in the values in the ADC_LIST_ENTRY array being reset to their default values.The ADC_VALUEs are A-bit data items; however the hardware contains a B-bit A/D.  The upper bits are used to indicate invalid or suspect values as follows:* At initialization, the MSbit of each of the ADC_VALUEs is set (0x8000).* If a conversion fails (i.e. the driver reads the analog value and determines that the conversion has not yet completed), the second MSbit.",1
  The DPU-ADC shall create a fixed analog conversion scan list containing the A DPU analog values (active values plus one ground reference value).,"Performing Analog-to-Digital ConversionsThe ADC Driver maintains an array of ADC_LIST_ENTRY data structures which contain the hardware multiplexer setup information for each of the x analog inputs, and the current value (ADC_VALUE) of each analog input.  To update a single value in the list, an application must call the update function adcUpdateNext().  The ADC hardware only has a single A/D channel, and so to perform an A/D conversion the hardware requires a multiplexer setup and corresponding settle time, as well as the normal A/D conversion time.  Therefore, it takes two calls to adcUpdateNext() to update a single value in the list.  To keep the driver simple and to avoid embedding hard waits in the driver, the application is required to implement the setup and conversion time by spacing successive calls to the adcUpdateNext() function appropriately.",1
  The DPU-ADC shall read from the SCM registers in B-bit words only.,"InitializationThe driver is initialized by invoking the initialization function adcInit().  The function initializes the ADC_LIST_ENTRY array, sets up convenience pointers to the ADC hardware registers, and sets up the ADC multiplexer for the first conversion (otherwise the very first ADC value requires three calls to adcUpdateNext()).  The ADC Driver can be re-initialized, which will result in the values in the ADC_LIST_ENTRY array being reset to their default values.The ADC_VALUEs are A-bit data items; however the hardware contains a B-bit A/D.  The upper bits are used to indicate invalid or suspect values as follows:* At initialization, the MSbit of each of the ADC_VALUEs is set (0x8000).* If a conversion fails (i.e. the driver reads the analog value and determines that the conversion has not yet completed), the second MSbit.",1
  The DPU-ADC shall write to the SCM registers in B-bit words only.,"InitializationThe driver is initialized by invoking the initialization function adcInit().  The function initializes the ADC_LIST_ENTRY array, sets up convenience pointers to the ADC hardware registers, and sets up the ADC multiplexer for the first conversion (otherwise the very first ADC value requires three calls to adcUpdateNext()).  The ADC Driver can be re-initialized, which will result in the values in the ADC_LIST_ENTRY array being reset to their default values.The ADC_VALUEs are A-bit data items; however the hardware contains a B-bit A/D.  The upper bits are used to indicate invalid or suspect values as follows:* At initialization, the MSbit of each of the ADC_VALUEs is set (0x8000).* If a conversion fails (i.e. the driver reads the analog value and determines that the conversion has not yet completed), the second MSbit.",1
  The DPU-SSI shall provide the capability for an application program to set the Inter-Block Gap (IBG) Timeout for transmitted and received messages.,"Transmit Message Mode(FIOSSIBGTXMSGENABLE) and Inter-Block Gap interruptsThe SSI Driver CSC supports a message mode to facilitate application level communication.  This mode uses the Inter-Block Gap interrupt generated by the hardware to synchronize message transmission. When in a messaging mode, the driver enables an internal Byte Count queue provides a synchronization mechanism for sending messages.  This Byte Count queue is updated with the message size as Inter-Block Gap interrupts are received. The Transmit Message Mode uses the BGTX interrupt, the Tx FIFO Empty Interrupt, the write() call, and an internal Byte Count queue to synchronize the transmission of messages over SSI.  In this mode, the maxBytes parameter passed to write() is enqueued to the Byte Count queue.  When a period of time equal to or greater than the Interblock Gap time has expired, the BGTX interrupt will be asserted.  At this time, the driver will respond and initiate a new transfer by setting a Byte Transfer Limit for this block and enabling the Tx FIFO Empty Interrupt.  The Byte Transfer Limit corresponds to the entry on the Byte Count queue.  When all bytes in the current block have been sent up to the Byte Transfer Limit, the Tx FIFO ISR will disable itself and reset the Byte Transfer Limit to zero. An application may use this mode by calling write() with a buffer pointer and maxBytes in order to transfer a message of a particular length.",1
  The DPU-SSI shall provide the capability for an application program to install a callback routine to respond to the receive IBG Interrupt.,"Public FunctionsThis routine initializes the interface to the ICU.  This routine opens SSI Driver port, installs the SSI interface interrupt callbacks, and enables Transmit Message Mode in the SSI Driver.",1
  The DPU-SSI shall provide the capability for an application program to install a callback routine to respond to the transmit IBG Interrupt.,"Transmit Message Mode(FIOSSIBGTXMSGENABLE) and Inter-Block Gap interruptsThe SSI Driver CSC supports a message mode to facilitate application level communication.  This mode uses the Inter-Block Gap interrupt generated by the hardware to synchronize message transmission. When in a messaging mode, the driver enables an internal Byte Count queue provides a synchronization mechanism for sending messages.  This Byte Count queue is updated with the message size as Inter-Block Gap interrupts are received. The Transmit Message Mode uses the BGTX interrupt, the Tx FIFO Empty Interrupt, the write() call, and an internal Byte Count queue to synchronize the transmission of messages over SSI.  In this mode, the maxBytes parameter passed to write() is enqueued to the Byte Count queue.  When a period of time equal to or greater than the Interblock Gap time has expired, the BGTX interrupt will be asserted.  At this time, the driver will respond and initiate a new transfer by setting a Byte Transfer Limit for this block and enabling the Tx FIFO Empty Interrupt.  The Byte Transfer Limit corresponds to the entry on the Byte Count queue.  When all bytes in the current block have been sent up to the Byte Transfer Limit, the Tx FIFO ISR will disable itself and reset the Byte Transfer Limit to zero. An application may use this mode by calling write() with a buffer pointer and maxBytes in order to transfer a message of a particular length.",1
  The DPU-SSI shall provide the capability for an application program to enable/disable the VME Slave Interrupt on the SCM for the SSI Interface.,"Unmask VME Interrupts and Disallow Nested InterruptsThe device drivers do not automatically unmask VME interrupts at the processor.  This must be done separately since some VME interrupts may share an IRQ level. Finally, nested interrupt capability should be disabled since allowing for nested interrupts was not considered in the design of this FSW.  This is done by verifying that SYS_INT_MASK_0 and SYS_INT_MASK_1 are both defined to 0xffffffff in config.h.",1
  The DPU-SSI shall provide the capability for an application to determine the number of bytes in a message received from the ICU.,"Public FunctionsThis routine is used to format messages for transmission to the ICU and to place those messages on the SSI Driver Transmitter Queue. The functionCode parameter is used to create the CCSDS Packet APID and the Message Identifier (refer to document DPUICD-01).  A mutual exclusion semaphore, icuiSemWrite, protects the SSI Driver from being written by multiple tasks simultaneously.  The timeout parameter lets the caller control how long it is willing to block on this semaphore if there is an access conflict.This routine may be called at interrupt context to transmit an ACK/NAK message.  In that case, the semaphore is not taken since it is not valid to take a semaphore at interrupt context.  Refer to discussion of the design to accommodate the ACK/NAK message.",1
  The DPU-SSI shall provide the capability for an application to determine the number of bytes in a message received from the ICU.,"Public FunctionsThis routine initializes the interface to the ICU.  This routine opens SSI Driver port, installs the SSI interface interrupt callbacks, and enables Transmit Message Mode in the SSI Driver.",1
  The DPU-SSI shall read from the SSI registers in 16-bit words only.,Hardware InterfacesThe SSI Driver CSC accesses each of the registers on the Company X Communications module using D16 VME access.,1
  The DPU-SSI shall write to the SSI registers in 16-bit words only.,Hardware InterfacesThe SSI Driver CSC accesses each of the registers on the Company X Communications module using D16 VME access.,1
  The DPU-DCI shall provide an application program with the ability to read and write the hardware ping-pong buffers when in Test Mode.,"Standard I/O InterfaceThe write primitive does not block.  The buffer passed to write is written directly to the active portion of the ping pong buffer by the driver.  This primitive is valid only in TEST mode.  The write call will set errno to S_dci_MODE_ERROR and return ERROR if the driver is in NORMAL mode.  In TEST mode, the driver returns the number of bytes written.",1
"  The DPU-DCI shall provide the capability for an application program to set a timeout in milliseconds that specifies a period during which no new events have been received by the hardware, after which the hardware will swap ping-pong buffers and interrupt the software.",Normal Data Exchange SequenceThe TMALI CSC serves as an intermediate manager of EVENT data supplied by the DCI Driver CSC and eventually delivered to the DPA CSC.  The TMALI CSC waits for notification from the DCI CSC that a frame limit (or data timeout) has been reached in the Ping-Pong buffer indicating the EVENT data is ready to be served to TMALI.   TMALI reads all EVENT data from the DCI and notifies the DCI that it can swap Ping-Pong buffers when ready.   TMALI gives a semaphore to unblock the tmaliWait() call from the DPA.,1
"  The DPU-DCI shall provide the capability for an application program to set a timeout in milliseconds that specifies a period during which no new events have been received by the hardware, after which the hardware will swap ping-pong buffers and interrupt the software.","Setting Data Timeout in DCIDuring nominal operation, frames arrive approximately every 11 msecs.  The DCI hardware will generate an interrupt if event data has been received in one of the Ping-Pong buffers, and a configurable amount of time has passed during which no additional events have been received.  A data timeout interrupt is not an error, but rather typically indicates that the current exposure has been completed.  The data timeout interrupt allows the TMALI CSC to retrieve the trailing events from the DCI Ping-Pong buffer.  The function tmaliDciTimeoutSet() provides an API to the DCI Driver to allow the timeout setting to be altered.",1
"  The DPU-DCI shall provide the capability for an application program to set a timeout in milliseconds that specifies a period during which no new events have been received by the hardware, after which the hardware will swap ping-pong buffers and interrupt the software.","Public FunctionsThis routine provides a means to set the data timeout used by the DCI, the value requested indicates the timeout in milliseconds.  The initial value for the frame depth setting is determined by the parameter provided when starting the tmaliTask.  The maximum value to which the timeout can be commanded is X seconds, an attempt to set the timeout to a number larger than this maximum will result in setting the timeout to the default value of X milliseconds",1
  The DPU-DCI shall provide an application program with the capability to command the DCI hardware to reorder the bit sequence of each event's original Detector Electronics Output Format as it is received.,Setting DCI Bit ArrangementThe bit arrangement of the DCI control/status register can be set via tmaliBitArrangementSet().,1
  The DPU-DCI shall provide an application program with the capability to command the DCI hardware to reorder the bit sequence of each event's original Detector Electronics Output Format as it is received.,"Public FunctionsThis routine provides a means to set the bit arrangement used by the DCI.  When bSpecialArrangement is TRUE, the DCI is set to special bit arrangement mode, otherwise the default mode of no rearrangement is set.",1
 The DPU-DCI shall provide an application program with the ability to toggle the hardware interface between Normal mode and Test mode.,Data Capture Interface Driver CSCThe Data Capture Interface (DCI) Driver CSC is a new driver which provides a standard VxWorks driver interface to the DCI hardware.  The driver features two modes: a test mode and a normal mode.,1
  The DPU-DCI shall provide the capability for an application program to receive data at a rate of A bytes per second over the DCI interface.,"Telescope Module Access Library and Interface CSCThe TMALI CSC includes the following components:* A queue, TMALI_EVENT_QUEUE, implemented using a ring buffer, which contains the detector events which have been received over the data capture interface from the DCI Driver, but which have not yet been retrieved by the DPA CSC;* An API which facilitates the retrieval of detector events from the queue by the DPA CSC.  The API consists of the tmaliNextEvent() and tmaliWait() functions.* An set of API functions used by the DPA CSC to configure the DCI interface, including tmaliBitArrangementSet(), tmaliDciFrameDepthGet(), tmaliDciFrameDepthSet(), tmaliDciWindowSet(), tmaliDataTimeoutSet(), and tmaliDataTimeoutGet().* An API housekeeping function, tmaliHkGet(), which gathers  CSC housekeeping data at the request of the Command and Control Task.* The task tmaliTask() and an ISR tmaliTransferToQueueISR() work together via a semaphore to synchronize the transfer of data from the DCI to the  queueAn error handling ISR, tmaliDciErrorReportedISR(), is installed as a hook routine to the DCI Driver, and is used to keep track of the number of errors reported by the DCI driver.",1
  The DPU-DCI shall provide the capability for an application program to receive data at a rate of A bytes per second over the DCI interface.,"Setting Frame Depth in DCIThe optimum frame depth will be determined with benchmark testing.  The default frame depth is 10 frames.  Given the above data, it will take approximately 24 msec to read 10 maximum-sized frames at the maximum data transfer rate.",1
  The DPU-DCI shall provide the capability for an application program to install a callback routine to respond to the DCI Error Interrupt (INTERR_EN).,"Public FunctionsThis routine initializes the interface to the ICU.  This routine opens SSI Driver port, installs the SSI interface interrupt callbacks, and enables Transmit Message Mode in the SSI Driver.",1
  The DPU-DCI shall report errors to an application program by setting the ERRNO task variable and returning ERROR.,"Error Collection and ReportingThe DPU-CCM CSC provides a centralized error reporting interface, ccmErrEnq(), that other FSW tasks use to report errors.  Each time it wakes, ccmTask() checks to see if it is time to form an error/event packet for transmission to the ground.  If so, ccmTask() calls ccmHkMkError() to actually create the packet and forward it to DPU-SCUI for transmission to the ground.",1
  The DPU-DCI shall report errors to an application program by setting the ERRNO task variable and returning ERROR.,"Public FunctionsThis routine is called by any CSC in order to report an error or event that should be included in DPU housekeeping.  If this routine is called from interrupt context a static global variable, ccmISRError, is set so that the error can be enqueued later (see ccmCtrlTask()).  This is done since the error/event queue is semaphore-protected and a semaphore cannot be taken in an ISR.  The error queue semaphore has priority inversion set to reduce conflicts between multiple callers should a priority inversion situation arise. This routine also replaces frequently occuring errors with a special repeat error code.  The repeat error code is a special error code that follows a normally reported error code to indicate that the normally reported error code previously reported has occurred more than once in the last high rate reporting period",1
  The DPU-DCI shall report errors to an application program by setting the ERRNO task variable and returning ERROR.,"Public FunctionsThis routine returns OK, or ERROR and sets errno if the passed parameter is NULL.  The following error codes may be returned in errno ",1
  The DPU-DCI shall report errors to an application program by setting the ERRNO task variable and returning ERROR.,Standard I/O InterfaceThe ioctl() entry point controls all interface configuration.  Different commands may be available depending on whether the driver is in NORMAL or TEST mode.  Any other value of the command parameter causes errno to be set to S_dci_IOCTL_UNDEF and ERROR to be returned.,1
"  The DPU-DCI shall read from the DCI Memory in B-bit words only, using the load multiple/store multiple instructions.","Ring buffer data structureThe  CSC maintains a FIFO implemented as a ring buffer to temporarily store the data received from the DCI before it is processed. The ring buffer uses two pointers called pIn and pOut to keep track of the data in the buffer. The pointers were defined such that reading from the buffer is the simplest operation and only a single compare is needed to verify if the buffer is empty. The buffer only stores Events so the pointers point to these four byte entities. As the DCI specifies all data in bytes, sizes have to be converted before reading data.",1
"  The DPU-DCI shall read from the DCI Memory in B-bit words only, using the load multiple/store multiple instructions.","Public FunctionsThis task initializes the TMALI CSC and then continues to read data from the DCI and store it in the TMALI buffer each time the DCI driver signals that data is available in the Ping-Pong buffer.  The availability of data in the DCI Ping-Pong buffer is signaled to the tmaliTask using a semaphore.  Unless a fatal error is detected during initialization this task will never terminate.The specified 3 parameters specify the size of the TMALI queue and the initial parameters for the DCI, if the specified values are outside the allowed range default values will be used.The specified QueueSize is the allocated buffersize (in 4 byte EVENTS), the ring buffer is full when QueueSize-1 EVENTS are stored in the buffer.",1
"  The DPU-DCI shall read from the DCI Memory in B-bit words only, using the load multiple/store multiple instructions.","Standard I/O InterfaceThe read() primitive does not block.  The read() primitive is implemented by simply passing its parameters to the tyLib function tyRead().The size of the Rx ring buffer is specified in the call to ssiDevCreate() as part of the device instantiation.This routine returns either the number of bytes read, or ERROR.",1
"  The DPU-DCI shall read from the DCI Memory in B-bit words only, using the load multiple/store multiple instructions.","Standard I/O InterfaceThe read() primitive does not block.  A read is performed on the active portion of the H/W ping pong buffer using the RAD 6000 move-multiple instruction, referred to here after as a block move.  For optimum performance, the block move is implemented in assembler.  The number of bytes read is returned to the caller.",1
  The DPU-DCI shall write to the DCI Registers in C-bit words only,"Standard I/O Interface The write primitive does not block.  The write() primitive is managed by the tyLib function, tyWrite() when the driver is not in BGTX Message Mode.  The size of the Tx ring buffer is specified in the call to ssiDevCreate() as part of the device instantiation. This routine returns either the number of bytes written, or ERROR.",1
  The DPU-DCI shall read from the DCI Registers in C-bit words only,External Program InterfacesReads the BIT results from the location pointed to by pBitResults (which is assumed to be in EEPROM) into the BIT results data structure in DRAM.,1
  The DPU-DCI shall read from the DCI Registers in C-bit words only,"Standard I/O InterfaceThe read() primitive does not block.  The read() primitive is implemented by simply passing its parameters to the tyLib function tyRead().The size of the Rx ring buffer is specified in the call to ssiDevCreate() as part of the device instantiation.This routine returns either the number of bytes read, or ERROR.",1
  The DPU-DCI shall read from the DCI Registers in C-bit words only,"Standard I/O InterfaceThe read() primitive does not block.  A read is performed on the active portion of the H/W ping pong buffer using the RAD 6000 move-multiple instruction, referred to here after as a block move.  For optimum performance, the block move is implemented in assembler.  The number of bytes read is returned to the caller.",1
  The DPU-DCI shall read from the DCI Registers in C-bit words only,Hardware InterfacesThe DCI Driver CSC accesses each of the registers on the Company X Communications module using D16 VME access mode.  Reads from DCI memory are performed in VME D32 mode via a special assembly language routine which uses the lwm/stm instructions to minimize the transfer time.,1
  The DPU-DCI shall write to the DCI Memory in B-bit words only.,"CPU BITThe CPU BIT consists of a series of tests designed to test each of the functional units of the processor.  These include test for the Branch-Unit, the Fixed-Point Unit, the Floating-Point Unit, the Interrupt-Unit, and the Timer Unit.   Each of these tests consists of executing a few selected instructions from the this functional unit. The General Purpose Registers (GPR), the Segment Registers (SR), the Counter Register (CTR), and the Condition Register are tested for stuck-bits as part of the Branch-Unit test.  This is done by writing a 1s pattern (verified by reading it back) and then writing a 0s pattern (verified by reading it back).",1
  The DPU-DCI shall write to the DCI Memory in B-bit words only.,"Public FunctionsThe routine formats the given data into a CCSDS Telecommand Packet and writes it to the 1553 bus shared memory for transmission to the SCU.  If a message is already pending in the 1553 shared memory, the pending messages will be replaced in 1553 shared memory with the new message, and an error will be reported.",1
  The DPU-DCI shall write to the DCI Memory in B-bit words only.,"Standard I/O Interface The write primitive does not block.  The write() primitive is managed by the tyLib function, tyWrite() when the driver is not in BGTX Message Mode.  The size of the Tx ring buffer is specified in the call to ssiDevCreate() as part of the device instantiation. This routine returns either the number of bytes written, or ERROR.",1
  The DPU-DCI shall provide the capability for an application program to reset the DCI by writing to the DCI Reset Register.," Startup SequenceThe DPU FSW is booted using PROM-resident bootstrap software.  The bootstrap software performs a basic set of built-in tests, then copies the DPU FSW from EEPROM to DRAM and executes it.  In flight, there are two methods which can trigger the DPU FSW to boot:* power-on (cold boot), or* watchdog reset (warm boot, commanded reboot).",1
  The DPU-DCI shall provide the capability for an application program to reset the DCI by writing to the DCI Reset Register.,"Bootstrap CSCThe Bootstrap CSC is a Level 1 reuse component from the SSFF and INSTRUMENT Y projects. The Bootstrap for the Company X DPU will be nearly identical to that used on the INSTRUMENT Y CIDP and SCU, with the exception of minor hardware interface differences:* The interface to the hardware watchdog timer is different on the Company X DPU versus that used on the INSTRUMENT Y CIDP/SCU.* The interface to the mission elapsed time (MET) clock is different on the Company X DPU versus that used on the INSTRUMENT Y CIDP/SCU.* The INSTRUMENT Y bootstrap was able to discern a cold (power-on) boot from a warm (watchdog reset) boot by examining the value of the MET clock, which did not reset to zero on a warm boot.  The Company X DPU MET clock resets to zero on both a cold and warm boot, and so there is no distinction in the Company X bootstrap.",1
  The DPU-DCI shall provide the capability for an application program to reset the DCI by writing to the DCI Reset Register.,Watchdog LibraryThis function strobes the system watchdog to prevent a watchdog reset.,1
Each MODIS standard data product shall be produced within the data volume and processing load allocation shown in Table B-1.,The L1A/Geolocation software shall use HDF Version 4.1r1 for reading and writing all HDF files.  ,1
"A MODIS Computer Software Configuration Item (CSCI) is any independently tracked and configured unit of software within the MODIS SDP S/W, including processes, scripts, and utility libraries.  Each CSCI in the MODIS SDP S/W shall run in the ECS production environment.",The L1A/Geolocation software shall follow the coding standards established by the MODIS project in MODIS Software Development Standards and Guidelines  ,1
"A MODIS Computer Software Configuration Item (CSCI) is any independently tracked and configured unit of software within the MODIS SDP S/W, including processes, scripts, and utility libraries.  Each CSCI within the MODIS SDP S/W systemshall employ the Earth Science Data and Information System (ESDIS)-supplied SDPTK mandatory functions to access the DAAC production environment and services.",The L1A/Geolocation software shall use all applicable mandatory SDPTK 5.2 routines and any additional SDPTK routines that are useful.  ,1
"A MODIS Computer Software Configuration Item (CSCI) is any independently tracked and configured unit of software within the MODIS SDP S/W, including processes, scripts, and utility libraries.  Each CSCI within the MODIS SDP S/W systemshall employ the Earth Science Data and Information System (ESDIS)-supplied SDPTK mandatory functions to access the DAAC production environment and services.",The L1A/Geolocation software shall use all applicable mandatory SDPTK routines and any additional SDPTK routines that are useful.  ,1
"A MODIS Computer Software Configuration Item (CSCI) is any independently tracked and configured unit of software within the MODIS SDP S/W, including processes, scripts, and utility libraries.  Each CSCI shall be coded according to thestandards specified in the MODIS Software Development Standards and Guidelines, SDST-022 .",The L1A/Geolocation software shall use all applicable mandatory SDPTK 5.2 routines and any additional SDPTK routines that are useful.  ,1
"A MODIS Computer Software Configuration Item (CSCI) is any independently tracked and configured unit of software within the MODIS SDP S/W, including processes, scripts, and utility libraries.  Each CSCI shall be coded according to thestandards specified in the MODIS Software Development Standards and Guidelines, SDST-022 .",The L1A/Geolocation software shall use all applicable mandatory SDPTK routines and any additional SDPTK routines that are useful.  ,1
"A MODIS Computer Software Configuration Item (CSCI) is any independently tracked and configured unit of software within the MODIS SDP S/W, including processes, scripts, and utility libraries.  Each CSCI shall be coded according to thestandards specified in the MODIS Software Development Standards and Guidelines, SDST-022 .",The L1A/Geolocation software shall follow the coding standards established by the MODIS project in MODIS Software Development Standards and Guidelines  ,1
Each MODIS Standard Product shall contain ECS core metadata with the content and format specified in DID 311.,"Shall create ECS_standard_global_metadata and MODISL1A_specific_global_metadata for each completed Level1A_data product, using Level0_open_metadata and selected metadata contained in MODIS_scan.  ",1
All searchable product-specific metadata in MODIS standard products shall be formatted as specified in DID 311.,"Shall create ECS_standard_global_metadata and MODISL1A_specific_global_metadata for each completed Level1A_data product, using Level0_open_metadata and selected metadata contained in MODIS_scan.  ",1
Each MODIS standard product shall contain the MODIS product file name for all input product files as ECS archive metadata.,"Shall create ECS_standard_global_metadata and MODISL1A_specific_global_metadata for each completed Level1A_data product, using Level0_open_metadata and selected metadata contained in MODIS_scan.  ",1
Each software process shall trap and properly process all exceptions that may produce an abnormal terminationand report all such events using the SDPTK error message functions.,Shall write L0_open_log_msgs to Log_messages when errors occur in the Open_Level0_file process.   ,1
Each software process shall trap and properly process all exceptions that may produce an abnormal terminationand report all such events using the SDPTK error message functions.,Shall write Level0_header_log_msgs to Log_messages if the Spacecraft_indicator verification fails.  ,1
Each software process shall trap and properly process all exceptions that may produce an abnormal terminationand report all such events using the SDPTK error message functions.,Shall write Read_packet_log_msgs to Log_messages when errors occur in the Read_MODIS_packet process.  ,1
Each software process shall trap and properly process all exceptions that may produce an abnormal terminationand report all such events using the SDPTK error message functions.,Shall issue Program_stop if MODIS_packets cannot be read from Level0_data file.  ,1
Each software process shall trap and properly process all exceptions that may produce an abnormal terminationand report all such events using the SDPTK error message functions.,Shall write Verify_CCSDS_log_msgs to Log_messages when errors occur in the Verify_CCSDS_header_info process.  ,1
Each software process shall trap and properly process all exceptions that may produce an abnormal terminationand report all such events using the SDPTK error message functions.,Shall write Verify_MODIS_log_msgs to Log_messages when errors occur in the Verify_MODIS_header_info process. ,1
"Each software process shall be able to process input data sets with the following nominal attributes: Time transitions, including Greenwich Meridian crossing, leap year, beginning of the year, beginning of the millennium, and/or startof data collection not on a granule boundary.  Terminator crossing , International Date Line crossing, and/or Earth pole within a granule.  Day, Night, or mixed  mode data.","process input data sets with the following nominal attributes: * Time transitions, including Greenwich Meridian crossing, leap year, beginning of the year, beginning of the millennium, and/or start of data collection not on a granule boundary. * Terminator crossing , International Date Line crossing, and/or Earth pole within a granule. Day, Night, or mixed  mode data.  ",1
Each Software process shall handle input data sets with the following error attributes: Corrupted data as indicated by Quality Assurance (QA) flags also located within the file.,Shall Abort_current_packet_processing if the calculated packet checksum is not the same as the packet_checksum in the MODIS_pkt.   ,1
Each Software process shall handle input data sets with the following error attributes: Wrong format input files.,Shall verify that the Spacecraft_indicator contained in the Level1A_Parameters is consistent with the Spacecraft_indicator found in the Level 0 file header.  ,1
Each Software process shall handle input data sets with the following error attributes: Wrong format input files.,Shall generate data_input_status_messages if errors are encountered in reading Level_2_Data. ,1
Each Software process shall handle input data sets with the following error attributes: Wrong format input files.,Shall generate data_input_status_messages if errors are encountered in reading Level_1B_Data.  ,1
Each software process shall perform quality checks on the input and output data and report on the degree to which the product conforms to instrument specification or science data accuracy specifications.,Shall incorporate level1a_scan_flags into scan_quality flags.  ,1
Each software process shall perform quality checks on the input and output data and report on the degree to which the product conforms to instrument specification or science data accuracy specifications.,Shall report errors as parameter_input_status_messages in log status message file through the use of SDP functions.  ,1
Each software process shall perform quality checks on the input and output data and report on the degree to which the product conforms to instrument specification or science data accuracy specifications.,Shall detect corrupt converted_instrument_scan_data.converted_mirror_encoder_data.  ,1
Each software process shall perform quality checks on the input and output data and report on the degree to which the product conforms to instrument specification or science data accuracy specifications.,Shall generate data_input_status_messages and set scan_quality_flags if corrupted data values are detected.  ,1
 The DPU-ICUI shall use DPU-SSI to communicate with the SSI Interface.,"InitializationThe driver is initialized by invoking the initialization function adcInit().  The function initializes the ADC_LIST_ENTRY array, sets up convenience pointers to the ADC hardware registers, and sets up the ADC multiplexer for the first conversion (otherwise the very first ADC value requires three calls to adcUpdateNext()).  The ADC Driver can be re-initialized, which will result in the values in the ADC_LIST_ENTRY array being reset to their default values.The ADC_VALUEs are A-bit data items; however the hardware contains a B-bit A/D.  The upper bits are used to indicate invalid or suspect values as follows:* At initialization, the MSbit of each of the ADC_VALUEs is set (0x8000).* If a conversion fails (i.e. the driver reads the analog value and determines that the conversion has not yet completed), the second MSbit.",0
  The Bootstrap Monitor of the DPU-BOOT CSC shall provide the capability to load a configuration of the DPU-RTOS from EEPROM to DRAM and start its execution on command.,Watchdog LibraryThis function strobes the system watchdog to prevent a watchdog reset.,0
  The DPU-TIS shall report errors to an application program by setting the ERRNO task variable and returning ERROR.,Real-Time Clock InterfaceThis routine gets the value of the Real-Time Clock (RTC) Registers and places the results in variables rtcu and rtcl.,0
 The DPU-TMALI  shall provide TMALI_HK to the DPU-CCM on request.,Install Exception Handlersa default interrupt handler and is installed into element five (5) of the system interrupt table.,0
"A MODIS Computer Software Configuration Item (CSCI) is any independently tracked and configured unit of software within the MODIS SDP S/W, including processes, scripts, and utility libraries.  Each CSCI within the MODIS SDP S/W systemshall employ the Earth Science Data and Information System (ESDIS)-supplied SDPTK mandatory functions to access the DAAC production environment and services.","Development PlatformThe DPU FSW will be implemented in the ANSI C programming language, with some PowerPC assembly used in the Bootstrap and to implement the VME data transfer in the DCI Driver.  The host (development) platform and operating system is Sun/Solaris from Sun Microsystems, Inc.  The target platform is the RAD6000 processor which has a POWER (PowerPC-like) architecture, and executes the VxWorks 5.3.1 real-time operating system.  The cross compiler and debugger is MULTI/C/C++ 1.8.9 from Green Hills Software, Inc.",0
  The DPU-SSI shall provide the capability for an application program to install a callback routine to respond to the receive IBG Interrupt.,Public FunctionsThis routine provides a means for the CCM task to send the XRT Position command from the ICU to the DPA software. The XRT Position command shall be used to command the DPU to update the position and window parameters that it uses to spatially filter event data. ,0
"  The DPU-BOOT CSC shall complete Stage 1 BIT, and load DPU-RTOS in less than A seconds following a hardware reset if CTS is not asserted.","InitializationThe SCUI CSC is initialized when the scuiTask() is spawned by the CCM CSC.  Initialization parameters which are passed into the scuiTask() include:* Poll Rate  rate at which the S/C will poll the DPU for telemetry.  The rate is specified in Hz, and has a default of X Hz based on the INSTRUMENT X-DPU poll rate in the Company X 1553 ICD.* Buffer Rate  value used to rate buffer data to the S/C.  The rate is specified in bits per telemetry poll, and has a default of 7664 which is equal to one STPDU per poll (*** bytes per STPDU times V bits/byte).  This default value effectively disables rate buffering.* Size of Low Priority Queue  size in bytes of the low priority telemetry queue.  If the amount requested cannot be allocated, the buffer will be allocated at  the amount of memory contained in the largest free memory block.Size of High Priority Queue  size in bytes of the high priority telemetry queue. If the amount requested cannot be allocated, the buffer will be allocated at  the amount of memory contained in the largest free memory block.",0
"  The DPU-CCM shall produce DPU_HK at a commandable rate, with a default of 10 seconds.",Shall write L0_open_log_msgs to Log_messages when errors occur in the Open_Level0_file process.   ,0
 The DPU-DCI shall provide an application program with the ability to toggle the hardware interface between Normal mode and Test mode.,"Telemetry Output to the Spacecraft 1553 BusThe SCU, which is a MIL-STD-1553 Bus Controller (BC), periodically reads the STPDU contained in the fifteen telemetry subaddresses, and then writes to the telemetry done subaddress.  When the telemetry done subaddress is written, the scuiTlmDoneISR() is called which gives a semaphore to awaken the scuiTask().  The software provides fault tolerance by automatically awaking after approximately two polling periods.  This timeout is automatically adjusted any time the SCU Poll Rate value is changed by command.",0
  The centroid confirmation engineering mode shall produce a PROD_CENTROID_CONF.  This mode shall divide a full frame image into a certain regions.  Each region shall be processed to form an 8x8 confirmation image.  The certain confirmation images shall be sent to the solid state recorder as one data product.,Shall issue Program_stop if MODIS_packets cannot be read from Level0_data file.  ,0
"  The DPU-BOOT CSC shall complete Stage 1 BIT, and load DPU-RTOS in less than A seconds following a hardware reset if CTS is not asserted.",Shall write Level0_header_log_msgs to Log_messages if the Spacecraft_indicator verification fails.  ,0
Each software process shall trap and properly process all exceptions that may produce an abnormal terminationand report all such events using the SDPTK error message functions.,"remaining DPU FSW tasksFollowing startup, the Command and Control Task spawns the remaining DPU FSW tasks, which are described below:* The Command Dispatch Task (ccmCmdTask) is an Application Framework Software task which is responsible for dispatching commands which arrive from the ICU or the SCU.  Commands are executed directly by this task by calling the applicable CSC function* The SCU Interface Task (scuiDPTask) receives telemetry data from other tasks, converts them to CCSDS Version1 Source Packets, forms Company X Telemetry Protocol Data Units (STPDUs) from the Source Packets, and transmits the STPDUs to the SCU via the MIL-STD-1553B Interface.* The Telescope Module Event Transfer Task (tmaliTask) is an Application Framework Software task which is responsible for transferring data from the DCI ping/pong buffers to the TMALI data buffer in response to a DCI frame limit or data timeout interrupt.* The Data Compression Task (dcxTask) receives telemetry data from other tasks, uses a lossless data compression algorithm to compress the data, and then enqueues the data to the SCU Interface Task.* The Data Processing Algorithms Tasks (dpaIMTask and dpaEPTask) process incoming detector events according to the commanded mode, create data products, and enqueue those data products to the Data Compression Task (if compression is enabled) or to the SCU Interface Task.* The Error Detection and Correction Memory Scrubber Task (edacTask) cycles through the text and data segments of the DPU to trigger the correction of single-bit errors which may have occurred, in order to help prevent the occurrence of uncorrectable multiple-bit errors.",0
" At startup, the DPU-RTOS shall execute the BIT device RAM tests (cold boot only), install device drivers, execute the BIT driver loopback tests (cold boot only), and then spawn the application flight software.",Data Capture Interface Driver CSCThe Data Capture Interface (DCI) Driver CSC is a new driver which provides a standard VxWorks driver interface to the DCI hardware.  The driver features two modes: a test mode and a normal mode.,0
Each Software process shall handle input data sets with the following error attributes: Wrong format input files.,"CPU BITThe CPU BIT consists of a series of tests designed to test each of the functional units of the processor.  These include test for the Branch-Unit, the Fixed-Point Unit, the Floating-Point Unit, the Interrupt-Unit, and the Timer Unit.   Each of these tests consists of executing a few selected instructions from the this functional unit. The General Purpose Registers (GPR), the Segment Registers (SR), the Counter Register (CTR), and the Condition Register are tested for stuck-bits as part of the Branch-Unit test.  This is done by writing a 1s pattern (verified by reading it back) and then writing a 0s pattern (verified by reading it back).",0
  The DPU-ICUI shall report errors to DPU-CCM for inclusion in the DPU_HK.,"Memory Upload and Download HandlingIf more than 65535 bytes need to be uploaded, the upload file must be broken up into multiple smaller files, each less than or equal to 65535 bytes, and then each of the virtual uploads should be sent in series.  Because of the sequence numbers, the DPU FSW can receive individual upload commands out of sequence.  There is no time limit for the accomplishment of a single virtual upload, and so a long upload can continue across ground contacts.  If an upload is in progress, the last sequence number can be sent to the DPU FSW and it will report the list of missing sequence numbers via event number S_ccm_MISSING_SEQNO.  If an upload is in progress and needs to be cancelled, it can be discarded by issuing the D_MEM_DAT_CNCL command.",0
 The DPU-TMALI shall allocate a ring buffer of size specified by TMALI_BUFFER_SIZE provided during initialization for storing incoming frames of data.  The default buffer size shall be 15 MB.,"Public FunctionsThis routine gets housekeeping data stored for the TMALI CSC including some DCI parameters and resets the tmali internal counters to zero.  When the caller supplied pointer to a TMALI_HK structure is NIL no data is returned but the tmali internal counters are still reset to zero.Two of the four error counters are updated within an ISR context, this requires a task switch safe implementation of these counters.  Within VxWorks this could be solved using a counting semaphore.  In the TMALI CSC design a faster method was used by using a free running error counter and a careful update of the reported number of errors, using an extra temporary variable.  As the increment and assignment of the 32 bit unsigned integers themselves are atomic operations the resulting counters are task safe and no error events are lost.  This means that the sum of the errors reported by the tmaliHkGet() function is equal to the total numbers of errors that occurred, no error reports are lost due to the update of the internal structures.",0
 The DPU-TMALI shall allocate a ring buffer of size specified by TMALI_BUFFER_SIZE provided during initialization for storing incoming frames of data.  The default buffer size shall be 15 MB.,"interrupt service routine (ISR)The DPU responds to interrupts via an interrupt service routine (ISR).  VME interrupts are prioritized; however the DPU does not allow nested interrupts, and so any interrupts which occur while servicing another interrupt will pend until the current ISR has returned.",0
  The DPU-DCI shall read from the DCI Registers in C-bit words only,"Data Transfer to QueueDuring initialization, the TMALI CSC installs an ISR hook routine, tmaliTransferToQueueISR(),  into the DCI Driver which is invoked when:* the DCI interface reaches the programmed frame limit in the Ping-Pong buffer, or* the DCI interface detects a data receipt timeout.",0
  The DPU-BOOT CSC shall initialize the BIT_DATA in the SYSTEM_BLOCK to the incomplete/failure state prior to executing Stage 1 BIT.,Normal Data Exchange SequenceThe TMALI CSC serves as an intermediate manager of EVENT data supplied by the DCI Driver CSC and eventually delivered to the DPA CSC.  The TMALI CSC waits for notification from the DCI CSC that a frame limit (or data timeout) has been reached in the Ping-Pong buffer indicating the EVENT data is ready to be served to TMALI.   TMALI reads all EVENT data from the DCI and notifies the DCI that it can swap Ping-Pong buffers when ready.   TMALI gives a semaphore to unblock the tmaliWait() call from the DPA.,0
 The DPU-ICUI shall use DPU-SSI to communicate with the SSI Interface.,"InitializationThe DCX CSC is initialized when the dcxTask() is spawned by the CCM CSC.  During initialization, the DCX CSC creates a compression queue to contain data packages which are pending compression.  Access to the compression queue is protected by a mutual exclusion semaphore.  The size of the compression queue is controlled by an initialization parameters which is passed into the dcxTask().  If the amount of memory requested cannot be allocated, initialization of the DCX CSC will fail.",0
" The DPU-SCUI shall detect the condition in which the SCU fails to read one or more MIL-STD-1553B subaddresses during the transmission of a STPDU, shall cancel the write on those subaddresses, record new data to those subaddresses, and report an error to the DPU-CCM.","Public FunctionsThis routine is called by any CSC in order to report an error or event that should be included in DPU housekeeping.  If this routine is called from interrupt context a static global variable, ccmISRError, is set so that the error can be enqueued later (see ccmCtrlTask()).  This is done since the error/event queue is semaphore-protected and a semaphore cannot be taken in an ISR.  The error queue semaphore has priority inversion set to reduce conflicts between multiple callers should a priority inversion situation arise. This routine also replaces frequently occuring errors with a special repeat error code.  The repeat error code is a special error code that follows a normally reported error code to indicate that the normally reported error code previously reported has occurred more than once in the last high rate reporting period",0
"  The DPU-SCUI shall compute a CHKS16 for telecommands received from the SCU.  If the CHKS16 does not match the value included in the telecommand,  an error will be reported to DPU-CCM.  If the checksum computes correctly, the command will be forwarded to DPU-CCM for execution.","Channel Boundary (CB) Engineering ModeThe purpose of Channel Boundary Mode is to derive the optimum channel boundary settings from a flat field. Detector events produced in the M,N detector mode are collected and histogrammed for a commanded integration time.  The pseudo Instrument Y is transmitted to the ground.  Channel boundaries are derived from the Instrument Y and transmitted to the ICU and the ground.  Channel boundaries are sent by the ICU to the BPE and used in the detector event centroiding process.",0
  The DPU-SSI shall provide the capability for an application program to set the Inter-Block Gap (IBG) Timeout for transmitted and received messages.,SCU Interface CSCThe SCU Interface (SCUI) CSC is a Level 3 reuse component from the INSTRUMENT Y project.  The SCUI CSC is primarily responsible for implementing the application protocol with the SCU. The SCUI CSC provides CCSDS packetization services and manages the interface between the DPU and the SCU.,0
  The DPU-DCI shall provide an application program with the ability to read and write the hardware ping-pong buffers when in Test Mode.,"Public FunctionsThis task initializes the TMALI CSC and then continues to read data from the DCI and store it in the TMALI buffer each time the DCI driver signals that data is available in the Ping-Pong buffer.  The availability of data in the DCI Ping-Pong buffer is signaled to the tmaliTask using a semaphore.  Unless a fatal error is detected during initialization this task will never terminate.The specified 3 parameters specify the size of the TMALI queue and the initial parameters for the DCI, if the specified values are outside the allowed range default values will be used.The specified QueueSize is the allocated buffersize (in 4 byte EVENTS), the ring buffer is full when QueueSize-1 EVENTS are stored in the buffer.",0
"  The DPU-CCM shall produce DPU_HK at a commandable rate, with a default of 10 seconds.","Public FunctionsThis routine is called by the MIL-STD-1553 Command ISR and the SSI Interface ISR any time a command arrives from the SCU or the ICU, to enqueue the command and to wakeup the CCM Command Dispatch Task so that the command can be executed.",0
" The DPU-SCUI shall be capable of preparing one STPDU for delivery to the SCU every M milliseconds, or shall indicate a No Data condition to the SCU by maintaining an un-incremented ST_PDU Transfer Request Counter field.","Time SynchronizationThe interface with the spacecraft as described in document 1143-EI-S19121 specifies that the spacecraft will provide a Clock Message to each Instrument at a 1 Hz rate.  The Clock Message contains both two values: a value representing the current spacecraft time, and a value representing the delta from the spacecraft time and the Univeral Time (UT), based on an epoch of TBD.",0
 The DPU-CCM shall provide a mechanism for other CSCs to report errors for inclusion in the DPU_HK.,"Time SynchronizationThe interface with the spacecraft as described in document 1143-EI-S19121 specifies that the spacecraft will provide a Clock Message to each Instrument at a 1 Hz rate.  The Clock Message contains both two values: a value representing the current spacecraft time, and a value representing the delta from the spacecraft time and the Univeral Time (UT), based on an epoch of TBD.",0
  The DPU-BOOT CSC shall provide a monitor which accepts commands over the RS-232 interface.,Normal Data Exchange SequenceThe TMALI CSC serves as an intermediate manager of EVENT data supplied by the DCI Driver CSC and eventually delivered to the DPA CSC.  The TMALI CSC waits for notification from the DCI CSC that a frame limit (or data timeout) has been reached in the Ping-Pong buffer indicating the EVENT data is ready to be served to TMALI.   TMALI reads all EVENT data from the DCI and notifies the DCI that it can swap Ping-Pong buffers when ready.   TMALI gives a semaphore to unblock the tmaliWait() call from the DPA.,0
"  The DPU-BOOT CSC shall include a CPU BIT consisting of a branch test, a fixed point test, a floating point test, an interrupt test, a timer test, and a register test.",Public FunctionsThis routine is spawned by the Command and Control Task to initialize and execute the DPA Instrument Y Processing Task.,0
  The centroid confirmation engineering mode shall produce a PROD_CENTROID_CONF.  This mode shall divide a full frame image into a certain regions.  Each region shall be processed to form an 8x8 confirmation image.  The certain confirmation images shall be sent to the solid state recorder as one data product.,Install Exception HandlersThis routine installs a hook routine for the Power Failure Interrupt.  The hook routine will be called from the interrupt context.  This function returns OK always.,0
  The DPU-BIT shall test the Error Detection and Correction (EDAC) on the Company X Communication/Memory Module by reading preprogrammed error locations in PROM.,Shall write Level0_header_log_msgs to Log_messages if the Spacecraft_indicator verification fails.  ,0
  The DPU-BIT shall report errors that occur during tests as failures in the test results.,"Built-In Test CSCThe Built-In Test (BIT) CSC is a Level 2 reuse component from the SSFF and INSTRUMENT Y projects.  The detailed design of the BIT CSC follows. The Built-In Tests CSC, identified DPU-BIT, performs the Stage 2 Built-In Tests (BIT).  The Stage 2 BIT includes a test of the SCM EDAC circuit, a checksum test on SCM PROM, a MIL-STD-1553B internal BIT, and a memory test of the DCI Data Buffers. The results of the BIT are recorded in the SYS_CNFG_AREA in EEPROM and are also maintained in DRAM.  If an error occurs in one of the functions performing the BIT, the test result will be reported as a failure in the test itself.",0
  The DPU-EDAC shall record the number of MBEs that have been detected in DRAM since boot and the address of the last two MBEs.,"Time RetrievalThe DPU maintains a local copy of the spacecraft clock and current UT Delta in order that the DPU FSW can timestamp data products and packets.  The TIS CSC provides a function, tisTimeGet(), which retrieves a copy of both the current DPU clock value and the most recent UT Delta value.  Time is communicated among DPU FSW applications via the TIS_TIME data structure.",0
The image mode shall shift successive frames according to the calculated spacecraft drift and co-add the frame into an accumulated image.,"Receiving Commands from the SpacecraftThe DPU/SCU interface specifies that commands for the DPU will be transmitted from the SCU to the DPU on a separate MIL-STD-1553 subaddress.  The SCU Interface Command Reader ISR, scuiCmdReadISR(). consists of an ISR installed on a specific MIL-STD-1553 subaddress corresponding to the command subaddress for the INSTRUMENT X DPU. This ISR is installed at initialization by scuiInit().  Upon interrupt, the scuiCmdReadISR() reads a single telecommand from the 1553 bus, checks the length and checksum, and then forwards valid commands to the Command and Control CSC for dispatch via ccmCmdEnq().  Errors are reported by incrementing an invalid command counter.",0
  The DPU-ICUI shall receive real-time DPU_CMDs from the ICU via SSI and forward them to DPU-CCM.,"Telemetry Output to the Spacecraft 1553 BusThe SCU, which is a MIL-STD-1553 Bus Controller (BC), periodically reads the STPDU contained in the fifteen telemetry subaddresses, and then writes to the telemetry done subaddress.  When the telemetry done subaddress is written, the scuiTlmDoneISR() is called which gives a semaphore to awaken the scuiTask().  The software provides fault tolerance by automatically awaking after approximately two polling periods.  This timeout is automatically adjusted any time the SCU Poll Rate value is changed by command.",0
  The DPU-RTOS shall provide the capability to invoke user-installed Interrupt Service Routines (ISRs) in response to internal and external (VME) interrupts.,Shall detect corrupt converted_instrument_scan_data.converted_mirror_encoder_data.  ,0
 The DPU-SCUI  shall notify the SCU of new data by using the Transfer Request Counter in accordance with interface control document 1143-EI-S19121.,External Program InterfacesThis routine copies the BIT Results into bitHk for inclusion in the DPU Housekeeping.,0
"A MODIS Computer Software Configuration Item (CSCI) is any independently tracked and configured unit of software within the MODIS SDP S/W, including processes, scripts, and utility libraries.  Each CSCI shall be coded according to thestandards specified in the MODIS Software Development Standards and Guidelines, SDST-022 .","Public FunctionsThis task initializes the TMALI CSC and then continues to read data from the DCI and store it in the TMALI buffer each time the DCI driver signals that data is available in the Ping-Pong buffer.  The availability of data in the DCI Ping-Pong buffer is signaled to the tmaliTask using a semaphore.  Unless a fatal error is detected during initialization this task will never terminate.The specified 3 parameters specify the size of the TMALI queue and the initial parameters for the DCI, if the specified values are outside the allowed range default values will be used.The specified QueueSize is the allocated buffersize (in 4 byte EVENTS), the ring buffer is full when QueueSize-1 EVENTS are stored in the buffer.",0
"  The DPU-DPA shall command DPU-TMALI to reorder EVENT data bits as a function of the Detector Electronics Output Format (Science Mode 3, Full-Frame High Res), and the commanded DPU science or engineering mode.  ","Checksum Library This function performs a checksum on a specified memory range.  The checksum is performed as an 8-bit additive checksum, but the accumulated value is stored in a 16-bit variable.",0
 The DPU-CCM shall use DPU-EEPRM to access the EEPROM.,"Public FunctionsThis routine provides a means to set the data timeout used by the DCI, the value requested indicates the timeout in milliseconds.  The initial value for the frame depth setting is determined by the parameter provided when starting the tmaliTask.  The maximum value to which the timeout can be commanded is X seconds, an attempt to set the timeout to a number larger than this maximum will result in setting the timeout to the default value of X milliseconds",0
  The DPU-TMALI shall provide a function which sets the current event bit ordering mode in the DCI driver.,"Time Interface ConfigurationThe DPU hardware provides two configuration options to the software:* selection of the active A PPS signal, and* the option to manually jam a value into the clock registers without the A PPS signal.",0
  The DPU-DPA shall calculate drift with respect to the reference frame based on the established guide stars then perform a shift-and-add of the image mode data.,"Ring buffer data structureThe  CSC maintains a FIFO implemented as a ring buffer to temporarily store the data received from the DCI before it is processed. The ring buffer uses two pointers called pIn and pOut to keep track of the data in the buffer. The pointers were defined such that reading from the buffer is the simplest operation and only a single compare is needed to verify if the buffer is empty. The buffer only stores Events so the pointers point to these four byte entities. As the DCI specifies all data in bytes, sizes have to be converted before reading data.",0
" There shall be four engineering modes associated with the detector: raw event list mode, channel boundary mode, centroid confirmation mode, and intensifier characteristics mode.","Install Exception Handlers Certain conditions can cause the VxWorks? exception handler to reboot the DPU.  These conditions include a Data Storage Interrupt from within an interrupt context, a Multiple-Bit Error (MBE), and a deferred-work queue overrun.  Under these circumstances, interrupting devices on the Company X Communication/Memory Module must be stopped prior to jumping back to the Bootstrap.  This can be done by installing a hook routine to perform the cleanup in sysHwInit() using the function rebootHookAdd().  However, to avoid the need to cleanup interrupts, an exception handler is installed which forces a watchdog reset, which will effectively clean up the pending interrupt problem.  The exception hook saves the contents of the Exception Stack Frame to EEPROM and waits for a watchdog timeout.  The following call is added to the usrRoot() function in usrConfig.c:",0
"A MODIS Computer Software Configuration Item (CSCI) is any independently tracked and configured unit of software within the MODIS SDP S/W, including processes, scripts, and utility libraries.  Each CSCI in the MODIS SDP S/W shall run in the ECS production environment.","Public FunctionsThis routine provides a means to set the bit arrangement used by the DCI.  When bSpecialArrangement is TRUE, the DCI is set to special bit arrangement mode, otherwise the default mode of no rearrangement is set.",0
"  The DPU-TIS shall provide the capability for an application program to set the value of the SC_TIME register(s) on the SCM and enable the 1PPS clock jam register, if automatic time synchronization is enabled.",Shall write Verify_MODIS_log_msgs to Log_messages when errors occur in the Verify_MODIS_header_info process. ,0
Each MODIS standard product shall contain the MODIS product file name for all input product files as ECS archive metadata.,"Public FunctionsThis routine gets housekeeping data stored for the TMALI CSC including some DCI parameters and resets the tmali internal counters to zero.  When the caller supplied pointer to a TMALI_HK structure is NIL no data is returned but the tmali internal counters are still reset to zero.Two of the four error counters are updated within an ISR context, this requires a task switch safe implementation of these counters.  Within VxWorks this could be solved using a counting semaphore.  In the TMALI CSC design a faster method was used by using a free running error counter and a careful update of the reported number of errors, using an extra temporary variable.  As the increment and assignment of the 32 bit unsigned integers themselves are atomic operations the resulting counters are task safe and no error events are lost.  This means that the sum of the errors reported by the tmaliHkGet() function is equal to the total numbers of errors that occurred, no error reports are lost due to the update of the internal structures.",0
  The DPU-CCM shall quietly discard any unrecognized observatory messages (I.e. messages which do not have a DPU command APID).,"Public FunctionsOperationally, the DPU uses the Jam bit in the DCI CSR to indicate whether the DPU is actively syncing its clock with the spacecraft or not.  This function sets the Jam bit if autoSync is FALSE, and negates the Jam bit otherwise. THIS FUNCTION ALTERS THE VALUE OF THE DCI CSR AND SHOULD NOT BE INVOKED WHEN DCI INTERRUPTS ARE ACTIVE.",0
"A MODIS Computer Software Configuration Item (CSCI) is any independently tracked and configured unit of software within the MODIS SDP S/W, including processes, scripts, and utility libraries.  Each CSCI in the MODIS SDP S/W shall run in the ECS production environment.",Ring buffer data structureThe pIn and pOut pointers are defined  as follows:* pIn- last location filled with data* pOut- last empty location,0
  The DPU-SSI shall provide the capability for an application program to enable/disable the VME Slave Interrupt on the SCM for the SSI Interface.,Install Exception HandlersThis routine is a default interrupt handler and is installed into element six (6) of the system interrupt table.,0
  The DPU-DPA shall be capable of collecting detector events over the full  FOV.,"Setting Frame Depth in DCIThe optimum frame depth will be determined with benchmark testing.  The default frame depth is 10 frames.  Given the above data, it will take approximately 24 msec to read 10 maximum-sized frames at the maximum data transfer rate.",0
  The Bootstrap Monitor of the DPU-BOOT CSC shall provide the capability to load a configuration of the DPU-RTOS from EEPROM to DRAM and start its execution on command.,Checksum LibraryThis function performs a checksum on a specified memory range.  The checksum is performed as a 32-bit additive checksum.,0
Each MODIS Standard Product shall contain ECS core metadata with the content and format specified in DID 311.,"Error Collection and ReportingThe ccmErrEnq() function tracks the last error reported and its frequency of occurrence.  Once an error code has been reported it becomes the previously reported error code maintained by ccmErrEnq().  A repetition count is then incremented for each subsequent, consecutively reported, identical instance of this previously reported error.  If this error code is reported more than once in one high-rate housekeeping reporting period, then a special error, S_ccm_ERR_REPEAT is enqueued with the repetition count for the error encoded in the least significant byte. This mechanism effectively reduces the potential for housekeeping telemetry to become flooded with a single repeated error.",0
  The DPU-DPA shall calculate drift with respect to the reference frame based on the established guide stars then perform a shift-and-add of the image mode data.,Shall write Level0_header_log_msgs to Log_messages if the Spacecraft_indicator verification fails.  ,0
 The DPU-TMALI shall allocate a ring buffer of size specified by TMALI_BUFFER_SIZE provided during initialization for storing incoming frames of data.  The default buffer size shall be 15 MB.,Public FunctionsThis routine provides a means for the CCM task to send the XRT Position command from the ICU to the DPA software. The XRT Position command shall be used to command the DPU to update the position and window parameters that it uses to spatially filter event data. ,0
" In Image Mode, the DPU-DPA shall be capable of binning images at different levels.","Instrument Y ProcessingAt the end of an exposure, the Instrument Y in the accumulation buffer is transferred to the Instrument Y data product buffer one horizontal line at a time, starting at the top of the Instrument Y to form a PROD_INSTRUMENT Y data product.  This rasterized Instrument Y in the Instrument Y data product buffer will be enqueued for transmission to the spacecraft.",0
"  The DPU-BOOT CSC shall include a CPU BIT consisting of a branch test, a fixed point test, a floating point test, an interrupt test, a timer test, and a register test.",Watchdog LibraryThis function strobes the system watchdog to prevent a watchdog reset.,0
 The DPU-CCM shall use DPU-EEPRM to access the EEPROM.,"Bootstrap MonitorThe Bootstrap Monitor checks entered commands for syntax and number of arguments, and displays an error message to the RS-232 interface if an invalid command or argument is entered.  A complete listing of these messages is given in document 7384-BSPS-01.",0
" The DPU-SCUI shall be capable of preparing one STPDU for delivery to the SCU every M milliseconds, or shall indicate a No Data condition to the SCU by maintaining an un-incremented ST_PDU Transfer Request Counter field.",Error Detection and Correction CSCThe Error Detection and Correction (EDAC) CSC is a Level 1 reuse component from the SSFF and INSTRUMENT Y projects.  The EDAC CSC consists of a set of Interrupt Service Routines (ISRs) and a Memory Scrubber Task.  The design of the INSTRUMENT Y EDAC CSC is described in document CIDPSDS-01.The only design change was to add logic to check for excessive external (SCM) EDAC interrupts.,0
  The DPU-CCM shall strobe the Watchdog timer  by writing to the SCM_WDR at an interval of 1 second.,"Public FunctionsOperationally, the DPU uses the Jam bit in the DCI CSR to indicate whether the DPU is actively syncing its clock with the spacecraft or not.  This function sets the Jam bit if autoSync is FALSE, and negates the Jam bit otherwise. THIS FUNCTION ALTERS THE VALUE OF THE DCI CSR AND SHOULD NOT BE INVOKED WHEN DCI INTERRUPTS ARE ACTIVE.",0
 The DPU-TMALI shall configure the DCI interface data timeout at startup as specified by TMALI_TIMEOUT provided during initialization.  The default value shall be N milliseconds and shall be capable of being modified dynamically.,"Initialization The task invokes the initialization function scuiInit() which sets an instance variable, allocates ring buffers and semaphores for the Low and High Priority Telemetry Queues, initializes a buffer and semaphore for pending RT-RT command messages, creates the scuiTask() wakeup semaphore, initializes internal data structures, opens and initializes file descriptors for each of the required MIL-STD-1553 subaddresses and installs ISRs.  When the CCM CSC spawns the scuiTask(), it will block on a semaphore (ccmSemScuiSpawn) awaiting SCUI initialization.  Once initialization is complete, the SCUI CSC will signal successful initialization by giving the semaphore, and then write an empty STPDU to the 1553 shared memory.",0
" At startup, the DPU-RTOS shall execute the BIT device RAM tests (cold boot only), install device drivers, execute the BIT driver loopback tests (cold boot only), and then spawn the application flight software.","Time Interface ConfigurationThe TIS CSC utilizes the manual jam bit in the DCI CSR to indicate whether automatic time synchronization is enabled or disabled.  If automatic time synchronization is enabled, and a command is issued to manually jam the DPU clock, the command will be rejected - see tisTimeSet().",0
"  The DPU-1553 CSC shall address hardware modules as defined in document 1400, Company X Specification for the Company X Communication/Memory Module.","Memory Upload and Download HandlingIf more than 65535 bytes need to be uploaded, the upload file must be broken up into multiple smaller files, each less than or equal to 65535 bytes, and then each of the virtual uploads should be sent in series.  Because of the sequence numbers, the DPU FSW can receive individual upload commands out of sequence.  There is no time limit for the accomplishment of a single virtual upload, and so a long upload can continue across ground contacts.  If an upload is in progress, the last sequence number can be sent to the DPU FSW and it will report the list of missing sequence numbers via event number S_ccm_MISSING_SEQNO.  If an upload is in progress and needs to be cancelled, it can be discarded by issuing the D_MEM_DAT_CNCL command.",0
  The DPU-RTOS shall provide a function to allow an application program to write to the Real-Time Clock registers on the RAD6000SC CPU Module.,The L1A/Geolocation software shall use all applicable mandatory SDPTK routines and any additional SDPTK routines that are useful.  ,0
  The DPU-DPA will complete the exposure in the time specified by the MODE command - even if it's required to truncate the final tracking frame.,Public FunctionsThis routine provides a means for the CCM task to get the housekeeping info from the DPA software.  The CCM task will call this function and pass a pointer to the location that DPA is to store its housekeeping. ,0
  The  raw event list engineering mode shall collect events for transmission to the ground.,Setting DCI Bit ArrangementThe bit arrangement of the DCI control/status register can be set via tmaliBitArrangementSet().,0
" The DPU-SCUI shall detect the condition in which the SCU fails to read one or more MIL-STD-1553B subaddresses during the transmission of a STPDU, shall cancel the write on those subaddresses, record new data to those subaddresses, and report an error to the DPU-CCM.","Public FunctionsInitializes the TIS CSC by initializing the hardware register convenience pointers and selecting the commanded 1PPS signal, and enables or disables automatic time synchronization with the S/C according to the passed parameter. THIS FUNCTION ALTERS THE VALUE OF THE DCI CSR AND SHOULD NOT BE INVOKED WHEN DCI INTERRUPTS ARE ACTIVE.",0
  The DPU-BOOT CSC shall display a message via RS-232 on detection of a BIT failure.,InitializationThe DPA CSC is initialized by spawning the tasks dpaEventTask() and dpaInstrument YTask().  After the tasks are spawned they create the needed memory buffers.  The dpaEventTask() then enters the Idle state waiting for a Mode command from the ICU.  The dpaInstrument YTask also enters the Idle state waiting to process either the Ping or Pong buffer.  The default setting for compression (on or off) is retrieved from EEPROM.,0
 The DPU-SCUI shall be capable of receiving a telecommand from the SCU every N ms and forward it to DPU-CCM for processing.,InitializationThe DPA CSC is initialized by spawning the tasks dpaEventTask() and dpaInstrument YTask().  After the tasks are spawned they create the needed memory buffers.  The dpaEventTask() then enters the Idle state waiting for a Mode command from the ICU.  The dpaInstrument YTask also enters the Idle state waiting to process either the Ping or Pong buffer.  The default setting for compression (on or off) is retrieved from EEPROM.,0
  The DPU-BOOT CSC shall attempt to complete its normal execution sequence following detection of any failure.,"Time Interface ConfigurationThe TIS CSC utilizes the manual jam bit in the DCI CSR to indicate whether automatic time synchronization is enabled or disabled.  If automatic time synchronization is enabled, and a command is issued to manually jam the DPU clock, the command will be rejected - see tisTimeSet().",0
"The Bootstrap Monitor of the DPU-BOOT CSC shall follow the protocol specified in BSPS-01, Bootstrap Monitor Protocol Specification, with the following noted exceptions.","Public FunctionsThe routine formats the given data into a CCSDS Telecommand Packet and writes it to the 1553 bus shared memory for transmission to the SCU.  If a message is already pending in the 1553 shared memory, the pending messages will be replaced in 1553 shared memory with the new message, and an error will be reported.",0
" The DPU-CCM shall spawn tasks for DPU-CCM, DPU-DPA, DPU-DCX, DPU-SCUI, and DPU-TMALI at bootup.","Install Project-Specific Module Error IdentifiersIn order to provide a mechanism by which error numbers can be unique across device drivers and applications, each error number must contain a unique module identifier in the most significant word of the error number.  These module identifiers are defined in a VxWorks header file.",0
"  The DPU-CCM shall be able to count a consecutively reported error.  When the the count for a particular error ID, exceeds 250 for a particular reporting period, the error code will be replaced with a error code sequence which shall include the original error code and the number of times the error was reported.  ","ACS Message ProcessingThe SCUI task will send the ACS message to the DPA by calling the function dpaACSReceive().  Because the SCUI task will be calling dpaACSReceive() from an ISR, dpaACSReceive() must return quickly.  If commanded by the ICU in the Mode command, the ACS message will be saved along with the event data product.  To return quickly, dpaACSReceive() will place the ACS message in a data queue then return.  The Event Processor Task will remove the ACS messages from the queue and send them to the spacecraft.",0
  The DPU-BOOT CSC shall put the processor into diagnostic mode.,"Standard I/O InterfaceThe read() primitive does not block.  The read() primitive is implemented by simply passing its parameters to the tyLib function tyRead().The size of the Rx ring buffer is specified in the call to ssiDevCreate() as part of the device instantiation.This routine returns either the number of bytes read, or ERROR.",0
"The DPU-BOOT CSC shall perform successive writes to a word page of EEPROM within C msecs, or wait a minimum of D usecs between successive writes.","Install Exception Handlers The RSC processor also generates an external interrupt for the Power Fail Interrupt.  The RSCVME Board Support Package of VxWorks? does not directly support access to this interrupt.  Some custom routines must be provided to access this interrupt. These functions are described below, and are contained in sysLibSup.c.",0
  The DPU-SSI shall write to the SSI registers in 16-bit words only.,"Instrument Y ProcessingThe Instrument Y Processor Task will perform tracking by breaking the exposure up into 10-second sub-exposures which are shifted and added into a final histogrammed Instrument Y.  Tracking is performed by choosing guide stars from the first 10-second Instrument Y of an exposure.  Then in each subsequent Instrument Y, these guide stars are found and the drift is determined by comparing the two Instrument Ys. The Instrument Y is then shifted by the determined drift and added to the previous Instrument Ys in the accumulation buffer.",0
  The DPU-RTOS shall provide a function to allow an application program to read from the Real-Time Clock registers on the RAD6000SC CPU Module.,"Public FunctionsThis function sets the frame depth of the Ping-Pong buffers used by the DCI CSC.  The frame depth determines how many frames are read into the selected Ping-Pong buffer before interrupting.  The initial value for the frame depth setting is determined by the parameter provided when starting the tmaliTask.  The maximum value to which the frame depth can be commanded is 64 frames, an attempt to command the frame depth to a value larger than this maximum will result in setting the timeout to the default value of V frames.The actual setting of the frame depth could be delayed by a small amount of time if there is activity on the DCI bus, and is typically changed when the DCI has just reported a frame level reached or timeout condition.  This minimizes the chance of changing the setting while the hardware is close to detecting a frame event.  Changing the frame depth while the DCI CSC is processing data could cause unpredictable results.  When a new tmaliDciFrameDepthSet command is send before the previous setting has been activated the new request will overwrite the previous request and the DCI will be commanded to the new value at the first available opportunity.",0
  The DPU-TIS shall report errors to an application program by setting the ERRNO task variable and returning ERROR.,SCU Interface CSCThis CSC performs rate-buffering of the downlink telemetry to the SCU according to a commandable parameter.  The rate at which the SCU polls the DPU is also commandable.  The CSC installs an ISR to collect telecommands from the SCU via the MILSTD1553B Interface.,0
  The DPU-RTOS shall provide a function to allow an application program to write to the Real-Time Clock registers on the RAD6000SC CPU Module.,"Built-In Test CSCThe Built-In Test (BIT) CSC is a Level 2 reuse component from the SSFF and INSTRUMENT Y projects.  The detailed design of the BIT CSC follows. The Built-In Tests CSC, identified DPU-BIT, performs the Stage 2 Built-In Tests (BIT).  The Stage 2 BIT includes a test of the SCM EDAC circuit, a checksum test on SCM PROM, a MIL-STD-1553B internal BIT, and a memory test of the DCI Data Buffers. The results of the BIT are recorded in the SYS_CNFG_AREA in EEPROM and are also maintained in DRAM.  If an error occurs in one of the functions performing the BIT, the test result will be reported as a failure in the test itself.",0
 The DPU-CCM shall provide a command to reboot the DPU.,"ACS Message ProcessingThe SCUI task will send the ACS message to the DPA by calling the function dpaACSReceive().  Because the SCUI task will be calling dpaACSReceive() from an ISR, dpaACSReceive() must return quickly.  If commanded by the ICU in the Mode command, the ACS message will be saved along with the event data product.  To return quickly, dpaACSReceive() will place the ACS message in a data queue then return.  The Event Processor Task will remove the ACS messages from the queue and send them to the spacecraft.",0
Each MODIS standard data product shall be produced within the data volume and processing load allocation shown in Table B-1.,Public FunctionsThis routine is spawned by the Command and Control Task to initialize and execute the DPA Instrument Y Processing Task.,0
  The DPU-BIT shall perform two write/read/compare tests on the RAM for the MIL-STD-1553B.  The first test shall construct and write half-word (16-bit) values obtained by adding the upper and lower half-words of each each memory address.  The second test shall construct and write the ones complement of the half-word values used in the first test.,"Install Project-Specific Module Error IdentifiersIn order to provide a mechanism by which error numbers can be unique across device drivers and applications, each error number must contain a unique module identifier in the most significant word of the error number.  These module identifiers are defined in a VxWorks header file.",0
 The DPU-SCUI shall receive command messages in the form of Telecommand Packets from the SCU and make them available to the DPU-CCM.,"Data Processing Algorithm CSCThe DPA CSC includes the following components:* Event Processor Task  communicates with the ICU, creates event list data products, creates Tracking Instrument Ys in the Ping/Pong buffers, creates the Finding Chart, performs the Engineering Modes, generates housekeeping data, creates the Event Frame, Ping and Pong buffers, and provides a task heartbeat to the CCM task.",0
  The DPU-DPA will complete the exposure in the time specified by the MODE command - even if it's required to truncate the final tracking frame.,"InitializationThe DPU-BIT should be initialized every time the DPU boots.  The startup task, usrRoot() should call bitPart1() before initializing the device drivers and bitPart2() after initializing EDAC and the device drivers.",0
  The DPU-BOOT CSC shall provide a monitor which accepts commands over the RS-232 interface.,"Transmit Message Mode(FIOSSIBGTXMSGENABLE) and Inter-Block Gap interruptsThe SSI Driver CSC supports a message mode to facilitate application level communication.  This mode uses the Inter-Block Gap interrupt generated by the hardware to synchronize message transmission. When in a messaging mode, the driver enables an internal Byte Count queue provides a synchronization mechanism for sending messages.  This Byte Count queue is updated with the message size as Inter-Block Gap interrupts are received. The Transmit Message Mode uses the BGTX interrupt, the Tx FIFO Empty Interrupt, the write() call, and an internal Byte Count queue to synchronize the transmission of messages over SSI.  In this mode, the maxBytes parameter passed to write() is enqueued to the Byte Count queue.  When a period of time equal to or greater than the Interblock Gap time has expired, the BGTX interrupt will be asserted.  At this time, the driver will respond and initiate a new transfer by setting a Byte Transfer Limit for this block and enabling the Tx FIFO Empty Interrupt.  The Byte Transfer Limit corresponds to the entry on the Byte Count queue.  When all bytes in the current block have been sent up to the Byte Transfer Limit, the Tx FIFO ISR will disable itself and reset the Byte Transfer Limit to zero. An application may use this mode by calling write() with a buffer pointer and maxBytes in order to transfer a message of a particular length.",0
  The DPU-BOOT CSC shall create a record of the CPU BIT in the SYSTEM_BLOCK.,"Error RecoveryExcept for the modification described in Sections 5.2.3.6, no further modifications to the existing task error-handling mechanisms are required. VxWorks? uses a global mechanism for returning status codes when errors occur.  This is accomplished  by using the task variable, errno (stored in the task control block).  Most VxWorks? functions return a STATUS value.  This value can either be OK or ERROR.  If a function returns ERROR, then the errno variable must indicate a specific error code.",0
  The DPU-DCI shall read from the DCI Registers in C-bit words only,"Setting Data Timeout in DCIDuring nominal operation, frames arrive approximately every 11 msecs.  The DCI hardware will generate an interrupt if event data has been received in one of the Ping-Pong buffers, and a configurable amount of time has passed during which no additional events have been received.  A data timeout interrupt is not an error, but rather typically indicates that the current exposure has been completed.  The data timeout interrupt allows the TMALI CSC to retrieve the trailing events from the DCI Ping-Pong buffer.  The function tmaliDciTimeoutSet() provides an API to the DCI Driver to allow the timeout setting to be altered.",0
  The DPU-BIT shall test the Error Detection and Correction (EDAC) on the Company X Communication/Memory Module by reading preprogrammed error locations in PROM.,HousekeepingThe TMALI CSC collects housekeeping data that can be retrieved via a call to tmaliHkGet().   TMALI CSC housekeeping is returned via the TMALI_HK data structure.,0
" The DPU-ICUI shall install an ISR to be invoked on the SSI receiver interblock gap interrupt, for the receiving and processing of commands from the ICU.","Public FunctionsWhen no data is available in the TMALI queue this routine blocks on a semaphore awaiting availability of events on the TMALI queue as indicated by the ISR.  When data is already available on the TMALI queue, or the semaphore is taken, the number of events on the TMALI queue is determined and returned to the caller.  The parameter TickstoWait specifies the maximum time which the function can wait until data becomes available in kernel-ticks.  The parameter may be set to a symbolic value FOREVER which causes the function only to return when data is available.  When the function is called with a timeout value and no data becomes avialable within that period the function will return zero (events available).If the tmali task has not been initialized the function returns an error.",0
  The DPU-CCM shall process real-time non-deferred commands within B ms of receipt from the ICU or the SCU.,"Memory Upload and Download HandlingData can be upload to several types of locations, including* DRAM* EEPROM* hardware registers, and* EEPROM filesystem.ial D_MEM_DAT_UPLD command specify the target location.  If the destination is the EEPROM filesystem, a block number is provided in lieu of a memory address , which is used by the DPU FSW to formulate a filename of the form eefs1:DPU_blk.##, where ## is the block number.  In this case, once the entirety of the uploaded data is received by the DPU FSW, the uploaded data is then written to that file in the EEPROM filesystem.  If a file already exists with that name, it is overwritten.  The EEPROM filesystem can be reinitialized using the command D_MEM_DISK_INIT.",0
 The DPU-SCUI shall rate-buffer the delivery of STPDUs to the SCU according to the SCU_BUFFER_RATE parameter provided during initialization.  The default value shall provide data to the SCU at a rate of X Kbps and shall be capable of being modified dynamically.,"Public FunctionsThis routine manually sets the values of the spacecraft time maintained in the DPU hardware, and the UT Delta maintained in a static variable, to the given values.",0
  The DPU-BIT shall report errors that occur during tests as failures in the test results.,"Error RecoveryExcept for the modification described in Sections 5.2.3.6, no further modifications to the existing task error-handling mechanisms are required. VxWorks? uses a global mechanism for returning status codes when errors occur.  This is accomplished  by using the task variable, errno (stored in the task control block).  Most VxWorks? functions return a STATUS value.  This value can either be OK or ERROR.  If a function returns ERROR, then the errno variable must indicate a specific error code.",0
"  The DPU-ICUI shall check the length of a received DPU_CMD against the message length determined by the Inter-Block Gap.  If the received value does not match, then the command will be discarded, and an error will be enqueued to DPU-CCM, and a NAK message transmitted to the ICU within a second.","Checksum Library This function performs a checksum on a specified memory range.  The checksum is performed as an 8-bit additive checksum, but the accumulated value is stored in a 16-bit variable.",0
 The DPU-SCUI  shall be capable of packing created CCSDS Source Packets into STPDUs using segmented (grouped) packets for transfer to the SCU as defined by CCSDS-102.0-B-4 and in accordance with interface control document 1143-EI-S19121.,Watchdog LibraryThis function strobes the system watchdog to prevent a watchdog reset.,0
  The DPU-DCI shall provide an application program with the ability to read and write the hardware ping-pong buffers when in Test Mode.,Shall write Read_packet_log_msgs to Log_messages when errors occur in the Read_MODIS_packet process.  ,0
"The DPU-BOOT CSC shall perform successive writes to a word page of EEPROM within C msecs, or wait a minimum of D usecs between successive writes.",External Program InterfacesReads the BIT results from the location pointed to by pBitResults (which is assumed to be in EEPROM) into the BIT results data structure in DRAM.,0
  The Bootstrap Monitor of the DPU-BOOT CSC shall output an error message to the RS-232 interface if an incorrect number of command arguments are entered.,Public FunctionsThis routine provides a means for the CCM task to send the XRT Position command from the ICU to the DPA software. The XRT Position command shall be used to command the DPU to update the position and window parameters that it uses to spatially filter event data. ,0
The DPU-BOOT CSC shall initialize Error Detection and Correction (EDAC) on the RSC by clearing DRAM.,"Bootstrap CSCThe Bootstrap CSC is a Level 1 reuse component from the SSFF and INSTRUMENT Y projects. The Bootstrap for the Company X DPU will be nearly identical to that used on the INSTRUMENT Y CIDP and SCU, with the exception of minor hardware interface differences:* The interface to the hardware watchdog timer is different on the Company X DPU versus that used on the INSTRUMENT Y CIDP/SCU.* The interface to the mission elapsed time (MET) clock is different on the Company X DPU versus that used on the INSTRUMENT Y CIDP/SCU.* The INSTRUMENT Y bootstrap was able to discern a cold (power-on) boot from a warm (watchdog reset) boot by examining the value of the MET clock, which did not reset to zero on a warm boot.  The Company X DPU MET clock resets to zero on both a cold and warm boot, and so there is no distinction in the Company X bootstrap.",0
  The DPU-CCM shall provide the capability to echo to the spacecraft each received command from the spacecraft or the ICU.,"InitializationThe SCUI CSC is initialized when the scuiTask() is spawned by the CCM CSC.  Initialization parameters which are passed into the scuiTask() include:* Poll Rate  rate at which the S/C will poll the DPU for telemetry.  The rate is specified in Hz, and has a default of X Hz based on the INSTRUMENT X-DPU poll rate in the Company X 1553 ICD.* Buffer Rate  value used to rate buffer data to the S/C.  The rate is specified in bits per telemetry poll, and has a default of 7664 which is equal to one STPDU per poll (*** bytes per STPDU times V bits/byte).  This default value effectively disables rate buffering.* Size of Low Priority Queue  size in bytes of the low priority telemetry queue.  If the amount requested cannot be allocated, the buffer will be allocated at  the amount of memory contained in the largest free memory block.Size of High Priority Queue  size in bytes of the high priority telemetry queue. If the amount requested cannot be allocated, the buffer will be allocated at  the amount of memory contained in the largest free memory block.",0
  The DPU-DCI shall read from the DCI Registers in C-bit words only,"Receiving Commands from the SpacecraftThe DPU/SCU interface specifies that commands for the DPU will be transmitted from the SCU to the DPU on a separate MIL-STD-1553 subaddress.  The SCU Interface Command Reader ISR, scuiCmdReadISR(). consists of an ISR installed on a specific MIL-STD-1553 subaddress corresponding to the command subaddress for the INSTRUMENT X DPU. This ISR is installed at initialization by scuiInit().  Upon interrupt, the scuiCmdReadISR() reads a single telecommand from the 1553 bus, checks the length and checksum, and then forwards valid commands to the Command and Control CSC for dispatch via ccmCmdEnq().  Errors are reported by incrementing an invalid command counter.",0
  The DPU-DCI shall report errors to an application program by setting the ERRNO task variable and returning ERROR.,"remaining DPU FSW tasksFollowing startup, the Command and Control Task spawns the remaining DPU FSW tasks, which are described below:* The Command Dispatch Task (ccmCmdTask) is an Application Framework Software task which is responsible for dispatching commands which arrive from the ICU or the SCU.  Commands are executed directly by this task by calling the applicable CSC function* The SCU Interface Task (scuiDPTask) receives telemetry data from other tasks, converts them to CCSDS Version1 Source Packets, forms Company X Telemetry Protocol Data Units (STPDUs) from the Source Packets, and transmits the STPDUs to the SCU via the MIL-STD-1553B Interface.* The Telescope Module Event Transfer Task (tmaliTask) is an Application Framework Software task which is responsible for transferring data from the DCI ping/pong buffers to the TMALI data buffer in response to a DCI frame limit or data timeout interrupt.* The Data Compression Task (dcxTask) receives telemetry data from other tasks, uses a lossless data compression algorithm to compress the data, and then enqueues the data to the SCU Interface Task.* The Data Processing Algorithms Tasks (dpaIMTask and dpaEPTask) process incoming detector events according to the commanded mode, create data products, and enqueue those data products to the Data Compression Task (if compression is enabled) or to the SCU Interface Task.* The Error Detection and Correction Memory Scrubber Task (edacTask) cycles through the text and data segments of the DPU to trigger the correction of single-bit errors which may have occurred, in order to help prevent the occurrence of uncorrectable multiple-bit errors.",0
"  There DPU-DPA shall have three science modes, X, Y mode, and X/Y mode.","Receiving Commands from the SpacecraftThe DPU/SCU interface specifies that commands for the DPU will be transmitted from the SCU to the DPU on a separate MIL-STD-1553 subaddress.  The SCU Interface Command Reader ISR, scuiCmdReadISR(). consists of an ISR installed on a specific MIL-STD-1553 subaddress corresponding to the command subaddress for the INSTRUMENT X DPU. This ISR is installed at initialization by scuiInit().  Upon interrupt, the scuiCmdReadISR() reads a single telecommand from the 1553 bus, checks the length and checksum, and then forwards valid commands to the Command and Control CSC for dispatch via ccmCmdEnq().  Errors are reported by incrementing an invalid command counter.",0
  The DPU-RTOS shall install an hook routine which is invoked on system exception which shall attempt to record the interrupt vector to the LAST_BOOT_IVEC location in EEPROM prior to reboot.,"Command HandlingWhen a command arrives from the SCU (via the 1553 interface) or the ICU (via the SSI interface), the respective ISR will enqueue the command packet into a Command Queue, and then give the semaphore to awaken the ccmCmdTask().  Since it is possible for the DPU to send a command to itself, commands may arrive at interrupt context or task context.  Therefore the CCM maintains two queues  one for interrupt context which is not semaphore protected, and one for task context which is semaphore protected.",0
"  The DPU-CCM shall monitor the status of DPU-SCUI, DPU-CCM, DPU-DCX, DPU-TMALI, and DPU-DPA by examining their TASK_INFO and report this information in DPU_HK.",Real-Time Clock InterfaceThe Real-Time Clock (RTC) Registers of the RAD6000 are special-purpose registers not normally accessible to C language programs.  Some assembler wrapper functions provide access to these.  ,0
 The DPU-TMALI  shall provide TMALI_HK to the DPU-CCM on request.,"Public FunctionsThis routine is spawned by the Command and Control Task to initialize and execute the SCU Interface Data Processor Task.  This task initializes the SCUI CSC and then enters an infinite loop to process telemetry and produce STPDUs.  Once initialized, the task is awakened by a semaphore given when the SCU writes the telemetry done subaddress.",0
" The DPU-ICUI shall install an ISR to be invoked on the SSI receiver interblock gap interrupt, for the receiving and processing of commands from the ICU.",InitializationThe TIS CSC is initialized by calling the tisInit() function.  The TIS CSC does not have an associated operating system task.  The TIS CSC will initialize the DPU hardware to perform or not perform automatic time synchronization with the spacecraft as indicated by an initialization parameter passed to the tisInit() function.  There are two 1 PPS signals between the DPU and the Spacecraft (a primary and alternate);  the TIS CSC will select the active 1 PPS signal according to the parameter passed to the tisInit() function.,0
  The DPU-ADC shall read from the SCM registers in B-bit words only.,Data Capture Interface Driver CSCThe Data Capture Interface (DCI) Driver CSC is a new driver which provides a standard VxWorks driver interface to the DCI hardware.  The driver features two modes: a test mode and a normal mode.,0
  The DPU-RTOS shall include the capability to dynamically load object modules from the EEPROM.,"InitializationThe DCX CSC is initialized when the dcxTask() is spawned by the CCM CSC.  During initialization, the DCX CSC creates a compression queue to contain data packages which are pending compression.  Access to the compression queue is protected by a mutual exclusion semaphore.  The size of the compression queue is controlled by an initialization parameters which is passed into the dcxTask().  If the amount of memory requested cannot be allocated, initialization of the DCX CSC will fail.",0
  The DPU-RTOS shall provide a function to allow an application program to write to the Real-Time Clock registers on the RAD6000SC CPU Module.,"Data ProcessingThe DCX CSC is a task which receives data packages from other tasks, compresses the data using the VBTWL algorithm, and then forwards the compressed data package to the SCUI CSC.",0
"  The DPU-DCI shall provide the capability for an application program to set a timeout in milliseconds that specifies a period during which no new events have been received by the hardware, after which the hardware will swap ping-pong buffers and interrupt the software.",Data Capture Interface Driver CSCThe Data Capture Interface (DCI) Driver CSC is a new driver which provides a standard VxWorks driver interface to the DCI hardware.  The driver features two modes: a test mode and a normal mode.,0
 The DPU-TMALI  shall provide TMALI_HK to the DPU-CCM on request.,Public FunctionsThis routine is spawned by the Command and Control Task to initialize and execute the DPA Instrument Y Processing Task.,0
  The DPU-TIS shall provide the capability for an application program to select the active 1PPS signal.,"Exclude Failed DRAMThe Bootstrap performs a memory test before loading the operating system.  The results of this test are stored in the EEPROM.  The DPU-RTOS uses the results of the memory test to exclude memory segments with bit errors from the system memory pool. The Bootstrap constructs a bit map which effectively implements a list of failed memory blocks during the bootstrap built-in test.  A set of functions have been created to utilize this  bit map to exclude failed memory blocks from the VxWorks system memory pool.  The system memory pool is used by VxWorks to allocate memory dynamically.  In addition, a linked list of good memory segments is created for use by the EDAC Memory Scrubber.  These functions are called from the usrInit() and usrRoot() functions in usrConfig.c.  The dramInit() function must be called prior to kernelInit() in usrInit().  The dramBuildMemPool() function is called just prior to initialization of filesystems and drivers in usrRoot().",0
The image mode shall shift successive frames according to the calculated spacecraft drift and co-add the frame into an accumulated image.,"Command HandlingThe DPU accepts commands via two interfaces  from the Spacecraft via the MIL-STD-1553 interface, and from the ICU via the SSI interface.  Any of the DPU commands can be sent from the SCU or the ICU.  The source for a command from the DPU is one of the following:* ICU  command is generated and sent by the ICU via the SSI.* SCU  command is generated and sent by the SCU via the 1553.* G-ICU  command is generated on the ground and sent to the DPU via the ICU/SSI.* G-SCU  command is generated on the ground and sent to the DPU via the SCU/1553.",0
Each MODIS Standard Product shall contain ECS core metadata with the content and format specified in DID 311.,"Time Interface ConfigurationThe TIS CSC utilizes the manual jam bit in the DCI CSR to indicate whether automatic time synchronization is enabled or disabled.  If automatic time synchronization is enabled, and a command is issued to manually jam the DPU clock, the command will be rejected - see tisTimeSet().",0
  The DPU-SSI shall read from the SSI registers in 16-bit words only.,"Time SynchronizationThe time contained in the Clock Message is specified to be valid on the rising edge of the next 1PPS signal.  When the DPU receives the Clock Message, the 1553 ISR calls the tisTimeSync() function, forwarding the data portion of the clock message to the TIS CSC via the TIS_CLK_MSG data structure..  The tisTimeSync() function will immediately copy the spacecraft clock value to the DPU clock hardware registers. The DPU hardware is designed to latch in the new time on the rising edge of the next 1 PPS signal (the act of writing a new time to the hardware registers arms the latch function in the hardware).  Once the new time is latched, the hardware automatically disables the time latch function to avoid the potential of latching in an old time at the next 1 PPS signal.will be received within one second.  In the unlikely event a UT Delta is discarded, an event message is enqueued to ccmErrEnq() for informational purposes.",0
"  The Intensifier Characteristics Engineering mode shall produce a pulse-height histogram, PROD_INTENSE_CHAR.","Data ProcessingData requiring compression is received via the dcxEnq() function, which has an API definition which matches the scuiEnq() API.  The DCX CSC handles the PKG_CTRL flags as described below:* PKG_COMPRESS  this flag is set to indicate if the package is actually compressed.* PKG_PRIORITY_HIGH  this flag is ignored by the DCX CSC but is forwarded to the SCUI CSC.* PKG_SEGMENT  this flag is ignored by the DCX CSC but is forwarded to the SCUI CSC.PKG_CHECKSUM  if set, the dcxEnq() function will compute a checksum which is appended to the data, and then the flag is negated.  The checksum will be compressed with the rest of the data, so that when the data is decompressed on the ground, the checksum can be recomputed and compared to provide a good indication of whether the decompressed copy of the data matches the original data set.",0
  The DPU-ICUI shall receive real-time DPU_CMDs from the ICU via SSI and forward them to DPU-CCM.,"Error Collection and ReportingAt boot time, no error queue exists because it has yet to be created.  Errors that occur in this early stage of error reporting are assigned directly to the global task variable errno.  The reader may refer to the VxWorks Programmers Guide, section 2.3.7 for more information on errno.  If errno is set after the error queues are created, it is queued to the Error Queue by calling ccmErrEnq(). ",0
  The DPU-TIS shall provide the capability for application programs to access the SC_TIME from the SCM.,"Public FunctionsThis routine is used to format messages for transmission to the ICU and to place those messages on the SSI Driver Transmitter Queue. The functionCode parameter is used to create the CCSDS Packet APID and the Message Identifier (refer to document DPUICD-01).  A mutual exclusion semaphore, icuiSemWrite, protects the SSI Driver from being written by multiple tasks simultaneously.  The timeout parameter lets the caller control how long it is willing to block on this semaphore if there is an access conflict.This routine may be called at interrupt context to transmit an ACK/NAK message.  In that case, the semaphore is not taken since it is not valid to take a semaphore at interrupt context.  Refer to discussion of the design to accommodate the ACK/NAK message.",0
The DPU-BOOT CSC shall disable write-protection of the EEPROM on the SCM.,"Channel Boundary (CB) Engineering ModeThe purpose of Channel Boundary Mode is to derive the optimum channel boundary settings from a flat field. Detector events produced in the M,N detector mode are collected and histogrammed for a commanded integration time.  The pseudo Instrument Y is transmitted to the ground.  Channel boundaries are derived from the Instrument Y and transmitted to the ICU and the ground.  Channel boundaries are sent by the ICU to the BPE and used in the detector event centroiding process.",0
Each MODIS standard product shall contain the MODIS product file name for all input product files as ECS archive metadata.,"Data ProcessingWhen the DCX CSC compresses a data package, the given APID is incremented by one.  If the compressed copy of data is larger than original data set, the original data set will be forwarded to the SCUI CSC, an event S_dcx_UNC_USED is enqueued to ccmErrEnq(), and the APID is not incremented.  In this way, the ground systems can discern compressed packets from non-compressed packets.",0
"A MODIS Computer Software Configuration Item (CSCI) is any independently tracked and configured unit of software within the MODIS SDP S/W, including processes, scripts, and utility libraries.  Each CSCI in the MODIS SDP S/W shall run in the ECS production environment.","Memory Upload and Download HandlingIf more than 65535 bytes need to be uploaded, the upload file must be broken up into multiple smaller files, each less than or equal to 65535 bytes, and then each of the virtual uploads should be sent in series.  Because of the sequence numbers, the DPU FSW can receive individual upload commands out of sequence.  There is no time limit for the accomplishment of a single virtual upload, and so a long upload can continue across ground contacts.  If an upload is in progress, the last sequence number can be sent to the DPU FSW and it will report the list of missing sequence numbers via event number S_ccm_MISSING_SEQNO.  If an upload is in progress and needs to be cancelled, it can be discarded by issuing the D_MEM_DAT_CNCL command.",0
  Tthe DPU-CCM shall create DPU_HK_START and forward it to DPU-SCUI at bootup.,"Transmitting Telemetry to the SpacecraftThe SCUI CSC receives telemetry as input Data Packages via queues populated by other tasksthe Science Data Processing Task, the Data Compression Task, and the Command and Control Task.  The SCUI CSC has a High Priority Queue and a Low Priority Queue.  The two queues are implemented in an identical manner with the exception that the scuiTask() gives processing preference to the High Priority Queue.  The purpose of the High Priority Queue is to provide a means by which the Parameterized Finding Chart and DPU housekeeping can be transmitted to the SCU ahead of the potentially large amounts of buffered science data.",0
"  The DPU-ICUI shall format messages according to DPUICD-01, Section 3.1",Shall write Verify_CCSDS_log_msgs to Log_messages when errors occur in the Verify_CCSDS_header_info process.  ,0
  The DPU-DPA will obtain the initial tracking frame time from the ICU.,Synchronous Serial Interface Driver CSCThe Synchronous Serial Interface (SSI) Driver CSC is a new driver which provides an application layer interface to the SSI hardware.  The SSI Driver CSC is implemented on top of the VxWorks tyLib library to manage its ring buffers.   The driver features a standard I/O interface which utilizes an extended ioctl() command set to support unique SSI hardware attributes.  This driver is patterned after the older VxWorks 5.2 serial driver architecture rather than the newer Tornado serial driver architecture due to the lack of programmer control over I/O in the newer Tornado driver architecture. ,0
  The DPU-BOOT CSC shall create a record of the CPU BIT in the SYSTEM_BLOCK.,"InitializationThe driver is initialized by invoking the initialization function adcInit().  The function initializes the ADC_LIST_ENTRY array, sets up convenience pointers to the ADC hardware registers, and sets up the ADC multiplexer for the first conversion (otherwise the very first ADC value requires three calls to adcUpdateNext()).  The ADC Driver can be re-initialized, which will result in the values in the ADC_LIST_ENTRY array being reset to their default values.The ADC_VALUEs are A-bit data items; however the hardware contains a B-bit A/D.  The upper bits are used to indicate invalid or suspect values as follows:* At initialization, the MSbit of each of the ADC_VALUEs is set (0x8000).* If a conversion fails (i.e. the driver reads the analog value and determines that the conversion has not yet completed), the second MSbit.",0
Each Software process shall handle input data sets with the following error attributes: Corrupted data as indicated by Quality Assurance (QA) flags also located within the file.,Shall write Verify_CCSDS_log_msgs to Log_messages when errors occur in the Verify_CCSDS_header_info process.  ,0
 The DPU-SCUI shall communicate with the SCU according to the protocol defined in document 1143-EI-S19121.,"Shall create ECS_standard_global_metadata and MODISL1A_specific_global_metadata for each completed Level1A_data product, using Level0_open_metadata and selected metadata contained in MODIS_scan.  ",0
  The DPU-TIS shall provide the capability for application programs to access the SC_TIME from the SCM.,"Time Interface ConfigurationThe TIS CSC utilizes the manual jam bit in the DCI CSR to indicate whether automatic time synchronization is enabled or disabled.  If automatic time synchronization is enabled, and a command is issued to manually jam the DPU clock, the command will be rejected - see tisTimeSet().",0
 The DPU-SCUI shall report errors to the DPU-CCM for inclusion in the DPU Housekeeping information.,Install Exception Handlersa default interrupt handler and is installed into element five (5) of the system interrupt table.,0
 The DPU-SCUI  shall be capable of packing created CCSDS Source Packets into STPDUs using segmented (grouped) packets for transfer to the SCU as defined by CCSDS-102.0-B-4 and in accordance with interface control document 1143-EI-S19121.,Real-Time Clock InterfaceThe Real-Time Clock (RTC) Registers of the RAD6000 are special-purpose registers not normally accessible to C language programs.  Some assembler wrapper functions provide access to these.  ,0
The image mode shall shift successive frames according to the calculated spacecraft drift and co-add the frame into an accumulated image.,"Instrument Y ProcessingThe Instrument Y Processor Task will perform tracking by breaking the exposure up into 10-second sub-exposures which are shifted and added into a final histogrammed Instrument Y.  Tracking is performed by choosing guide stars from the first 10-second Instrument Y of an exposure.  Then in each subsequent Instrument Y, these guide stars are found and the drift is determined by comparing the two Instrument Ys. The Instrument Y is then shifted by the determined drift and added to the previous Instrument Ys in the accumulation buffer.",0
  The DPU-BOOT CSC shall initialize the BIT_DATA in the SYSTEM_BLOCK to the incomplete/failure state prior to executing Stage 1 BIT.,"CPU BITThe CPU BIT consists of a series of tests designed to test each of the functional units of the processor.  These include test for the Branch-Unit, the Fixed-Point Unit, the Floating-Point Unit, the Interrupt-Unit, and the Timer Unit.   Each of these tests consists of executing a few selected instructions from the this functional unit. The General Purpose Registers (GPR), the Segment Registers (SR), the Counter Register (CTR), and the Condition Register are tested for stuck-bits as part of the Branch-Unit test.  This is done by writing a 1s pattern (verified by reading it back) and then writing a 0s pattern (verified by reading it back).",0
" The DPU-DPA shall produce a Parameterized Finding Chart, PROD_FINDING_CHART, that is so many bytes.","Public FunctionsInitializes the TIS CSC by initializing the hardware register convenience pointers and selecting the commanded 1PPS signal, and enables or disables automatic time synchronization with the S/C according to the passed parameter. THIS FUNCTION ALTERS THE VALUE OF THE DCI CSR AND SHOULD NOT BE INVOKED WHEN DCI INTERRUPTS ARE ACTIVE.",0
"  At the end of a download, the Bootstrap Monitor of the DPU-BOOT CSC shall compute a CHKS_32 on the X stored in EEPROM and compare it against the CHKS_32 sent with the X during the transfer.  The Bootstrap Monitor shall output to to the RS-232 interface both CHKS_32s and a message indicating whether the download was successful.","Public FunctionsSets the poll rate and buffer rate to the given values.  If the values are out of range, the prior values are retained and an error is reported.  The scuiTask() semaphore timeout (scuiTaskTimeout) is automatically adjusted based on the given poll rate, by setting the timeout to approximately  the poll rate (not that the timeout is expressed in clock ticks, and so the resolution is low and only approximates  of the poll rate).",0
 The DPU-CCM shall use DPU-ICUI to communicate with the ICU.,"Public FunctionsThis routine manually sets the values of the spacecraft time maintained in the DPU hardware, and the UT Delta maintained in a static variable, to the given values.",0
 The DPU-SCUI shall time stamp the secondary header of the Source Packets with the current SC_TIME retrieved from the DPU-TIS module.,SCU Interface CSCThis CSC performs rate-buffering of the downlink telemetry to the SCU according to a commandable parameter.  The rate at which the SCU polls the DPU is also commandable.  The CSC installs an ISR to collect telecommands from the SCU via the MILSTD1553B Interface.,0
 The DPU-TMALI shall allocate a ring buffer of size specified by TMALI_BUFFER_SIZE provided during initialization for storing incoming frames of data.  The default buffer size shall be 15 MB.,Setting DCI Bit ArrangementThe bit arrangement of the DCI control/status register can be set via tmaliBitArrangementSet().,0
Each software process shall trap and properly process all exceptions that may produce an abnormal terminationand report all such events using the SDPTK error message functions.,"DRAM BITPart of the memory is tested in Boot Sequence 1, and part of the memory is tested during Boot Sequence 2.  During Boot Sequence 1, ? KB of DRAM is tested before the Bootstrap is copied to this area.  During Boot Sequence 2, the  remaining memory is tested in ? KB blocks. The DRAM BIT first writes the address of each word in a block to that word in the block.   Then the test flushes the cache and reads back the entire block.  If a single-bit error occurs on the read-back, the location is read again.  If another single-bit error occurs, the test assumes a hard error and marks the whole block bad.  If a multiple-bit error occurs, the whole block is marked bad.  If the value read back does not match the address, the whole block is marked bad.  This same process is repeated with the ones complement of the address. The Bootstrap stores the results of the DRAM BIT in EEPROM as a series of x consecutive y-bit words.  Each bit in a result word represents the result of testing a ? KB block of DRAM.  These bits are mapped to DRAM by proceeding from least-significant bit (LSb) to most-significant bit (MSb) as the addresses of the memory blocks increase.  A set bit indicates that a block of DRAM has failed.  A clear bit indicates that a block of DRAM has passed the test.",0
"  The DPU-BOOT CSC shall create a record of failed DRAM blocks, BIT_DRAM, in the SYSTEM_BLOCK.","Public FunctionsThis routine is used to format messages for transmission to the ICU and to place those messages on the SSI Driver Transmitter Queue. The functionCode parameter is used to create the CCSDS Packet APID and the Message Identifier (refer to document DPUICD-01).  A mutual exclusion semaphore, icuiSemWrite, protects the SSI Driver from being written by multiple tasks simultaneously.  The timeout parameter lets the caller control how long it is willing to block on this semaphore if there is an access conflict.This routine may be called at interrupt context to transmit an ACK/NAK message.  In that case, the semaphore is not taken since it is not valid to take a semaphore at interrupt context.  Refer to discussion of the design to accommodate the ACK/NAK message.",0
  The DPU-BOOT CSC shall put the processor into diagnostic mode.,InitializationThe DPA CSC is initialized by spawning the tasks dpaEventTask() and dpaInstrument YTask().  After the tasks are spawned they create the needed memory buffers.  The dpaEventTask() then enters the Idle state waiting for a Mode command from the ICU.  The dpaInstrument YTask also enters the Idle state waiting to process either the Ping or Pong buffer.  The default setting for compression (on or off) is retrieved from EEPROM.,0
The image mode shall shift successive frames according to the calculated spacecraft drift and co-add the frame into an accumulated image.,"Public FunctionsThis routine gets housekeeping data stored for the TMALI CSC including some DCI parameters and resets the tmali internal counters to zero.  When the caller supplied pointer to a TMALI_HK structure is NIL no data is returned but the tmali internal counters are still reset to zero.Two of the four error counters are updated within an ISR context, this requires a task switch safe implementation of these counters.  Within VxWorks this could be solved using a counting semaphore.  In the TMALI CSC design a faster method was used by using a free running error counter and a careful update of the reported number of errors, using an extra temporary variable.  As the increment and assignment of the 32 bit unsigned integers themselves are atomic operations the resulting counters are task safe and no error events are lost.  This means that the sum of the errors reported by the tmaliHkGet() function is equal to the total numbers of errors that occurred, no error reports are lost due to the update of the internal structures.",0
  The centroid confirmation engineering mode shall produce a PROD_CENTROID_CONF.  This mode shall divide a full frame image into a certain regions.  Each region shall be processed to form an 8x8 confirmation image.  The certain confirmation images shall be sent to the solid state recorder as one data product.,"Instrument Y ProcessingAt the end of an exposure, the Instrument Y in the accumulation buffer is transferred to the Instrument Y data product buffer one horizontal line at a time, starting at the top of the Instrument Y to form a PROD_INSTRUMENT Y data product.  This rasterized Instrument Y in the Instrument Y data product buffer will be enqueued for transmission to the spacecraft.",0
 The DPU-SCUI shall rate-buffer the delivery of STPDUs to the SCU according to the SCU_BUFFER_RATE parameter provided during initialization.  The default value shall provide data to the SCU at a rate of X Kbps and shall be capable of being modified dynamically.,"Instrument Y ProcessingAt the end of an exposure, the Instrument Y in the accumulation buffer is transferred to the Instrument Y data product buffer one horizontal line at a time, starting at the top of the Instrument Y to form a PROD_INSTRUMENT Y data product.  This rasterized Instrument Y in the Instrument Y data product buffer will be enqueued for transmission to the spacecraft.",0
  The DPU-SSI shall provide the capability for an application to determine the number of bytes in a message received from the ICU.,Raw Event List (RE) Engineering ModeThe purpose of Raw Event List Engineering Mode is to diagnose problems with the detector. Detector events produced in a given detector mode are collected over a commanded integration time and transmitted to the ground as a list of raw events.,0
  The DPU-RTOS shall include the capability to dynamically load object modules from the EEPROM.,"Telemetry Output to the Spacecraft 1553 BusThe SCU, which is a MIL-STD-1553 Bus Controller (BC), periodically reads the STPDU contained in the fifteen telemetry subaddresses, and then writes to the telemetry done subaddress.  When the telemetry done subaddress is written, the scuiTlmDoneISR() is called which gives a semaphore to awaken the scuiTask().  The software provides fault tolerance by automatically awaking after approximately two polling periods.  This timeout is automatically adjusted any time the SCU Poll Rate value is changed by command.",0
  The DPU-DCI shall provide the capability for an application program to reset the DCI by writing to the DCI Reset Register.,"Event ProcessingIf the Mode command is Instrument Y Mode, the detector events are spatially filtered to the Instrument Y window specified in the Mode command then the corresponding pixel in the Ping or Pong buffer is incremented.  If specified in the Mode command, pixels will be binned at AxA or BxB.  Also, if specified in the Mode command, a tracking frame data product will be produced for every Ping/Pong tracking frame. Instrument Y and Event Mode may be commanded simultaneously in the Mode command. If the ICU sends an XRT Position command, the Instrument Y mode and Event Mode windows will be resized to match the new window sizes in the command.",0
  The DPU-CCM shall forward ACS_MSGs to the DPU-DPA for processing immediately upon receipt (I.e. shall not enqueue the message to the command dispatcher queue).,Public FunctionsThis routine provides a means for the CCM task to send a Mode command from the ICU to the DPA software. The Mode command shall be used to command the DPU into a particular science or engineering event processing mode.  The mode shall become effective after the DPU has sent the Mode Ready message to the ICU.,0
  The DPU-BOOT CSC shall attempt to complete its normal execution sequence following detection of any failure.,The L1A/Geolocation software shall use all applicable mandatory SDPTK 5.2 routines and any additional SDPTK routines that are useful.  ,0
  The centroid confirmation engineering mode shall produce a PROD_CENTROID_CONF.  This mode shall divide a full frame image into a certain regions.  Each region shall be processed to form an 8x8 confirmation image.  The certain confirmation images shall be sent to the solid state recorder as one data product.,Telescope Module Access Library and Interface CSCThe Telescope Module Access Library and Interface (TMALI) CSC manages the detector event queue and provides an API for the retrieval of detector events from that queue to the data processing algorithms.,0
  The DPU-CCM shall collect DPU_HK and forward it to the DPU-SCUI.,"Public FunctionsThis routine provides a means to get the current data timeout value used by the DCI.  The returned value is the current timeout in milliseconds.The timeout is discussed in document 036911400, section 4.3.2.4.1.3.",0
"  The DPU-RTOS shall be a real-time, multi-tasking operating system.","Event ProcessingThe Event Processor Task, after receiving a Mode command from the ICU, configures the DPU DCI hardware, responds to the ICU with a Mode Ready message then receives detector events by calling functions tmaliWait() and tmaliNextEvent().  The Event Processor Task will collect detector events for the time period specified in the Mode command then issue a Mode Complete message to the ICU.  After issuing the Mode Complete message, the Event Processor Task will enter the Idle state.",0
"  When commanded to event mode by the ICU,  the DPU-DPA shall be capable of collecting time-tagged photon events and producing a PROD_EVENT.","Control and Monitoringthe CCM Control Task also handles memory dump commands.  In the event of a data dump command, the CCM Control Task will break the dump into manageable pieces and dump a small portion at a time, each time the task is awakened.  The purpose of this deferred activity is to prevent a large dump from consuming available CPU time by keeping the high-priority CCM Command Dispatch Task busy for an extended period.",0
  The DPU-DPA will complete the exposure in the time specified by the MODE command - even if it's required to truncate the final tracking frame.,"Hardware InterfacesThe DPU-BOOTSTRAP must interface directly with the EEPROM on the Company X Communication Module.  The DPU-BOOTSTRAP accesses EEPROM as ?-bit words only.  The specific timing requirements of the EEPROM are satisfied in one of three ways:* the timing requirements are met by inserting specific wait loops (typical),* the timing requirements are met by use of the EEPROM Driver (DOWNLOAD command), andthe timing requirements are met implicitly by the amount of time which will be required to execute the intervening instructions regardless of the CPU speed setting (DRAM test logic).",0
 The DPU-SCUI shall communicate with the SCU according to the protocol defined in document 1143-EI-S19121.,"Centroiding Confirmation (CC) Engineering ModeThe purpose of Centroiding Confirmation Engineering Mode is to determine the validity of derived channel boundaries. Detector events are collected and histogrammed for a commanded integration time.  The full field is divided into 8x8 sub-Instrument Ys, each of ExEcentroided (by 8) pixels.  These sub-Instrument Ys are then modulo binned to produce a set of 8x8 pixels pseudo-Instrument Ys.  The Instrument Ys are column (y axis) ordered, as are the pixels within them.  These pseudo Instrument Ys are transmitted to the ground.",0
"  The DPU-CCM shall produce DPU_HK at a commandable rate, with a default of 10 seconds.",InitializationThe DPA CSC is initialized by spawning the tasks dpaEventTask() and dpaInstrument YTask().  After the tasks are spawned they create the needed memory buffers.  The dpaEventTask() then enters the Idle state waiting for a Mode command from the ICU.  The dpaInstrument YTask also enters the Idle state waiting to process either the Ping or Pong buffer.  The default setting for compression (on or off) is retrieved from EEPROM.,0
"  The DPU-CCM shall be able to count a consecutively reported error.  When the the count for a particular error ID, exceeds 250 for a particular reporting period, the error code will be replaced with a error code sequence which shall include the original error code and the number of times the error was reported.  ",Shall issue Program_stop if MODIS_packets cannot be read from Level0_data file.  ,0
  The DPU-ADC shall create a fixed analog conversion scan list containing the A DPU analog values (active values plus one ground reference value).,Public FunctionsThis routine provides a means for the CCM task to send a Mode command from the ICU to the DPA software. The Mode command shall be used to command the DPU into a particular science or engineering event processing mode.  The mode shall become effective after the DPU has sent the Mode Ready message to the ICU.,0
The image mode shall shift successive frames according to the calculated spacecraft drift and co-add the frame into an accumulated image.,The L1A/Geolocation software shall use all applicable mandatory SDPTK 5.2 routines and any additional SDPTK routines that are useful.  ,0
"  The DPU-DCI shall read from the DCI Memory in B-bit words only, using the load multiple/store multiple instructions.","Error Collection and ReportingThe ccmErrEnq() function tracks the last error reported and its frequency of occurrence.  Once an error code has been reported it becomes the previously reported error code maintained by ccmErrEnq().  A repetition count is then incremented for each subsequent, consecutively reported, identical instance of this previously reported error.  If this error code is reported more than once in one high-rate housekeeping reporting period, then a special error, S_ccm_ERR_REPEAT is enqueued with the repetition count for the error encoded in the least significant byte. This mechanism effectively reduces the potential for housekeeping telemetry to become flooded with a single repeated error.",0
"  On boot, the DPU-CCM shall toggle the BC_INDEX if the boot is successful.  A boot is successful if command and telemetry communications have been established with the spacecraft.","Transmitting Telemetry to the SpacecraftThe SCUI CSC receives telemetry as input Data Packages via queues populated by other tasksthe Science Data Processing Task, the Data Compression Task, and the Command and Control Task.  The SCUI CSC has a High Priority Queue and a Low Priority Queue.  The two queues are implemented in an identical manner with the exception that the scuiTask() gives processing preference to the High Priority Queue.  The purpose of the High Priority Queue is to provide a means by which the Parameterized Finding Chart and DPU housekeeping can be transmitted to the SCU ahead of the potentially large amounts of buffered science data.",0
  The DPU-DPA shall calculate drift with respect to the reference frame based on the established guide stars then perform a shift-and-add of the image mode data.,"Centroiding Confirmation (CC) Engineering ModeThe purpose of Centroiding Confirmation Engineering Mode is to determine the validity of derived channel boundaries. Detector events are collected and histogrammed for a commanded integration time.  The full field is divided into 8x8 sub-Instrument Ys, each of ExEcentroided (by 8) pixels.  These sub-Instrument Ys are then modulo binned to produce a set of 8x8 pixels pseudo-Instrument Ys.  The Instrument Ys are column (y axis) ordered, as are the pixels within them.  These pseudo Instrument Ys are transmitted to the ground.",0
"  The DPU-DCI shall read from the DCI Memory in B-bit words only, using the load multiple/store multiple instructions.","InitializationThe SCUI CSC is initialized when the scuiTask() is spawned by the CCM CSC.  Initialization parameters which are passed into the scuiTask() include:* Poll Rate  rate at which the S/C will poll the DPU for telemetry.  The rate is specified in Hz, and has a default of X Hz based on the INSTRUMENT X-DPU poll rate in the Company X 1553 ICD.* Buffer Rate  value used to rate buffer data to the S/C.  The rate is specified in bits per telemetry poll, and has a default of 7664 which is equal to one STPDU per poll (*** bytes per STPDU times V bits/byte).  This default value effectively disables rate buffering.* Size of Low Priority Queue  size in bytes of the low priority telemetry queue.  If the amount requested cannot be allocated, the buffer will be allocated at  the amount of memory contained in the largest free memory block.Size of High Priority Queue  size in bytes of the high priority telemetry queue. If the amount requested cannot be allocated, the buffer will be allocated at  the amount of memory contained in the largest free memory block.",0
 The DPU-TMALI  shall provide TMALI_HK to the DPU-CCM on request.,Public FunctionsThis routine provides a means for the CCM task to get the housekeeping info from the DPA software.  The CCM task will call this function and pass a pointer to the location that DPA is to store its housekeeping. ,0
  The DPU-SSI shall provide the capability for an application program to set the Inter-Block Gap (IBG) Timeout for transmitted and received messages.,"Control and Monitoringthe CCM Control Task initializes the DPU FSW. It is the responsibility of the CCM Control Task to establish a successful boot.  It does so by blocking on temporary semaphores, each with a 5 second timeout, after spawning the SCU Interface Task and the CCM Command Task.  If both of these tasks report a successful initialization by giving the semaphore, the CCM Control Task toggles the BC_INDEX parameter in EEPROM to indicate a successful boot.  If either task does not report a successful initialization, the CCM Control Task disables the watchdog strobe to effect a reboot of the DPU.  The rationale for selecting the successful initialization of these two tasks as the definition of a successful boot is that the DPU FSW requires these tasks, as a minimum, to establish ground contact and provide commandability.Once this initialization is complete, the task blocks on a binary semaphore which is given by the SCUI Command ISR upon arrival of the 1 Hz Clock Message.  In the event a Clock Message does not arrive, the semaphore will time out after 1.5 seconds.  The CCM Control Task remains alive to create and transmit DPU housekeeping at the appropriate intervals, perform various periodic processing tasks, and to process memory dump commands.The final call to ccmErrEnq() is performed in order that if an error occurs in an interrupt service routine, a global variable is set to the value of the errno which is then enqueued into the Error/Event Queue as part of this tasks normal processing.",0
Each software process shall trap and properly process all exceptions that may produce an abnormal terminationand report all such events using the SDPTK error message functions.,Checksum LibraryThis function performs a checksum on a specified memory range.  The checksum is performed as an bit XOR.,0
  The Bootstrap Monitor of the DPU-BOOT CSC shall provide the capability to download configurations of the DPU-RTOS from the RS-232 interface to EEPROM on command.,SCU Interface CSCThe SCU Interface (SCUI) CSC is a Level 3 reuse component from the INSTRUMENT Y project.  The SCUI CSC is primarily responsible for implementing the application protocol with the SCU. The SCUI CSC provides CCSDS packetization services and manages the interface between the DPU and the SCU.,0
  The DPU-SSI shall read from the SSI registers in 16-bit words only.,"Built-In TestThere are two stages of Built-In Tests (BIT) for the DPU.  The Stage 1 BIT is included in the Bootstrap program and consists of Central Processing Unit (CPU) BIT, and Dynamic Random Access Memory (DRAM) BIT.  The Stage 2 BIT is executed after the operating system is booted and is not part of the Bootstrap program.",0
" The DPU-TMALI shall utilize SCM_DCI_SR, along with ERRNO provided by DPU-DCI to decode errors and place them on an error queue for DPU-CCM.",Telescope Module Access Library and Interface CSCThe Telescope Module Access Library and Interface (TMALI) CSC manages the detector event queue and provides an API for the retrieval of detector events from that queue to the data processing algorithms.,0
The DPU-BOOT CSC shall initialize Error Detection and Correction (EDAC) on the RSC by clearing DRAM.,Watchdog LibraryThis function strobes the system watchdog to prevent a watchdog reset.,0
 The DPU-CCM shall provide a mechanism for other CSCs to report errors for inclusion in the DPU_HK.,"Install Exception Handlers The RSC processor also generates an external interrupt for the Power Fail Interrupt.  The RSCVME Board Support Package of VxWorks? does not directly support access to this interrupt.  Some custom routines must be provided to access this interrupt. These functions are described below, and are contained in sysLibSup.c.",0
  The DPU-DPA shall provide a task heartbeat to DPU-CCM.,"Standard I/O InterfaceThe read() primitive does not block.  A read is performed on the active portion of the H/W ping pong buffer using the RAD 6000 move-multiple instruction, referred to here after as a block move.  For optimum performance, the block move is implemented in assembler.  The number of bytes read is returned to the caller.",0
Each software process shall trap and properly process all exceptions that may produce an abnormal terminationand report all such events using the SDPTK error message functions.,"Data Processing Algorithm CSCThe DPA CSC includes the following components:* Event Processor Task  communicates with the ICU, creates event list data products, creates Tracking Instrument Ys in the Ping/Pong buffers, creates the Finding Chart, performs the Engineering Modes, generates housekeeping data, creates the Event Frame, Ping and Pong buffers, and provides a task heartbeat to the CCM task.",0
 The DPU-TMALI shall install a callback routine to respond to the DCI Error Interrupt.,"ACS Message ProcessingThe SCUI task will send the ACS message to the DPA by calling the function dpaACSReceive().  Because the SCUI task will be calling dpaACSReceive() from an ISR, dpaACSReceive() must return quickly.  If commanded by the ICU in the Mode command, the ACS message will be saved along with the event data product.  To return quickly, dpaACSReceive() will place the ACS message in a data queue then return.  The Event Processor Task will remove the ACS messages from the queue and send them to the spacecraft.",0
  The DPU-BIT shall perform MIL-STD-1553B internal BIT.,"InitializationThe TMALI CSC is initialized by spawning the tmaliTask() with the startup default parameters.  This task will allocate memory for the TMALI_EVENT_QUEUE, install DCI ISRs, initialize static variables and data structures, and then enter an end-less loop in which it transfers the data from the DCI to the TMALI queue, throttled by the semaphore semDciWait.",0
"  The DPU-RTOS shall exclude failed DRAM from the system memory pool based on the contents of the BIT_DRAM results in the SYSTEM_BLOCK.  The system memory table does not include the Interrupt Vector Table (IVT), nor the text and data segment.",Standard I/O InterfaceSSI ioctl() commands.,0
  The DPU-DCI shall provide the capability for an application program to reset the DCI by writing to the DCI Reset Register.,Shall generate data_input_status_messages if errors are encountered in reading Level_2_Data. ,0
" There shall be four engineering modes associated with the detector: raw event list mode, channel boundary mode, centroid confirmation mode, and intensifier characteristics mode.","InitializationThe SCUI CSC is initialized when the scuiTask() is spawned by the CCM CSC.  Initialization parameters which are passed into the scuiTask() include:* Poll Rate  rate at which the S/C will poll the DPU for telemetry.  The rate is specified in Hz, and has a default of X Hz based on the INSTRUMENT X-DPU poll rate in the Company X 1553 ICD.* Buffer Rate  value used to rate buffer data to the S/C.  The rate is specified in bits per telemetry poll, and has a default of 7664 which is equal to one STPDU per poll (*** bytes per STPDU times V bits/byte).  This default value effectively disables rate buffering.* Size of Low Priority Queue  size in bytes of the low priority telemetry queue.  If the amount requested cannot be allocated, the buffer will be allocated at  the amount of memory contained in the largest free memory block.Size of High Priority Queue  size in bytes of the high priority telemetry queue. If the amount requested cannot be allocated, the buffer will be allocated at  the amount of memory contained in the largest free memory block.",0
Each Software process shall handle input data sets with the following error attributes: Wrong format input files.,"Checksum Library This function performs a checksum on a specified memory range.  The checksum is performed as an 8-bit additive checksum, but the accumulated value is stored in a 16-bit variable.",0
  The DPU-TIS shall provide the capability for an application program to select the active 1PPS signal.,"Control and Monitoringthe CCM Control Task also handles memory dump commands.  In the event of a data dump command, the CCM Control Task will break the dump into manageable pieces and dump a small portion at a time, each time the task is awakened.  The purpose of this deferred activity is to prevent a large dump from consuming available CPU time by keeping the high-priority CCM Command Dispatch Task busy for an extended period.",0
  The DPU-BOOT CSC shall put the processor into diagnostic mode.,Install Exception HandlersThis routine is a default interrupt handler and is installed into element six (6) of the system interrupt table.,0
  The DPU-BIT shall use the 1553 Driver CSC to perform MIL-STD-1553B internal BIT.,Shall verify that the Spacecraft_indicator contained in the Level1A_Parameters is consistent with the Spacecraft_indicator found in the Level 0 file header.  ,0
"  The DPU-CCM shall check the length of a received DPU_CMD against an expected value from a lookup table indexed by FUNCTION code.  If the received value does not match the expected, then the command will be discarded, and an error will be enqueued.","Data Processing Algorithm CSCThe DPA CSC includes the following components:* Algorithms  o Choose Guide Stars scans the bright stars in the reference frame, chooses guide stars and sets up tracking windows around the guide stars.o Drift Correction calculates the drift offset and roll of a just-completed tracking frame relative to the reference frame. o Create Finding Chart will use the above Choose Guide Stars Algorithm to find the brightest stars in the finding chart Instrument Y then creates a list of the brightest stars and their intensities.o Derive Channel Boundaries calculates a set of channel boundaries (18 numbers - 9X, 9Y) which are used by the centroiding software in the Blue Processing Electronics (BPE) in the Telescope Module.",0
  The Bootstrap Monitor of the DPU-BOOT CSC shall validate commands entered for syntax and number of arguments.,Shall write L0_open_log_msgs to Log_messages when errors occur in the Open_Level0_file process.   ,0
 The DPU-SCUI shall rate-buffer the delivery of STPDUs to the SCU according to the SCU_BUFFER_RATE parameter provided during initialization.  The default value shall provide data to the SCU at a rate of X Kbps and shall be capable of being modified dynamically.,"Telescope Module Access Library and Interface CSCThe TMALI CSC includes the following components:* A queue, TMALI_EVENT_QUEUE, implemented using a ring buffer, which contains the detector events which have been received over the data capture interface from the DCI Driver, but which have not yet been retrieved by the DPA CSC;* An API which facilitates the retrieval of detector events from the queue by the DPA CSC.  The API consists of the tmaliNextEvent() and tmaliWait() functions.* An set of API functions used by the DPA CSC to configure the DCI interface, including tmaliBitArrangementSet(), tmaliDciFrameDepthGet(), tmaliDciFrameDepthSet(), tmaliDciWindowSet(), tmaliDataTimeoutSet(), and tmaliDataTimeoutGet().* An API housekeeping function, tmaliHkGet(), which gathers  CSC housekeeping data at the request of the Command and Control Task.* The task tmaliTask() and an ISR tmaliTransferToQueueISR() work together via a semaphore to synchronize the transfer of data from the DCI to the  queueAn error handling ISR, tmaliDciErrorReportedISR(), is installed as a hook routine to the DCI Driver, and is used to keep track of the number of errors reported by the DCI driver.",0
  The DPU compression software shall forward compressed data  to DPU-SCUI.,Hardware InterfacesThe DCI Driver CSC accesses each of the registers on the Company X Communications module using D16 VME access mode.  Reads from DCI memory are performed in VME D32 mode via a special assembly language routine which uses the lwm/stm instructions to minimize the transfer time.,0
  The DPU-RTOS shall include the capability to dynamically load object modules from the EEPROM.,"Public FunctionsThis routine provides a means for the CCM task to send a Purge Science Queue command from the ICU to the DPA software. The Purge Science Queue command shall be used to command the DPU to delete all data currently in the science telemetry output queue (i.e., data pending transmission to the spacecraft).",0
" The DPU-SCUI shall detect the condition in which the SCU fails to read one or more MIL-STD-1553B subaddresses during the transmission of a STPDU, shall cancel the write on those subaddresses, record new data to those subaddresses, and report an error to the DPU-CCM.","Public FunctionsThis function sets the frame depth of the Ping-Pong buffers used by the DCI CSC.  The frame depth determines how many frames are read into the selected Ping-Pong buffer before interrupting.  The initial value for the frame depth setting is determined by the parameter provided when starting the tmaliTask.  The maximum value to which the frame depth can be commanded is 64 frames, an attempt to command the frame depth to a value larger than this maximum will result in setting the timeout to the default value of V frames.The actual setting of the frame depth could be delayed by a small amount of time if there is activity on the DCI bus, and is typically changed when the DCI has just reported a frame level reached or timeout condition.  This minimizes the chance of changing the setting while the hardware is close to detecting a frame event.  Changing the frame depth while the DCI CSC is processing data could cause unpredictable results.  When a new tmaliDciFrameDepthSet command is send before the previous setting has been activated the new request will overwrite the previous request and the DCI will be commanded to the new value at the first available opportunity.",0
The DPU-BOOT CSC shall wait a minimum of C msecs after a write to EEPROM before performing a read from EEPROM.,InitializationThe DPA CSC is initialized by spawning the tasks dpaEventTask() and dpaInstrument YTask().  After the tasks are spawned they create the needed memory buffers.  The dpaEventTask() then enters the Idle state waiting for a Mode command from the ICU.  The dpaInstrument YTask also enters the Idle state waiting to process either the Ping or Pong buffer.  The default setting for compression (on or off) is retrieved from EEPROM.,0
  The DPU-BOOT CSC shall put the processor into diagnostic mode.,Public FunctionsThis routine provides a means for the CCM task to get the housekeeping info from the DPA software.  The CCM task will call this function and pass a pointer to the location that DPA is to store its housekeeping. ,0
"  The DPU-CCM shall produce DPU_HK at a commandable rate, with a default of 10 seconds.",Shall write L0_open_log_msgs to Log_messages when errors occur in the Open_Level0_file process.   ,0
" In Image Mode, the DPU-DPA shall be capable of binning images at different levels.","Telemetry Output to the Spacecraft 1553 BusThe SCUI CSC reads the Data Packages from the queues and transforms them into CCSDS Version 1 Source Packets.  These Source Packets are then packed into the STPDU for transmission to the SCU.  This processing is performed by scuiConvertToSTPDU().   The STPDU, prefixed with a Transfer Request Counter (TRC), is then written to fifteen sequential 1553 subaddresses (as described in the Company X 1553 ICD) by the function scuiWrite().",0
" The DPU-CCM shall spawn tasks for DPU-CCM, DPU-DPA, DPU-DCX, DPU-SCUI, and DPU-TMALI at bootup.","Instrument Control Unit Interface CSCThe Instrument Control Unit Interface (ICUI) CSC is a new component that provides support for application-level communication with the INSTRUMENT X ICU.  The ICUI CSC is primarily responsible for implementing the application protocol with the ICU as defined in document DPUICD-01. In order to meet these objectives, ICUI provides: * An ICU Interface Message Send Function, icuiEnq(), which provides an API by which other CSCs can send messages to the ICU.* An ICU Interface Command Reader ISR, icuiCmdReceiveISR(), which receives Telecommands from the ICU and forwards them to the Command and Control Task for processing.* An ICU Interface Housekeeping Function, icuiHkGet(), which gathers ICU Interface housekeeping data at the request of the Command and Control Task.",0
  The DPU-CCM shall utilize bootup default values stored in the SYSTEM_CONFIG_AREA in EEPROM when initializing the FSW,The L1A/Geolocation software shall use HDF Version 4.1r1 for reading and writing all HDF files.  ,0
Each Software process shall handle input data sets with the following error attributes: Wrong format input files.,"interrupt service routine (ISR)The DPU responds to interrupts via an interrupt service routine (ISR).  VME interrupts are prioritized; however the DPU does not allow nested interrupts, and so any interrupts which occur while servicing another interrupt will pend until the current ISR has returned.",0
" The DPU-SCUI, in the event of a buffer full condition, shall discard new data, return an error to the caller, and report an error condition to the DPU-CCM.",Real-Time Clock InterfaceThis routine gets the value of the Real-Time Clock (RTC) Registers and places the results in variables rtcu and rtcl.,0
 The DPU-SCUI shall communicate with the SCU according to the protocol defined in document 1143-EI-S19121.,"Public FunctionsThis routine initializes the interface to the ICU.  This routine opens SSI Driver port, installs the SSI interface interrupt callbacks, and enables Transmit Message Mode in the SSI Driver.",0
"  At the end of a download, the Bootstrap Monitor of the DPU-BOOT CSC shall compute a CHKS_32 on the X stored in EEPROM and compare it against the CHKS_32 sent with the X during the transfer.  The Bootstrap Monitor shall output to to the RS-232 interface both CHKS_32s and a message indicating whether the download was successful.","Time RetrievalThe DPU maintains a local copy of the spacecraft clock and current UT Delta in order that the DPU FSW can timestamp data products and packets.  The TIS CSC provides a function, tisTimeGet(), which retrieves a copy of both the current DPU clock value and the most recent UT Delta value.  Time is communicated among DPU FSW applications via the TIS_TIME data structure.",0
  The DPU-TIS shall provide the capability for an application program to select the active 1PPS signal.,"Instrument Control Unit Interface CSCThe Instrument Control Unit Interface (ICUI) CSC is a new component that provides support for application-level communication with the INSTRUMENT X ICU.  The ICUI CSC is primarily responsible for implementing the application protocol with the ICU as defined in document DPUICD-01. In order to meet these objectives, ICUI provides: * An ICU Interface Message Send Function, icuiEnq(), which provides an API by which other CSCs can send messages to the ICU.* An ICU Interface Command Reader ISR, icuiCmdReceiveISR(), which receives Telecommands from the ICU and forwards them to the Command and Control Task for processing.* An ICU Interface Housekeeping Function, icuiHkGet(), which gathers ICU Interface housekeeping data at the request of the Command and Control Task.",0
  The DPU-BIT shall test the Error Detection and Correction (EDAC) on the Company X Communication/Memory Module by reading preprogrammed error locations in PROM.,SCU Interface CSCThis CSC performs rate-buffering of the downlink telemetry to the SCU according to a commandable parameter.  The rate at which the SCU polls the DPU is also commandable.  The CSC installs an ISR to collect telecommands from the SCU via the MILSTD1553B Interface.,0
Each MODIS Standard Product shall contain ECS core metadata with the content and format specified in DID 311.,Shall write Verify_CCSDS_log_msgs to Log_messages when errors occur in the Verify_CCSDS_header_info process.  ,0
"  The DPU-TIS shall provide the capability for an application program to set the value of the SC_TIME register(s) on the SCM and enable the 1PPS clock jam register, if automatic time synchronization is enabled.","Data ProcessingThe DCX CSC is a task which receives data packages from other tasks, compresses the data using the VBTWL algorithm, and then forwards the compressed data package to the SCUI CSC.",0
"  The DPU-CCM shall, in rejecting a command, report an error in DPU_HK indicating  the byte-code of the command being rejected in the LSB of the errno as described in 03691-DPUSDP-01.  ",Public FunctionsThis routine provides a means for the CCM task to send the XRT Position command from the ICU to the DPA software. The XRT Position command shall be used to command the DPU to update the position and window parameters that it uses to spatially filter event data. ,0
  The DPU-DPA will complete the exposure in the time specified by the MODE command - even if it's required to truncate the final tracking frame.,Shall incorporate level1a_scan_flags into scan_quality flags.  ,0
"  The Intensifier Characteristics Engineering mode shall produce a pulse-height histogram, PROD_INTENSE_CHAR.",SCU Interface CSCThe SCU Interface (SCUI) CSC is a Level 3 reuse component from the INSTRUMENT Y project.  The SCUI CSC is primarily responsible for implementing the application protocol with the SCU. The SCUI CSC provides CCSDS packetization services and manages the interface between the DPU and the SCU.,0
 The DPU-TMALI shall allocate a ring buffer of size specified by TMALI_BUFFER_SIZE provided during initialization for storing incoming frames of data.  The default buffer size shall be 15 MB.,Shall write Verify_CCSDS_log_msgs to Log_messages when errors occur in the Verify_CCSDS_header_info process.  ,0
  The DPU-SSI shall write to the SSI registers in 16-bit words only.,SCU Interface CSCThe SCU Interface (SCUI) CSC is a Level 3 reuse component from the INSTRUMENT Y project.  The SCUI CSC is primarily responsible for implementing the application protocol with the SCU. The SCUI CSC provides CCSDS packetization services and manages the interface between the DPU and the SCU.,0
 The DPU-SCUI shall rate-buffer the delivery of STPDUs to the SCU according to the SCU_BUFFER_RATE parameter provided during initialization.  The default value shall provide data to the SCU at a rate of X Kbps and shall be capable of being modified dynamically.,The L1A/Geolocation software shall use all applicable mandatory SDPTK routines and any additional SDPTK routines that are useful.  ,0
  The DPU-DCI shall provide an application program with the capability to command the DCI hardware to reorder the bit sequence of each event's original Detector Electronics Output Format as it is received.,Shall write L0_open_log_msgs to Log_messages when errors occur in the Open_Level0_file process.   ,0
 The DPU-CCM shall notify the ICU upon completion of boot and flight software initialization.,"Data Processing Algorithm CSCThe DPA CSC includes the following components:* Instrument Y Processor Task  creates histogrammed Instrument Ys, performs Tracking (choose guide stars, drift correction, shift-and-add), creates the Reference, Accumulation, and Data Product buffers, and provides a task heartbeat to the CCM task.",0
"  The DPU-ICUI shall format messages according to DPUICD-01, Section 3.1","Error Collection and ReportingThe DPU-CCM CSC provides a centralized error reporting interface, ccmErrEnq(), that other FSW tasks use to report errors.  Each time it wakes, ccmTask() checks to see if it is time to form an error/event packet for transmission to the ground.  If so, ccmTask() calls ccmHkMkError() to actually create the packet and forward it to DPU-SCUI for transmission to the ground.",0
  The DPU-SSI shall provide the capability for an application to determine the number of bytes in a message received from the ICU.,"Public FunctionsThis routine gets housekeeping data stored for the TMALI CSC including some DCI parameters and resets the tmali internal counters to zero.  When the caller supplied pointer to a TMALI_HK structure is NIL no data is returned but the tmali internal counters are still reset to zero.Two of the four error counters are updated within an ISR context, this requires a task switch safe implementation of these counters.  Within VxWorks this could be solved using a counting semaphore.  In the TMALI CSC design a faster method was used by using a free running error counter and a careful update of the reported number of errors, using an extra temporary variable.  As the increment and assignment of the 32 bit unsigned integers themselves are atomic operations the resulting counters are task safe and no error events are lost.  This means that the sum of the errors reported by the tmaliHkGet() function is equal to the total numbers of errors that occurred, no error reports are lost due to the update of the internal structures.",0
"  When commanded to event mode by the ICU,  the DPU-DPA shall be capable of collecting time-tagged photon events and producing a PROD_EVENT.","External Program InterfacesPerforms the SCM EDAC test, PROM checksum test, and device loopback tests for those devices which support it.",0
" The DPU-SCUI, in the event of a buffer full condition, shall discard new data, return an error to the caller, and report an error condition to the DPU-CCM.",Raw Event List (RE) Engineering ModeThe purpose of Raw Event List Engineering Mode is to diagnose problems with the detector. Detector events produced in a given detector mode are collected over a commanded integration time and transmitted to the ground as a list of raw events.,0
  The DPU-CCM shall collect DPU_HK and forward it to the DPU-SCUI.,"Standard I/O InterfaceThe read() primitive does not block.  A read is performed on the active portion of the H/W ping pong buffer using the RAD 6000 move-multiple instruction, referred to here after as a block move.  For optimum performance, the block move is implemented in assembler.  The number of bytes read is returned to the caller.",0
"  The DPU-ICUI shall format messages according to DPUICD-01, Section 3.1","Memory Upload and Download HandlingData can be upload to several types of locations, including* DRAM* EEPROM* hardware registers, and* EEPROM filesystem.ial D_MEM_DAT_UPLD command specify the target location.  If the destination is the EEPROM filesystem, a block number is provided in lieu of a memory address , which is used by the DPU FSW to formulate a filename of the form eefs1:DPU_blk.##, where ## is the block number.  In this case, once the entirety of the uploaded data is received by the DPU FSW, the uploaded data is then written to that file in the EEPROM filesystem.  If a file already exists with that name, it is overwritten.  The EEPROM filesystem can be reinitialized using the command D_MEM_DISK_INIT.",0
"  On boot, the DPU-CCM shall toggle the BC_INDEX if the boot is successful.  A boot is successful if command and telemetry communications have been established with the spacecraft.",Public FunctionsThis routine provides a means for the CCM task to get the housekeeping info from the DPA software.  The CCM task will call this function and pass a pointer to the location that DPA is to store its housekeeping. ,0
  The DPU-BOOT CSC shall display a message via RS-232 on detection of a BIT failure.,"Public FunctionsThis routine is called by any CSC in order to report an error or event that should be included in DPU housekeeping.  If this routine is called from interrupt context a static global variable, ccmISRError, is set so that the error can be enqueued later (see ccmCtrlTask()).  This is done since the error/event queue is semaphore-protected and a semaphore cannot be taken in an ISR.  The error queue semaphore has priority inversion set to reduce conflicts between multiple callers should a priority inversion situation arise. This routine also replaces frequently occuring errors with a special repeat error code.  The repeat error code is a special error code that follows a normally reported error code to indicate that the normally reported error code previously reported has occurred more than once in the last high rate reporting period",0
 The DPU-SCUI shall report errors to the DPU-CCM for inclusion in the DPU Housekeeping information.,Shall incorporate level1a_scan_flags into scan_quality flags.  ,0
  The DPU-DCI shall provide an application program with the capability to command the DCI hardware to reorder the bit sequence of each event's original Detector Electronics Output Format as it is received.,Checksum LibraryThis function performs a checksum on a specified memory range.  The checksum is performed as a 32-bit additive checksum.,0
"  The Bootstrap Monitor of the DPU-BOOT CSC shall provide the capability to write to Dynamic Random Access Memory (DRAM), the VME bus, and the Input/Output Channel Controller (IOCC) on command.","Channel Boundary (CB) Engineering ModeThe purpose of Channel Boundary Mode is to derive the optimum channel boundary settings from a flat field. Detector events produced in the M,N detector mode are collected and histogrammed for a commanded integration time.  The pseudo Instrument Y is transmitted to the ground.  Channel boundaries are derived from the Instrument Y and transmitted to the ICU and the ground.  Channel boundaries are sent by the ICU to the BPE and used in the detector event centroiding process.",0
 The DPU-DPA shall be able to perform tracking based on data collected from the detector by calculating the spacecraft drift using successive tracking frames using the algorithm described in Appendix C.,"Data Transfer to QueueWhen the tmaliTransferToQueueISR() ISR is invoked, it gives a semaphore to awaken tmaliTask() that will transfer data to the  queue over the VME bus.  The tmaliTask() uses the read() function in the DCI Driver, which implements a data transfer using a high speed assembly language routine.  Because the TMALI ring buffer is implemented as an array, the tmaliTask() function must first examine the TMALI_EVENT_QUEUE to determine whether the data resident in the DCI buffer can be retrieved using a single read() call, or whether two calls are required in order to correctly handle the wrap-around case at the end of the ring buffer.  In addition, the tmaliTask() function must perform an error check to verify that there is sufficient space to receive the data available in the Ping-Pong buffer.  If there is insufficient space for the complete set of frames, the entire contents of the readable Ping-Pong buffer are discarded and the error S_TMALI_QUEUE_FULL is reported using ccmErrEnq mechanism.  Such discarded data constitutes an integral number of CCD frames, since the DCI hardware design ensures that Ping-Pong transitions occur at CCD frame boundaries.  This policy of discarding the newer data supports the scientific viewpoint that events collected right after a burst have more scientific value than events collected later.",0
"A MODIS Computer Software Configuration Item (CSCI) is any independently tracked and configured unit of software within the MODIS SDP S/W, including processes, scripts, and utility libraries.  Each CSCI in the MODIS SDP S/W shall run in the ECS production environment.","Telemetry Output to the Spacecraft 1553 BusThe SCUI CSC reads the Data Packages from the queues and transforms them into CCSDS Version 1 Source Packets.  These Source Packets are then packed into the STPDU for transmission to the SCU.  This processing is performed by scuiConvertToSTPDU().   The STPDU, prefixed with a Transfer Request Counter (TRC), is then written to fifteen sequential 1553 subaddresses (as described in the Company X 1553 ICD) by the function scuiWrite().",0
"A MODIS Computer Software Configuration Item (CSCI) is any independently tracked and configured unit of software within the MODIS SDP S/W, including processes, scripts, and utility libraries.  Each CSCI in the MODIS SDP S/W shall run in the ECS production environment.","initial boot sequencethe initial boot sequence, identified as Boot Sequence 1.  This processing takes place when the Bootstrap executes from Programmable Read-Only Memory (PROM).  Boot Sequence 1 is composed primarily of 4 steps as follows.First, in this sequence, EEPROM is updated.  Then, CPU BIT and a portion of DRAM BIT is performed.  Next, DRAM is cleared.  Lastly, Boot Sequence 2 is copied to DRAM and executed. During this sequence, the rest of DRAM is tested if skipBit is not set.  Load parameters are put into registers r13, r14, r15 and r16.  DRAM is cleared up to memSize.  Lastly, either the DPU-RTOS or the Bootstrap Monitor is loaded and executed according to the load parameters.",0
"  The DPU-DPA shall collect event mode data, preserving the time and spatial resolution in the specified event window.",Public FunctionsThis routine is spawned by the Command and Control Task to initialize and execute the DPA Event Processing Task.,0
"The DPU-BOOT CSC shall perform successive writes to a word page of EEPROM within C msecs, or wait a minimum of D usecs between successive writes.",Error Detection and Correction CSCThe Error Detection and Correction (EDAC) CSC is a Level 1 reuse component from the SSFF and INSTRUMENT Y projects.  The EDAC CSC consists of a set of Interrupt Service Routines (ISRs) and a Memory Scrubber Task.  The design of the INSTRUMENT Y EDAC CSC is described in document CIDPSDS-01.The only design change was to add logic to check for excessive external (SCM) EDAC interrupts.,0
"  There DPU-DPA shall have three science modes, X, Y mode, and X/Y mode.",The L1A/Geolocation software shall follow the coding standards established by the MODIS project in MODIS Software Development Standards and Guidelines  ,0
  The centroid confirmation engineering mode shall produce a PROD_CENTROID_CONF.  This mode shall divide a full frame image into a certain regions.  Each region shall be processed to form an 8x8 confirmation image.  The certain confirmation images shall be sent to the solid state recorder as one data product.,"Time SynchronizationThe interface with the spacecraft as described in document 1143-EI-S19121 specifies that the spacecraft will provide a Clock Message to each Instrument at a 1 Hz rate.  The Clock Message contains both two values: a value representing the current spacecraft time, and a value representing the delta from the spacecraft time and the Univeral Time (UT), based on an epoch of TBD.",0
 The DPU-CCM shall record an error to the LAST_BOOT_IVEC location in EEPROM and discontinue strobing the Watchdog Timer should an unrecoverable software error occur.  An unrecoverable software error is defined as an error that causes a loss of commandability or ground communication.,"Public FunctionsThis routine provides a means for the CCM task to send a Purge Science Queue command from the ICU to the DPA software. The Purge Science Queue command shall be used to command the DPU to delete all data currently in the science telemetry output queue (i.e., data pending transmission to the spacecraft).",0
"A MODIS Computer Software Configuration Item (CSCI) is any independently tracked and configured unit of software within the MODIS SDP S/W, including processes, scripts, and utility libraries.  Each CSCI in the MODIS SDP S/W shall run in the ECS production environment.",Install Exception HandlersThis routine installs a hook routine for the Memory Error Interrupt.  The hook routine will be called from the interrupt context.  This function returns OK always.,0
" The DPU-ICUI shall install an ISR to be invoked on the SSI receiver interblock gap interrupt, for the receiving and processing of commands from the ICU.","ACS Message ProcessingThe SCUI task will send the ACS message to the DPA by calling the function dpaACSReceive().  Because the SCUI task will be calling dpaACSReceive() from an ISR, dpaACSReceive() must return quickly.  If commanded by the ICU in the Mode command, the ACS message will be saved along with the event data product.  To return quickly, dpaACSReceive() will place the ACS message in a data queue then return.  The Event Processor Task will remove the ACS messages from the queue and send them to the spacecraft.",0
 The DPU-DCI shall provide an application program with the ability to toggle the hardware interface between Normal mode and Test mode.,"Public FunctionsThis routine returns OK, or ERROR and sets errno if the passed parameter is NULL.  The following error codes may be returned in errno ",0
  The  raw event list engineering mode shall collect events for transmission to the ground.,Public FunctionsThis routine provides a means for the CCM task to send the XRT Position command from the ICU to the DPA software. The XRT Position command shall be used to command the DPU to update the position and window parameters that it uses to spatially filter event data. ,0
  The centroid confirmation engineering mode shall produce a PROD_CENTROID_CONF.  This mode shall divide a full frame image into a certain regions.  Each region shall be processed to form an 8x8 confirmation image.  The certain confirmation images shall be sent to the solid state recorder as one data product.,"types of external (VME) interruptsThe DPU has five types of external (VME) interrupts:* MIL-STD-1553 Interface Interrupts,* DCI Interface Interrupts,* SSI Interface Interrupts,* Memory EDAC Interrupt, and* Ethernet Interrupt (ground use only).",0
"  The DPU-DCI shall provide the capability for an application program to set a timeout in milliseconds that specifies a period during which no new events have been received by the hardware, after which the hardware will swap ping-pong buffers and interrupt the software.","Performing Analog-to-Digital ConversionsThe ADC Driver maintains an array of ADC_LIST_ENTRY data structures which contain the hardware multiplexer setup information for each of the x analog inputs, and the current value (ADC_VALUE) of each analog input.  To update a single value in the list, an application must call the update function adcUpdateNext().  The ADC hardware only has a single A/D channel, and so to perform an A/D conversion the hardware requires a multiplexer setup and corresponding settle time, as well as the normal A/D conversion time.  Therefore, it takes two calls to adcUpdateNext() to update a single value in the list.  To keep the driver simple and to avoid embedding hard waits in the driver, the application is required to implement the setup and conversion time by spacing successive calls to the adcUpdateNext() function appropriately.",0
 The DPU compression software shall report errors to the DPU-CCM for inclusion in the DPU Housekeeping information.,"Data Transfer to QueueWhen the tmaliTransferToQueueISR() ISR is invoked, it gives a semaphore to awaken tmaliTask() that will transfer data to the  queue over the VME bus.  The tmaliTask() uses the read() function in the DCI Driver, which implements a data transfer using a high speed assembly language routine.  Because the TMALI ring buffer is implemented as an array, the tmaliTask() function must first examine the TMALI_EVENT_QUEUE to determine whether the data resident in the DCI buffer can be retrieved using a single read() call, or whether two calls are required in order to correctly handle the wrap-around case at the end of the ring buffer.  In addition, the tmaliTask() function must perform an error check to verify that there is sufficient space to receive the data available in the Ping-Pong buffer.  If there is insufficient space for the complete set of frames, the entire contents of the readable Ping-Pong buffer are discarded and the error S_TMALI_QUEUE_FULL is reported using ccmErrEnq mechanism.  Such discarded data constitutes an integral number of CCD frames, since the DCI hardware design ensures that Ping-Pong transitions occur at CCD frame boundaries.  This policy of discarding the newer data supports the scientific viewpoint that events collected right after a burst have more scientific value than events collected later.",0
  The DPU-DPA shall be capable of providing DPA_HK on request.,"Unmask VME Interrupts and Disallow Nested InterruptsThe device drivers do not automatically unmask VME interrupts at the processor.  This must be done separately since some VME interrupts may share an IRQ level. Finally, nested interrupt capability should be disabled since allowing for nested interrupts was not considered in the design of this FSW.  This is done by verifying that SYS_INT_MASK_0 and SYS_INT_MASK_1 are both defined to 0xffffffff in config.h.",0
 The DPU-ICUI shall use DPU-SSI to communicate with the SSI Interface.,"Standard I/O InterfaceThe read() primitive does not block.  A read is performed on the active portion of the H/W ping pong buffer using the RAD 6000 move-multiple instruction, referred to here after as a block move.  For optimum performance, the block move is implemented in assembler.  The number of bytes read is returned to the caller.",0
  The DPU-RTOS shall provide a function to allow an application program to read from the Real-Time Clock registers on the RAD6000SC CPU Module.,Public FunctionsThis routine provides a means for the CCM task to get the housekeeping info from the DPA software.  The CCM task will call this function and pass a pointer to the location that DPA is to store its housekeeping. ,0
  The DPU-CCM shall interpret and execute/dispatch real-time DPU_CMDs.,Real-Time Clock InterfaceThe Real-Time Clock (RTC) Registers of the RAD6000 are special-purpose registers not normally accessible to C language programs.  Some assembler wrapper functions provide access to these.  ,0
"  The DPU-BOOT CSC shall create a record of failed DRAM blocks, BIT_DRAM, in the SYSTEM_BLOCK.","Public FunctionsThis routine manually sets the values of the spacecraft time maintained in the DPU hardware, and the UT Delta maintained in a static variable, to the given values.",0
" The DPU-TMALI shall install callbacks for handling all DPU-DCI interrupts including Error interrupt, Ping-Pong Timeout interrupt, and Ping-Pong Complete Flag interrupt.",Control and MonitoringThe DPU produces eight types of housekeeping packets.,0
  The DPU-DCI shall write to the DCI Memory in B-bit words only.,The L1A/Geolocation software shall use all applicable mandatory SDPTK routines and any additional SDPTK routines that are useful.  ,0
The DPU-BOOT CSC shall enable EDAC on the SCM.,"Error Collection and ReportingThe ccmErrEnq() function tracks the last error reported and its frequency of occurrence.  Once an error code has been reported it becomes the previously reported error code maintained by ccmErrEnq().  A repetition count is then incremented for each subsequent, consecutively reported, identical instance of this previously reported error.  If this error code is reported more than once in one high-rate housekeeping reporting period, then a special error, S_ccm_ERR_REPEAT is enqueued with the repetition count for the error encoded in the least significant byte. This mechanism effectively reduces the potential for housekeeping telemetry to become flooded with a single repeated error.",0
  The DPU-BOOT CSC shall read from EEPROM in 32-bit words only.,"Public FunctionsThis routine provides a means for the CCM task to send the Stop Mode command from the ICU to the DPA software. The Stop Mode command shall be used to command the DPU to immediately stop processing events, complete the current data product, purge events from the DPU hardware, and enter Idle Mode.  The data product will include the actual exposure time and the number of frames.  In response to this command, the DPU shall issue a Mode Complete command to the ICU after finishing the before-mentioned tasks.",0
"  The DPU-1553 CSC shall address hardware modules as defined in document 1400, Company X Specification for the Company X Communication/Memory Module.","Data Processing Algorithm CSCThe DPA CSC includes the following components:* Algorithms  o Choose Guide Stars scans the bright stars in the reference frame, chooses guide stars and sets up tracking windows around the guide stars.o Drift Correction calculates the drift offset and roll of a just-completed tracking frame relative to the reference frame. o Create Finding Chart will use the above Choose Guide Stars Algorithm to find the brightest stars in the finding chart Instrument Y then creates a list of the brightest stars and their intensities.o Derive Channel Boundaries calculates a set of channel boundaries (18 numbers - 9X, 9Y) which are used by the centroiding software in the Blue Processing Electronics (BPE) in the Telescope Module.",0
  The Bootstrap Monitor of the DPU-BOOT CSC shall provide the capability to download configurations of the DPU-RTOS from the RS-232 interface to EEPROM on command.,"interrupt service routine (ISR)The DPU responds to interrupts via an interrupt service routine (ISR).  VME interrupts are prioritized; however the DPU does not allow nested interrupts, and so any interrupts which occur while servicing another interrupt will pend until the current ISR has returned.",0
The DPU-BOOT CSC shall enable EDAC on the SCM.,"Public FunctionsThis routine initializes the interface to the ICU.  This routine opens SSI Driver port, installs the SSI interface interrupt callbacks, and enables Transmit Message Mode in the SSI Driver.",0
"  The Bootstrap CSC shall address hardware modules as defined in document 1400, Company X Specification for the Company X Communication/Memory Module.",Shall write Read_packet_log_msgs to Log_messages when errors occur in the Read_MODIS_packet process.  ,0
  The DPU-ADC shall read from the SCM registers in B-bit words only.,"Public FunctionsThis task initializes the TMALI CSC and then continues to read data from the DCI and store it in the TMALI buffer each time the DCI driver signals that data is available in the Ping-Pong buffer.  The availability of data in the DCI Ping-Pong buffer is signaled to the tmaliTask using a semaphore.  Unless a fatal error is detected during initialization this task will never terminate.The specified 3 parameters specify the size of the TMALI queue and the initial parameters for the DCI, if the specified values are outside the allowed range default values will be used.The specified QueueSize is the allocated buffersize (in 4 byte EVENTS), the ring buffer is full when QueueSize-1 EVENTS are stored in the buffer.",0
"  When observing a new GRB, and the XRT_POS becomes available from the ICU, the DPU-DPA shall shift and resize the image and event windows appropriately.",Shall generate data_input_status_messages if errors are encountered in reading Level_1B_Data.  ,0
 The DPU-DPA shall be able to perform tracking based on data collected from the detector by calculating the spacecraft drift using successive tracking frames using the algorithm described in Appendix C.,"InitializationThe ICUI CSC is initialized by calling icuiInit().  The icuiInit() function opens the SSI interface port to the ICU, installs the transmit and receive ISRs, and enables Transmit Message Mode in the SSI Driver CSC.  The icuiInit() function is called by the CCM Control Task at bootup.",0
The DPU-BOOT CSC shall test and clear DRAM on power-on using the COLD_MEM_SIZE obtained from the SYSTEM_BLOCK.,Public FunctionsThis routine provides a means for the CCM task to send the XRT Position command from the ICU to the DPA software. The XRT Position command shall be used to command the DPU to update the position and window parameters that it uses to spatially filter event data. ,0
  The DPU-BOOT CSC shall log detected BIT failures to the SYSTEM_BLOCK.,"Data Processing Algorithm CSCThe DPA CSC includes the following components:* Event Processor Task  communicates with the ICU, creates event list data products, creates Tracking Instrument Ys in the Ping/Pong buffers, creates the Finding Chart, performs the Engineering Modes, generates housekeeping data, creates the Event Frame, Ping and Pong buffers, and provides a task heartbeat to the CCM task.",0
 The DPU-CCM shall use DPU-ICUI to communicate with the ICU.,Install Exception HandlersThis routine is a default interrupt handler and is installed into element six (6) of the system interrupt table.,0
  The DPU-SSI shall write to the SSI registers in 16-bit words only.,"Time Interface ConfigurationThe DPU hardware provides two configuration options to the software:* selection of the active A PPS signal, and* the option to manually jam a value into the clock registers without the A PPS signal.",0
 The DPU-SCUI  shall be capable of packing created CCSDS Source Packets into STPDUs using segmented (grouped) packets for transfer to the SCU as defined by CCSDS-102.0-B-4 and in accordance with interface control document 1143-EI-S19121.,"Error Collection and ReportingAt boot time, no error queue exists because it has yet to be created.  Errors that occur in this early stage of error reporting are assigned directly to the global task variable errno.  The reader may refer to the VxWorks Programmers Guide, section 2.3.7 for more information on errno.  If errno is set after the error queues are created, it is queued to the Error Queue by calling ccmErrEnq(). ",0
  The DPU-SSI shall provide the capability for an application to determine the number of bytes in a message received from the ICU.,"External Program InterfacesPerforms the SCM EDAC test, PROM checksum test, and device loopback tests for those devices which support it.",0
"  The DPU-DCI shall read from the DCI Memory in B-bit words only, using the load multiple/store multiple instructions.",Install Exception HandlersThis routine is a default interrupt handler and is installed into element six (6) of the system interrupt table.,0
" The DPU-ICUI shall install an ISR to be invoked on the SSI receiver interblock gap interrupt, for the receiving and processing of commands from the ICU.","Development PlatformThe DPU FSW will be implemented in the ANSI C programming language, with some PowerPC assembly used in the Bootstrap and to implement the VME data transfer in the DCI Driver.  The host (development) platform and operating system is Sun/Solaris from Sun Microsystems, Inc.  The target platform is the RAD6000 processor which has a POWER (PowerPC-like) architecture, and executes the VxWorks 5.3.1 real-time operating system.  The cross compiler and debugger is MULTI/C/C++ 1.8.9 from Green Hills Software, Inc.",0
  The DPU-ADC shall read from the SCM registers in B-bit words only.,Install Exception Handlersa default interrupt handler and is installed into element five (5) of the system interrupt table.,0
  The DPU-ICUI shall receive real-time DPU_CMDs from the ICU via SSI and forward them to DPU-CCM.,Install Exception HandlersThis routine is a default interrupt handler and is installed into element six (6) of the system interrupt table.,0
  The DPU-SSI shall read from the SSI registers in 16-bit words only.,"Checksum LibraryA number of checksum algorithms are required by various system and application software modules.  In order to avoid duplication of code, the various checksum algorithms are encapsulated into a checksum library. ",0
  The DPU-TMALI shall provide a function which sets the current event bit ordering mode in the DCI driver.,"Command HandlingThe DPU accepts commands via two interfaces  from the Spacecraft via the MIL-STD-1553 interface, and from the ICU via the SSI interface.  Any of the DPU commands can be sent from the SCU or the ICU.  The source for a command from the DPU is one of the following:* ICU  command is generated and sent by the ICU via the SSI.* SCU  command is generated and sent by the SCU via the 1553.* G-ICU  command is generated on the ground and sent to the DPU via the ICU/SSI.* G-SCU  command is generated on the ground and sent to the DPU via the SCU/1553.",0
" The DPU-CCM shall spawn tasks for DPU-CCM, DPU-DPA, DPU-DCX, DPU-SCUI, and DPU-TMALI at bootup.","Public FunctionsThis routine provides a means to set the data timeout used by the DCI, the value requested indicates the timeout in milliseconds.  The initial value for the frame depth setting is determined by the parameter provided when starting the tmaliTask.  The maximum value to which the timeout can be commanded is X seconds, an attempt to set the timeout to a number larger than this maximum will result in setting the timeout to the default value of X milliseconds",0
  The DPU-DPA will complete the exposure in the time specified by the MODE command - even if it's required to truncate the final tracking frame.,"Built-In Test CSCThe Built-In Test (BIT) CSC is a Level 2 reuse component from the SSFF and INSTRUMENT Y projects.  The detailed design of the BIT CSC follows. The Built-In Tests CSC, identified DPU-BIT, performs the Stage 2 Built-In Tests (BIT).  The Stage 2 BIT includes a test of the SCM EDAC circuit, a checksum test on SCM PROM, a MIL-STD-1553B internal BIT, and a memory test of the DCI Data Buffers. The results of the BIT are recorded in the SYS_CNFG_AREA in EEPROM and are also maintained in DRAM.  If an error occurs in one of the functions performing the BIT, the test result will be reported as a failure in the test itself.",0
  The DPU-SSI shall provide the capability for an application program to enable/disable the VME Slave Interrupt on the SCM for the SSI Interface.,"Checksum LibraryA number of checksum algorithms are required by various system and application software modules.  In order to avoid duplication of code, the various checksum algorithms are encapsulated into a checksum library. ",0
  The DPU-SSI shall provide the capability for an application program to install a callback routine to respond to the transmit IBG Interrupt.,"Data ProcessingThe DCX CSC is a task which receives data packages from other tasks, compresses the data using the VBTWL algorithm, and then forwards the compressed data package to the SCUI CSC.",0
  The Bootstrap Monitor of the DPU-BOOT CSC shall output an error message to the RS-232 interface if an invalid command argument option is entered.,"Public FunctionsThis routine provides a means to set the data timeout used by the DCI, the value requested indicates the timeout in milliseconds.  The initial value for the frame depth setting is determined by the parameter provided when starting the tmaliTask.  The maximum value to which the timeout can be commanded is X seconds, an attempt to set the timeout to a number larger than this maximum will result in setting the timeout to the default value of X milliseconds",0
  The DPU-BIT shall perform MIL-STD-1553B internal BIT.,"Control and Monitoringthe CCM Control Task also handles memory dump commands.  In the event of a data dump command, the CCM Control Task will break the dump into manageable pieces and dump a small portion at a time, each time the task is awakened.  The purpose of this deferred activity is to prevent a large dump from consuming available CPU time by keeping the high-priority CCM Command Dispatch Task busy for an extended period.",0
  The Bootstrap Monitor of the DPU-BOOT CSC shall provide the capability to load a configuration of the DPU-RTOS from EEPROM to DRAM and start its execution on command.,Shall write Verify_CCSDS_log_msgs to Log_messages when errors occur in the Verify_CCSDS_header_info process.  ,0
  The DPU-DCI shall provide the capability for an application program to receive data at a rate of A bytes per second over the DCI interface.,Setting DCI Bit ArrangementThe bit arrangement of the DCI control/status register can be set via tmaliBitArrangementSet().,0
  The DPU-SSI shall read from the SSI registers in 16-bit words only.,"Public FunctionsSets the poll rate and buffer rate to the given values.  If the values are out of range, the prior values are retained and an error is reported.  The scuiTask() semaphore timeout (scuiTaskTimeout) is automatically adjusted based on the given poll rate, by setting the timeout to approximately  the poll rate (not that the timeout is expressed in clock ticks, and so the resolution is low and only approximates  of the poll rate).",0
  The DPU-DCI shall provide the capability for an application program to reset the DCI by writing to the DCI Reset Register.,"InitializationThe DCX CSC is initialized when the dcxTask() is spawned by the CCM CSC.  During initialization, the DCX CSC creates a compression queue to contain data packages which are pending compression.  Access to the compression queue is protected by a mutual exclusion semaphore.  The size of the compression queue is controlled by an initialization parameters which is passed into the dcxTask().  If the amount of memory requested cannot be allocated, initialization of the DCX CSC will fail.",0
 The DPU-CCM shall use DPU-ICUI to communicate with the ICU.,Shall write Verify_MODIS_log_msgs to Log_messages when errors occur in the Verify_MODIS_header_info process. ,0
"  The DPU-ICUI shall compute a CHKS_16 for DPU_CMDs received from the ICU.  If the expected checksum is not computed, the command will be discarded, an error will be enqueued to DPU-CCM, and a NAK message transmitted to the ICU within a second.","Public FunctionsThis function sets the frame depth of the Ping-Pong buffers used by the DCI CSC.  The frame depth determines how many frames are read into the selected Ping-Pong buffer before interrupting.  The initial value for the frame depth setting is determined by the parameter provided when starting the tmaliTask.  The maximum value to which the frame depth can be commanded is 64 frames, an attempt to command the frame depth to a value larger than this maximum will result in setting the timeout to the default value of V frames.The actual setting of the frame depth could be delayed by a small amount of time if there is activity on the DCI bus, and is typically changed when the DCI has just reported a frame level reached or timeout condition.  This minimizes the chance of changing the setting while the hardware is close to detecting a frame event.  Changing the frame depth while the DCI CSC is processing data could cause unpredictable results.  When a new tmaliDciFrameDepthSet command is send before the previous setting has been activated the new request will overwrite the previous request and the DCI will be commanded to the new value at the first available opportunity.",0
 The DPU-DCI shall provide an application program with the ability to toggle the hardware interface between Normal mode and Test mode.,"Built-In TestThere are two stages of Built-In Tests (BIT) for the DPU.  The Stage 1 BIT is included in the Bootstrap program and consists of Central Processing Unit (CPU) BIT, and Dynamic Random Access Memory (DRAM) BIT.  The Stage 2 BIT is executed after the operating system is booted and is not part of the Bootstrap program.",0
All searchable product-specific metadata in MODIS standard products shall be formatted as specified in DID 311.,"Error RecoveryExcept for the modification described in Sections 5.2.3.6, no further modifications to the existing task error-handling mechanisms are required. VxWorks? uses a global mechanism for returning status codes when errors occur.  This is accomplished  by using the task variable, errno (stored in the task control block).  Most VxWorks? functions return a STATUS value.  This value can either be OK or ERROR.  If a function returns ERROR, then the errno variable must indicate a specific error code.",0
  The DPU-ADC shall create a fixed analog conversion scan list containing the A DPU analog values (active values plus one ground reference value).,Shall write Verify_MODIS_log_msgs to Log_messages when errors occur in the Verify_MODIS_header_info process. ,0
"  The DPU-DCI shall provide the capability for an application program to set a timeout in milliseconds that specifies a period during which no new events have been received by the hardware, after which the hardware will swap ping-pong buffers and interrupt the software.","CPU BITThe CPU BIT consists of a series of tests designed to test each of the functional units of the processor.  These include test for the Branch-Unit, the Fixed-Point Unit, the Floating-Point Unit, the Interrupt-Unit, and the Timer Unit.   Each of these tests consists of executing a few selected instructions from the this functional unit. The General Purpose Registers (GPR), the Segment Registers (SR), the Counter Register (CTR), and the Condition Register are tested for stuck-bits as part of the Branch-Unit test.  This is done by writing a 1s pattern (verified by reading it back) and then writing a 0s pattern (verified by reading it back).",0
"  The DPU-BOOT CSC shall include a CPU BIT consisting of a branch test, a fixed point test, a floating point test, an interrupt test, a timer test, and a register test.","Public FunctionsThis function sets the frame depth of the Ping-Pong buffers used by the DCI CSC.  The frame depth determines how many frames are read into the selected Ping-Pong buffer before interrupting.  The initial value for the frame depth setting is determined by the parameter provided when starting the tmaliTask.  The maximum value to which the frame depth can be commanded is 64 frames, an attempt to command the frame depth to a value larger than this maximum will result in setting the timeout to the default value of V frames.The actual setting of the frame depth could be delayed by a small amount of time if there is activity on the DCI bus, and is typically changed when the DCI has just reported a frame level reached or timeout condition.  This minimizes the chance of changing the setting while the hardware is close to detecting a frame event.  Changing the frame depth while the DCI CSC is processing data could cause unpredictable results.  When a new tmaliDciFrameDepthSet command is send before the previous setting has been activated the new request will overwrite the previous request and the DCI will be commanded to the new value at the first available opportunity.",0
  The DPU-ADC shall write to the SCM registers in B-bit words only.,"Sending Messages to the ICUSome special processing and checking is required in this function to handle the transmission of the ACK/NAK message.  When a command arrives from the ICU, the icuiCmdReceiveISR() will verify the message checksum and then send an ACK/NAK message to the ICU.  It is possible that an application is in the midst of sending a message to the ICU at the time a command interrupt occurs.  However, since it is not possible for an ISR to take a semaphore, an additional mechanism is required in order to provide mutual exclusion between a task an the ISR.  To accommodate this problem, the icuiEnq() function first determines whether it is being invoked from interrupt context.  If so, it then tests the value of a static variable, icuiEnqBusy.  If the variable is set, the function will save the given ACK/NAK message parameters in static variables and return.  If the variable is not set, the function will continue as normal (avoiding the semTake() and semGive() calls).  In normal execution, the icuiEnqBusy variable is set on entry and negated on exit, after which the static variables containing the ACK/NAK message parameters will be checked to determine whether an ACK/NAK is pending.",0
 The DPU-SCUI shall be capable of receiving a telecommand from the SCU every N ms and forward it to DPU-CCM for processing.,"Data Processing Algorithm CSCThe DPA CSC includes the following components:* Event Processor Task  communicates with the ICU, creates event list data products, creates Tracking Instrument Ys in the Ping/Pong buffers, creates the Finding Chart, performs the Engineering Modes, generates housekeeping data, creates the Event Frame, Ping and Pong buffers, and provides a task heartbeat to the CCM task.",0
  The DPU-DPA shall be capable of collecting detector events over the full  FOV.,Shall generate data_input_status_messages and set scan_quality_flags if corrupted data values are detected.  ,0
  The DPU-BOOT CSC shall read from EEPROM in 32-bit words only.,External Program InterfacesReads the BIT results from the location pointed to by pBitResults (which is assumed to be in EEPROM) into the BIT results data structure in DRAM.,0
  The DPU-CCM shall process real-time non-deferred commands within B ms of receipt from the ICU or the SCU.,"Analog to Digital Converter Driver CSCThe Analog to Digital Converter (ADC) Driver CSC is a new driver which controls and retrieves data from the ADC hardware.  The key elements of the ADC driver include:* A list (array of ADC_LIST_ENTRY) which maintains the setup information and current value (ADC_VALUE) for each of the 24 ADC values. * An API function, adcUpdateNext(), which causes a single ADC_VALUE to be updated every other call to the driver.  A value is updated every other call since each value requires a multiplexer settle time as well as an ADC conversion time.  In order to keep the driver simple, the responsibility for implementing the correct settle time and conversion time rests with the application.* An API function, adcGet(), which returns a copy of the current list of ADC_VALUEs.",0
 The DPU-CCM shall record an error to the LAST_BOOT_IVEC location in EEPROM and discontinue strobing the Watchdog Timer should an unrecoverable software error occur.  An unrecoverable software error is defined as an error that causes a loss of commandability or ground communication.,"Public FunctionsThis routine is called by any CSC in order to report an error or event that should be included in DPU housekeeping.  If this routine is called from interrupt context a static global variable, ccmISRError, is set so that the error can be enqueued later (see ccmCtrlTask()).  This is done since the error/event queue is semaphore-protected and a semaphore cannot be taken in an ISR.  The error queue semaphore has priority inversion set to reduce conflicts between multiple callers should a priority inversion situation arise. This routine also replaces frequently occuring errors with a special repeat error code.  The repeat error code is a special error code that follows a normally reported error code to indicate that the normally reported error code previously reported has occurred more than once in the last high rate reporting period",0
  The Bootstrap Monitor of the DPU-BOOT CSC shall validate commands entered for syntax and number of arguments.,"Time SynchronizationThe time contained in the Clock Message is specified to be valid on the rising edge of the next 1PPS signal.  When the DPU receives the Clock Message, the 1553 ISR calls the tisTimeSync() function, forwarding the data portion of the clock message to the TIS CSC via the TIS_CLK_MSG data structure..  The tisTimeSync() function will immediately copy the spacecraft clock value to the DPU clock hardware registers. The DPU hardware is designed to latch in the new time on the rising edge of the next 1 PPS signal (the act of writing a new time to the hardware registers arms the latch function in the hardware).  Once the new time is latched, the hardware automatically disables the time latch function to avoid the potential of latching in an old time at the next 1 PPS signal.will be received within one second.  In the unlikely event a UT Delta is discarded, an event message is enqueued to ccmErrEnq() for informational purposes.",0
"  The DPU-ICUI shall check the length of a received DPU_CMD against the message length determined by the Inter-Block Gap.  If the received value does not match, then the command will be discarded, and an error will be enqueued to DPU-CCM, and a NAK message transmitted to the ICU within a second.",The L1A/Geolocation software shall use HDF Version 4.1r1 for reading and writing all HDF files.  ,0
  The DPU-CCM shall provide the capability to echo to the spacecraft each received command from the spacecraft or the ICU.,"Time SynchronizationThe time contained in the Clock Message is specified to be valid on the rising edge of the next 1PPS signal.  When the DPU receives the Clock Message, the 1553 ISR calls the tisTimeSync() function, forwarding the data portion of the clock message to the TIS CSC via the TIS_CLK_MSG data structure..  The tisTimeSync() function will immediately copy the spacecraft clock value to the DPU clock hardware registers. The DPU hardware is designed to latch in the new time on the rising edge of the next 1 PPS signal (the act of writing a new time to the hardware registers arms the latch function in the hardware).  Once the new time is latched, the hardware automatically disables the time latch function to avoid the potential of latching in an old time at the next 1 PPS signal.will be received within one second.  In the unlikely event a UT Delta is discarded, an event message is enqueued to ccmErrEnq() for informational purposes.",0
  The DPU-BOOT CSC shall provide a monitor which accepts commands over the RS-232 interface.,"Setting Data Timeout in DCIDuring nominal operation, frames arrive approximately every 11 msecs.  The DCI hardware will generate an interrupt if event data has been received in one of the Ping-Pong buffers, and a configurable amount of time has passed during which no additional events have been received.  A data timeout interrupt is not an error, but rather typically indicates that the current exposure has been completed.  The data timeout interrupt allows the TMALI CSC to retrieve the trailing events from the DCI Ping-Pong buffer.  The function tmaliDciTimeoutSet() provides an API to the DCI Driver to allow the timeout setting to be altered.",0
" The DPU-SCUI shall be capable of preparing one STPDU for delivery to the SCU every M milliseconds, or shall indicate a No Data condition to the SCU by maintaining an un-incremented ST_PDU Transfer Request Counter field.","Control and Monitoringthe CCM Control Task initializes the DPU FSW. It is the responsibility of the CCM Control Task to establish a successful boot.  It does so by blocking on temporary semaphores, each with a 5 second timeout, after spawning the SCU Interface Task and the CCM Command Task.  If both of these tasks report a successful initialization by giving the semaphore, the CCM Control Task toggles the BC_INDEX parameter in EEPROM to indicate a successful boot.  If either task does not report a successful initialization, the CCM Control Task disables the watchdog strobe to effect a reboot of the DPU.  The rationale for selecting the successful initialization of these two tasks as the definition of a successful boot is that the DPU FSW requires these tasks, as a minimum, to establish ground contact and provide commandability.Once this initialization is complete, the task blocks on a binary semaphore which is given by the SCUI Command ISR upon arrival of the 1 Hz Clock Message.  In the event a Clock Message does not arrive, the semaphore will time out after 1.5 seconds.  The CCM Control Task remains alive to create and transmit DPU housekeeping at the appropriate intervals, perform various periodic processing tasks, and to process memory dump commands.The final call to ccmErrEnq() is performed in order that if an error occurs in an interrupt service routine, a global variable is set to the value of the errno which is then enqueued into the Error/Event Queue as part of this tasks normal processing.",0
  The DPU-BOOT CSC shall display a message via RS-232 on detection of a BIT failure.,The L1A/Geolocation software shall follow the coding standards established by the MODIS project in MODIS Software Development Standards and Guidelines  ,0
Each Software process shall handle input data sets with the following error attributes: Wrong format input files.,"Bootstrap MonitorThe Bootstrap Monitor checks entered commands for syntax and number of arguments, and displays an error message to the RS-232 interface if an invalid command or argument is entered.  A complete listing of these messages is given in document 7384-BSPS-01.",0
"  The DPU-ICUI shall check the length of a received DPU_CMD against the message length determined by the Inter-Block Gap.  If the received value does not match, then the command will be discarded, and an error will be enqueued to DPU-CCM, and a NAK message transmitted to the ICU within a second.","InitializationThe SCUI CSC is initialized when the scuiTask() is spawned by the CCM CSC.  Initialization parameters which are passed into the scuiTask() include:* Poll Rate  rate at which the S/C will poll the DPU for telemetry.  The rate is specified in Hz, and has a default of X Hz based on the INSTRUMENT X-DPU poll rate in the Company X 1553 ICD.* Buffer Rate  value used to rate buffer data to the S/C.  The rate is specified in bits per telemetry poll, and has a default of 7664 which is equal to one STPDU per poll (*** bytes per STPDU times V bits/byte).  This default value effectively disables rate buffering.* Size of Low Priority Queue  size in bytes of the low priority telemetry queue.  If the amount requested cannot be allocated, the buffer will be allocated at  the amount of memory contained in the largest free memory block.Size of High Priority Queue  size in bytes of the high priority telemetry queue. If the amount requested cannot be allocated, the buffer will be allocated at  the amount of memory contained in the largest free memory block.",0
 The DPU-SCUI shall report errors to the DPU-CCM for inclusion in the DPU Housekeeping information.,"Receiving Commands from the SpacecraftThe DPU/SCU interface specifies that commands for the DPU will be transmitted from the SCU to the DPU on a separate MIL-STD-1553 subaddress.  The SCU Interface Command Reader ISR, scuiCmdReadISR(). consists of an ISR installed on a specific MIL-STD-1553 subaddress corresponding to the command subaddress for the INSTRUMENT X DPU. This ISR is installed at initialization by scuiInit().  Upon interrupt, the scuiCmdReadISR() reads a single telecommand from the 1553 bus, checks the length and checksum, and then forwards valid commands to the Command and Control CSC for dispatch via ccmCmdEnq().  Errors are reported by incrementing an invalid command counter.",0
"  The DPU-CCM shall, in rejecting a command, report an error in DPU_HK indicating  the byte-code of the command being rejected in the LSB of the errno as described in 03691-DPUSDP-01.  ",Event ProcessingThe Event Processor Task is also responsible for creating the Finding Chart.  The Create Finding Chart Algorithm will use the Choose Guide Stars Algorithm to find the brightest stars in the finding chart Instrument Y.  The parameterized finding chart will be created by listing the X & Y detector location of each star along with a CxC pixel matrix around the star location of the intensities. The Event Processor Task will create the necessary housekeeping for the DPA.,0
  The DPU-ICUI shall report errors to DPU-CCM for inclusion in the DPU_HK.,"Data ProcessingThe DCX CSC is a task which receives data packages from other tasks, compresses the data using the VBTWL algorithm, and then forwards the compressed data package to the SCUI CSC.",0
  The DPU-SSI shall provide the capability for an application program to install a callback routine to respond to the receive IBG Interrupt.,Checksum LibraryThis function performs a checksum on a specified memory range.  The checksum is performed as an bit XOR.,0
" The DPU-SCUI shall cancel the write to each subaddress if the SCU fails to read a pending STPDU after a timeout specified by a value calculated based on the SCU_POLL_RATE parameter provided during initialization, shall record new data to those subaddresses, and report an error to the DPU-CCM.  The SCU_POLL RATE parameter shall have a default setting of J ms and shall be capable of being modified dynamically.","Public FunctionsThis routine provides a means for the CCM task to send the Stop Mode command from the ICU to the DPA software. The Stop Mode command shall be used to command the DPU to immediately stop processing events, complete the current data product, purge events from the DPU hardware, and enter Idle Mode.  The data product will include the actual exposure time and the number of frames.  In response to this command, the DPU shall issue a Mode Complete command to the ICU after finishing the before-mentioned tasks.",0
 The DPU-DCI shall provide an application program with the ability to toggle the hardware interface between Normal mode and Test mode.,"Telemetry Output to the Spacecraft 1553 BusThe SCU, which is a MIL-STD-1553 Bus Controller (BC), periodically reads the STPDU contained in the fifteen telemetry subaddresses, and then writes to the telemetry done subaddress.  When the telemetry done subaddress is written, the scuiTlmDoneISR() is called which gives a semaphore to awaken the scuiTask().  The software provides fault tolerance by automatically awaking after approximately two polling periods.  This timeout is automatically adjusted any time the SCU Poll Rate value is changed by command.",0
"The DPU-BOOT CSC shall perform successive writes to a word page of EEPROM within C msecs, or wait a minimum of D usecs between successive writes.","Data ProcessingThe DCX CSC is a task which receives data packages from other tasks, compresses the data using the VBTWL algorithm, and then forwards the compressed data package to the SCUI CSC.",0
 The DPU-SCUI shall be capable of receiving a telecommand from the SCU every N ms and forward it to DPU-CCM for processing.,"remaining DPU FSW tasksFollowing startup, the Command and Control Task spawns the remaining DPU FSW tasks, which are described below:* The Command Dispatch Task (ccmCmdTask) is an Application Framework Software task which is responsible for dispatching commands which arrive from the ICU or the SCU.  Commands are executed directly by this task by calling the applicable CSC function* The SCU Interface Task (scuiDPTask) receives telemetry data from other tasks, converts them to CCSDS Version1 Source Packets, forms Company X Telemetry Protocol Data Units (STPDUs) from the Source Packets, and transmits the STPDUs to the SCU via the MIL-STD-1553B Interface.* The Telescope Module Event Transfer Task (tmaliTask) is an Application Framework Software task which is responsible for transferring data from the DCI ping/pong buffers to the TMALI data buffer in response to a DCI frame limit or data timeout interrupt.* The Data Compression Task (dcxTask) receives telemetry data from other tasks, uses a lossless data compression algorithm to compress the data, and then enqueues the data to the SCU Interface Task.* The Data Processing Algorithms Tasks (dpaIMTask and dpaEPTask) process incoming detector events according to the commanded mode, create data products, and enqueue those data products to the Data Compression Task (if compression is enabled) or to the SCU Interface Task.* The Error Detection and Correction Memory Scrubber Task (edacTask) cycles through the text and data segments of the DPU to trigger the correction of single-bit errors which may have occurred, in order to help prevent the occurrence of uncorrectable multiple-bit errors.",0
Each MODIS standard data product shall be produced within the data volume and processing load allocation shown in Table B-1.,"Unmask VME Interrupts and Disallow Nested InterruptsThe device drivers do not automatically unmask VME interrupts at the processor.  This must be done separately since some VME interrupts may share an IRQ level. Finally, nested interrupt capability should be disabled since allowing for nested interrupts was not considered in the design of this FSW.  This is done by verifying that SYS_INT_MASK_0 and SYS_INT_MASK_1 are both defined to 0xffffffff in config.h.",0
  The DPU-RTOS shall provide a function to allow an application program to read from the Real-Time Clock registers on the RAD6000SC CPU Module.,"initial boot sequencethe initial boot sequence, identified as Boot Sequence 1.  This processing takes place when the Bootstrap executes from Programmable Read-Only Memory (PROM).  Boot Sequence 1 is composed primarily of 4 steps as follows.First, in this sequence, EEPROM is updated.  Then, CPU BIT and a portion of DRAM BIT is performed.  Next, DRAM is cleared.  Lastly, Boot Sequence 2 is copied to DRAM and executed. During this sequence, the rest of DRAM is tested if skipBit is not set.  Load parameters are put into registers r13, r14, r15 and r16.  DRAM is cleared up to memSize.  Lastly, either the DPU-RTOS or the Bootstrap Monitor is loaded and executed according to the load parameters.",0
"  The DPU-DPA shall collect event mode data, preserving the time and spatial resolution in the specified event window.",Shall detect corrupt converted_instrument_scan_data.converted_mirror_encoder_data.  ,0
" The DPU-ICUI shall install an ISR to be invoked on the SSI receiver interblock gap interrupt, for the receiving and processing of commands from the ICU.",Intensifier Characteristics (IC) Engineering ModeThe purpose of Intensifier Characteristics Engineering Mode is to assess detector health and performance. Detector events produced in Full Frame High Resolution detector format are collected and histogrammed for a commanded integration time to produce a pulse-height histogram.,0
"  When observing a new GRB, and the XRT_POS becomes available from the ICU, the DPU-DPA shall shift and resize the image and event windows appropriately.",Control and MonitoringThe DPU produces eight types of housekeeping packets.,0
Each software process shall perform quality checks on the input and output data and report on the degree to which the product conforms to instrument specification or science data accuracy specifications.,"Command and Control CSCThe Command and Control (CCM) CSC is a Level 2 reuse component from the INSTRUMENT Y project.  The Command and Control CSC includes the following components:* A Control Task, ccmCtrlTask(), which initializes the DPU FSW and spawns other tasks at bootup, schedules the production of DPU housekeeping data packets, monitors the execution of other tasks, and schedules the execution of other periodic tasks such as the heartbeat message and the watchdog strobe; and* A Command Dispatch Task, ccmCmdTask(), which receives and dispatches real-time commands received from the SCU or the ICU.Major data structures include:* A Static Data table that keeps track of the operational state.  Data included in this table includes housekeeping production rates, CCM specific flags, and the number of commands executed.* A Command Queue into which commands are placed when they arrive, via interrupt, from the ICU or the SCU.* An Error/Event Queue which accumulates error and event codes which are reported by the DPU FSW.  These error and event codes are removed from the queue and placed into a telemetry packet at a given interval and included in DPU housekeeping data.DPUSDS5.12.1.1.1Flight Software InitializationThe Command and Control CSC is initialized by spawning the CCM Control Task, ccmCtrlTask(), from the operating system startup task, usrRoot().  After the task is spawned it calls a function, ccmInit(), which creates the error/event queue, instantiates needed semaphores and installs various ISRs.  Finally, it spawns the remaining tasks which comprise the DPU FSW. When the CCM Control Task starts up, it reads DPU configuration startup defaults from the SYSTEM_CONFIG_AREA in EEPROM.  If the SYSTEM_CONFIG_AREA checksum is bad, hard-coded defaults are used.  The CCM Control Task initializes the remaining CSCs by calling the applicable initialization function, or if the CSC has an associated task, by spawning the task using the VxWorks function, taskSpawn().  When the CCM Control Task initializes a CSC, it passes the startup defaults read from EEPROM as parameters to the task initialization function. In addition to its task initialization activities, ccmInit(), also initializes the command length verification table by calling ccmCmdLengthInit().  The command processor uses the created table to verify expected command lengths for newly received commands.",0
  The DPU-TIS shall provide the capability for an application program to select the active 1PPS signal.,Intensifier Characteristics (IC) Engineering ModeThe purpose of Intensifier Characteristics Engineering Mode is to assess detector health and performance. Detector events produced in Full Frame High Resolution detector format are collected and histogrammed for a commanded integration time to produce a pulse-height histogram.,0
"The DPU-BOOT CSC shall perform successive writes to a word page of EEPROM within C msecs, or wait a minimum of D usecs between successive writes.","Time SynchronizationThe interface with the spacecraft as described in document 1143-EI-S19121 specifies that the spacecraft will provide a Clock Message to each Instrument at a 1 Hz rate.  The Clock Message contains both two values: a value representing the current spacecraft time, and a value representing the delta from the spacecraft time and the Univeral Time (UT), based on an epoch of TBD.",0
 The DPU-CCM shall use DPU-EEPRM to access the EEPROM.,"Standard I/O InterfaceThe read() primitive does not block.  The read() primitive is implemented by simply passing its parameters to the tyLib function tyRead().The size of the Rx ring buffer is specified in the call to ssiDevCreate() as part of the device instantiation.This routine returns either the number of bytes read, or ERROR.",0
"  Image mode shall have the ability to produce a Parameterized Finding Chart, PROD_FINDING_CHART, of the image if commanded, using the algorithm described in Appendix C.  The Parameterized Finding Chart shall consist of the brightest sources. Each source shall be parameterized by its position [X,Y] and Intensity/brightness.","initial boot sequencethe initial boot sequence, identified as Boot Sequence 1.  This processing takes place when the Bootstrap executes from Programmable Read-Only Memory (PROM).  Boot Sequence 1 is composed primarily of 4 steps as follows.First, in this sequence, EEPROM is updated.  Then, CPU BIT and a portion of DRAM BIT is performed.  Next, DRAM is cleared.  Lastly, Boot Sequence 2 is copied to DRAM and executed. During this sequence, the rest of DRAM is tested if skipBit is not set.  Load parameters are put into registers r13, r14, r15 and r16.  DRAM is cleared up to memSize.  Lastly, either the DPU-RTOS or the Bootstrap Monitor is loaded and executed according to the load parameters.",0
"  The DPU-RTOS shall be a real-time, multi-tasking operating system.","Public FunctionsThis routine returns OK, or ERROR and sets errno if the passed parameter is NULL.  The following error codes may be returned in errno ",0
 The DPU-SCUI shall receive command messages in the form of Telecommand Packets from the SCU and make them available to the DPU-CCM.,"Setting Frame Depth in DCIThe optimum frame depth will be determined with benchmark testing.  The default frame depth is 10 frames.  Given the above data, it will take approximately 24 msec to read 10 maximum-sized frames at the maximum data transfer rate.",0
Each software process shall trap and properly process all exceptions that may produce an abnormal terminationand report all such events using the SDPTK error message functions.,Hardware InterfacesThe DCI Driver CSC accesses each of the registers on the Company X Communications module using D16 VME access mode.  Reads from DCI memory are performed in VME D32 mode via a special assembly language routine which uses the lwm/stm instructions to minimize the transfer time.,0
 The DPU-TMALI shall configure the DCI interface data timeout at startup as specified by TMALI_TIMEOUT provided during initialization.  The default value shall be N milliseconds and shall be capable of being modified dynamically.,"Command HandlingWhen a command arrives from the SCU (via the 1553 interface) or the ICU (via the SSI interface), the respective ISR will enqueue the command packet into a Command Queue, and then give the semaphore to awaken the ccmCmdTask().  Since it is possible for the DPU to send a command to itself, commands may arrive at interrupt context or task context.  Therefore the CCM maintains two queues  one for interrupt context which is not semaphore protected, and one for task context which is semaphore protected.",0
 The DPU-TMALI shall configure the DCI interface data timeout at startup as specified by TMALI_TIMEOUT provided during initialization.  The default value shall be N milliseconds and shall be capable of being modified dynamically.,"Install Project-Specific Module Error IdentifiersIn order to provide a mechanism by which error numbers can be unique across device drivers and applications, each error number must contain a unique module identifier in the most significant word of the error number.  These module identifiers are defined in a VxWorks header file.",0
The DPU-BOOT CSC shall test and clear DRAM on power-on using the COLD_MEM_SIZE obtained from the SYSTEM_BLOCK.,"Public FunctionsWhen no data is available in the TMALI queue this routine blocks on a semaphore awaiting availability of events on the TMALI queue as indicated by the ISR.  When data is already available on the TMALI queue, or the semaphore is taken, the number of events on the TMALI queue is determined and returned to the caller.  The parameter TickstoWait specifies the maximum time which the function can wait until data becomes available in kernel-ticks.  The parameter may be set to a symbolic value FOREVER which causes the function only to return when data is available.  When the function is called with a timeout value and no data becomes avialable within that period the function will return zero (events available).If the tmali task has not been initialized the function returns an error.",0
" The DPU-SCUI  shall provide the capability to handle high priority data.  High priority data shall be processed before low priority data.  In the condition  that low priority data is being processed when new high priority data arrives, DPU-SCUI shall finish processing the low priority data and then  immediately shift all resources to processing the high priority data.",Install Exception HandlersThis routine installs a hook routine for the Memory Error Interrupt.  The hook routine will be called from the interrupt context.  This function returns OK always.,0
" The DPU-TMALI shall install callbacks for handling all DPU-DCI interrupts including Error interrupt, Ping-Pong Timeout interrupt, and Ping-Pong Complete Flag interrupt.","Public FunctionsThis routine initializes the interface to the ICU.  This routine opens SSI Driver port, installs the SSI interface interrupt callbacks, and enables Transmit Message Mode in the SSI Driver.",0
"The Bootstrap Monitor of the DPU-BOOT CSC shall follow the protocol specified in BSPS-01, Bootstrap Monitor Protocol Specification, with the following noted exceptions.","Public FunctionsThis function sets the frame depth of the Ping-Pong buffers used by the DCI CSC.  The frame depth determines how many frames are read into the selected Ping-Pong buffer before interrupting.  The initial value for the frame depth setting is determined by the parameter provided when starting the tmaliTask.  The maximum value to which the frame depth can be commanded is 64 frames, an attempt to command the frame depth to a value larger than this maximum will result in setting the timeout to the default value of V frames.The actual setting of the frame depth could be delayed by a small amount of time if there is activity on the DCI bus, and is typically changed when the DCI has just reported a frame level reached or timeout condition.  This minimizes the chance of changing the setting while the hardware is close to detecting a frame event.  Changing the frame depth while the DCI CSC is processing data could cause unpredictable results.  When a new tmaliDciFrameDepthSet command is send before the previous setting has been activated the new request will overwrite the previous request and the DCI will be commanded to the new value at the first available opportunity.",0
"The DPU-BOOT CSC shall perform successive writes to a word page of EEPROM within C msecs, or wait a minimum of D usecs between successive writes.","Time SynchronizationThe interface with the spacecraft as described in document 1143-EI-S19121 specifies that the spacecraft will provide a Clock Message to each Instrument at a 1 Hz rate.  The Clock Message contains both two values: a value representing the current spacecraft time, and a value representing the delta from the spacecraft time and the Univeral Time (UT), based on an epoch of TBD.",0
" There shall be four engineering modes associated with the detector: raw event list mode, channel boundary mode, centroid confirmation mode, and intensifier characteristics mode.","Standard I/O InterfaceThe read() primitive does not block.  A read is performed on the active portion of the H/W ping pong buffer using the RAD 6000 move-multiple instruction, referred to here after as a block move.  For optimum performance, the block move is implemented in assembler.  The number of bytes read is returned to the caller.",0
  The DPU-RTOS shall provide a function to allow an application program to read from the Real-Time Clock registers on the RAD6000SC CPU Module.,"Error Collection and ReportingAt boot time, no error queue exists because it has yet to be created.  Errors that occur in this early stage of error reporting are assigned directly to the global task variable errno.  The reader may refer to the VxWorks Programmers Guide, section 2.3.7 for more information on errno.  If errno is set after the error queues are created, it is queued to the Error Queue by calling ccmErrEnq(). ",0
  The DPU-BOOT CSC shall display a message via RS-232 on detection of a BIT failure.,"Standard I/O InterfaceThe write primitive does not block.  The buffer passed to write is written directly to the active portion of the ping pong buffer by the driver.  This primitive is valid only in TEST mode.  The write call will set errno to S_dci_MODE_ERROR and return ERROR if the driver is in NORMAL mode.  In TEST mode, the driver returns the number of bytes written.",0
  The DPU compression software shall forward compressed data  to DPU-SCUI.,Shall generate data_input_status_messages if errors are encountered in reading Level_1B_Data.  ,0
  The Bootstrap Monitor of the DPU-BOOT CSC shall provide the capability to download configurations of the DPU-RTOS from the RS-232 interface to EEPROM on command.,"Instrument Y ProcessingAt the end of an exposure, the Instrument Y in the accumulation buffer is transferred to the Instrument Y data product buffer one horizontal line at a time, starting at the top of the Instrument Y to form a PROD_INSTRUMENT Y data product.  This rasterized Instrument Y in the Instrument Y data product buffer will be enqueued for transmission to the spacecraft.",0
  The DPU-DPA shall calculate drift with respect to the reference frame based on the established guide stars then perform a shift-and-add of the image mode data.,"Public FunctionsThis routine provides a means to set the bit arrangement used by the DCI.  When bSpecialArrangement is TRUE, the DCI is set to special bit arrangement mode, otherwise the default mode of no rearrangement is set.",0
"  There DPU-DPA shall have three science modes, X, Y mode, and X/Y mode.","Sending Messages to the ICUSome special processing and checking is required in this function to handle the transmission of the ACK/NAK message.  When a command arrives from the ICU, the icuiCmdReceiveISR() will verify the message checksum and then send an ACK/NAK message to the ICU.  It is possible that an application is in the midst of sending a message to the ICU at the time a command interrupt occurs.  However, since it is not possible for an ISR to take a semaphore, an additional mechanism is required in order to provide mutual exclusion between a task an the ISR.  To accommodate this problem, the icuiEnq() function first determines whether it is being invoked from interrupt context.  If so, it then tests the value of a static variable, icuiEnqBusy.  If the variable is set, the function will save the given ACK/NAK message parameters in static variables and return.  If the variable is not set, the function will continue as normal (avoiding the semTake() and semGive() calls).  In normal execution, the icuiEnqBusy variable is set on entry and negated on exit, after which the static variables containing the ACK/NAK message parameters will be checked to determine whether an ACK/NAK is pending.",0
 The DPU-CCM shall provide a command to reboot the DPU.,"initial boot sequencethe initial boot sequence, identified as Boot Sequence 1.  This processing takes place when the Bootstrap executes from Programmable Read-Only Memory (PROM).  Boot Sequence 1 is composed primarily of 4 steps as follows.First, in this sequence, EEPROM is updated.  Then, CPU BIT and a portion of DRAM BIT is performed.  Next, DRAM is cleared.  Lastly, Boot Sequence 2 is copied to DRAM and executed. During this sequence, the rest of DRAM is tested if skipBit is not set.  Load parameters are put into registers r13, r14, r15 and r16.  DRAM is cleared up to memSize.  Lastly, either the DPU-RTOS or the Bootstrap Monitor is loaded and executed according to the load parameters.",0
  The DPU-DPA will complete the exposure in the time specified by the MODE command - even if it's required to truncate the final tracking frame.,Shall write Verify_MODIS_log_msgs to Log_messages when errors occur in the Verify_MODIS_header_info process. ,0
"  The DPU-BOOT CSC shall create a record of failed DRAM blocks, BIT_DRAM, in the SYSTEM_BLOCK.",The L1A/Geolocation software shall use all applicable mandatory SDPTK 5.2 routines and any additional SDPTK routines that are useful.  ,0
  The DPU-DCI shall write to the DCI Registers in C-bit words only,"Public FunctionsSets the poll rate and buffer rate to the given values.  If the values are out of range, the prior values are retained and an error is reported.  The scuiTask() semaphore timeout (scuiTaskTimeout) is automatically adjusted based on the given poll rate, by setting the timeout to approximately  the poll rate (not that the timeout is expressed in clock ticks, and so the resolution is low and only approximates  of the poll rate).",0
"  The DPU-CCM shall, in rejecting a command, report an error in DPU_HK indicating  the byte-code of the command being rejected in the LSB of the errno as described in 03691-DPUSDP-01.  ","ACS Message ProcessingThe SCUI task will send the ACS message to the DPA by calling the function dpaACSReceive().  Because the SCUI task will be calling dpaACSReceive() from an ISR, dpaACSReceive() must return quickly.  If commanded by the ICU in the Mode command, the ACS message will be saved along with the event data product.  To return quickly, dpaACSReceive() will place the ACS message in a data queue then return.  The Event Processor Task will remove the ACS messages from the queue and send them to the spacecraft.",0
 The DPU-CCM shall use DPU-ICUI to communicate with the ICU.,"Full-Frame (FF) Engineering ModeThe purpose of Full-Frame Engineering Mode is to monitor the health of the detector to locate hot spots and dead pixels. Detector events produced in Full Frame High Resolution detector format are received and histogrammed for a commanded integration time.  The entire Instrument Y is transmitted to the ground.  This mode can use high resolution (all pixels) or low resolution imaging (BxB , DxD pixel binning).",0
  The DPU-RTOS shall provide the capability to invoke user-installed Interrupt Service Routines (ISRs) in response to internal and external (VME) interrupts.,Real-Time Clock InterfaceThe Real-Time Clock (RTC) Registers of the RAD6000 are special-purpose registers not normally accessible to C language programs.  Some assembler wrapper functions provide access to these.  ,0
  The DPU-ADC shall create a fixed analog conversion scan list containing the A DPU analog values (active values plus one ground reference value).,"Receiving Commands from the SpacecraftThe DPU/SCU interface specifies that commands for the DPU will be transmitted from the SCU to the DPU on a separate MIL-STD-1553 subaddress.  The SCU Interface Command Reader ISR, scuiCmdReadISR(). consists of an ISR installed on a specific MIL-STD-1553 subaddress corresponding to the command subaddress for the INSTRUMENT X DPU. This ISR is installed at initialization by scuiInit().  Upon interrupt, the scuiCmdReadISR() reads a single telecommand from the 1553 bus, checks the length and checksum, and then forwards valid commands to the Command and Control CSC for dispatch via ccmCmdEnq().  Errors are reported by incrementing an invalid command counter.",0
The image mode shall shift successive frames according to the calculated spacecraft drift and co-add the frame into an accumulated image.,Hardware InterfacesThe SSI Driver CSC accesses each of the registers on the Company X Communications module using D16 VME access.,0
  The DPU-ADC shall create a fixed analog conversion scan list containing the A DPU analog values (active values plus one ground reference value).,"Data ProcessingData requiring compression is received via the dcxEnq() function, which has an API definition which matches the scuiEnq() API.  The DCX CSC handles the PKG_CTRL flags as described below:* PKG_COMPRESS  this flag is set to indicate if the package is actually compressed.* PKG_PRIORITY_HIGH  this flag is ignored by the DCX CSC but is forwarded to the SCUI CSC.* PKG_SEGMENT  this flag is ignored by the DCX CSC but is forwarded to the SCUI CSC.PKG_CHECKSUM  if set, the dcxEnq() function will compute a checksum which is appended to the data, and then the flag is negated.  The checksum will be compressed with the rest of the data, so that when the data is decompressed on the ground, the checksum can be recomputed and compared to provide a good indication of whether the decompressed copy of the data matches the original data set.",0
 The DPU-TMALI shall be capable of making data available from the DCI to DPU-DPA.  DPU-TMALI will populate a ring buffer with frames of data for application task retrieval.,The L1A/Geolocation software shall use HDF Version 4.1r1 for reading and writing all HDF files.  ,0
  The DPU-DCI shall provide the capability for an application program to receive data at a rate of A bytes per second over the DCI interface.,External Program InterfacesThis routine copies the BIT Results into bitHk for inclusion in the DPU Housekeeping.,0
  The DPU-BOOT CSC shall put the processor into diagnostic mode.,Shall generate data_input_status_messages and set scan_quality_flags if corrupted data values are detected.  ,0
  The DPU-DCI shall provide an application program with the capability to command the DCI hardware to reorder the bit sequence of each event's original Detector Electronics Output Format as it is received.,Watchdog LibraryThe DPU contains a hardware watchdog which must be strobed periodically in order to prevent a DPU reboot.  ,0
" The DPU-ICUI shall install an ISR to be invoked on the SSI receiver interblock gap interrupt, for the receiving and processing of commands from the ICU.","Install Project-Specific Module Error IdentifiersIn order to provide a mechanism by which error numbers can be unique across device drivers and applications, each error number must contain a unique module identifier in the most significant word of the error number.  These module identifiers are defined in a VxWorks header file.",0
" The DPU-CCM shall collect a TASK_HBEAT from  DPU-SCUI, DPU-CCM, DPU-DCX, DPU-TMALI, and DPU-DPA .  Non-responsive tasks will be reported in DPU_HK.","Instrument Y ProcessingThe Instrument Y Processor Task will perform tracking by breaking the exposure up into 10-second sub-exposures which are shifted and added into a final histogrammed Instrument Y.  Tracking is performed by choosing guide stars from the first 10-second Instrument Y of an exposure.  Then in each subsequent Instrument Y, these guide stars are found and the drift is determined by comparing the two Instrument Ys. The Instrument Y is then shifted by the determined drift and added to the previous Instrument Ys in the accumulation buffer.",0
 The DPU-CCM shall use DPU-EEPRM to access the EEPROM.,"Receiving Commands from the ICUThe interface to the ICU is via a synchronous serial interface (SSI) bus, which utilizes an inter-block gap (IBG) to delineate complete messages from one another.  The DPU hardware produces an interrupt when it detects an IBG, and the SSI Driver provides a mechanism by which an application can install an interrupt hook routine to respond to an IBG interrupt.  Upon initialization, the ICUI CSC installs a hook routine into the SSI Driver called icuiCommandReceiveISR(), which verifies the checksum of an incoming command, transmits an ACK/NAK message to the ICU, and then enqueues the command for later processing by calling ccmCmdEnq().  ",0
The DPU-BOOT CSC shall disable write-protection of the EEPROM on the SCM.,"Public FunctionsThis function sets the frame depth of the Ping-Pong buffers used by the DCI CSC.  The frame depth determines how many frames are read into the selected Ping-Pong buffer before interrupting.  The initial value for the frame depth setting is determined by the parameter provided when starting the tmaliTask.  The maximum value to which the frame depth can be commanded is 64 frames, an attempt to command the frame depth to a value larger than this maximum will result in setting the timeout to the default value of V frames.The actual setting of the frame depth could be delayed by a small amount of time if there is activity on the DCI bus, and is typically changed when the DCI has just reported a frame level reached or timeout condition.  This minimizes the chance of changing the setting while the hardware is close to detecting a frame event.  Changing the frame depth while the DCI CSC is processing data could cause unpredictable results.  When a new tmaliDciFrameDepthSet command is send before the previous setting has been activated the new request will overwrite the previous request and the DCI will be commanded to the new value at the first available opportunity.",0
"  Image mode shall have the ability to produce a Parameterized Finding Chart, PROD_FINDING_CHART, of the image if commanded, using the algorithm described in Appendix C.  The Parameterized Finding Chart shall consist of the brightest sources. Each source shall be parameterized by its position [X,Y] and Intensity/brightness.","InitializationThe DPU-BIT should be initialized every time the DPU boots.  The startup task, usrRoot() should call bitPart1() before initializing the device drivers and bitPart2() after initializing EDAC and the device drivers.",0
  The DPU-CCM shall maintain counts of both the number of commands successfully received and rejected and report the parameters in DPU_HK.,HousekeepingThe TMALI CSC collects housekeeping data that can be retrieved via a call to tmaliHkGet().   TMALI CSC housekeeping is returned via the TMALI_HK data structure.,0
"  The DPU-RTOS shall exclude failed DRAM from the system memory pool based on the contents of the BIT_DRAM results in the SYSTEM_BLOCK.  The system memory table does not include the Interrupt Vector Table (IVT), nor the text and data segment.","Transmitting Telemetry to the SpacecraftThe SCUI CSC receives telemetry as input Data Packages via queues populated by other tasksthe Science Data Processing Task, the Data Compression Task, and the Command and Control Task.  The SCUI CSC has a High Priority Queue and a Low Priority Queue.  The two queues are implemented in an identical manner with the exception that the scuiTask() gives processing preference to the High Priority Queue.  The purpose of the High Priority Queue is to provide a means by which the Parameterized Finding Chart and DPU housekeeping can be transmitted to the SCU ahead of the potentially large amounts of buffered science data.",0
 The DPU-CCM shall use DPU-ICUI to communicate with the ICU.,"InitializationThe TMALI CSC is initialized by spawning the tmaliTask() with the startup default parameters.  This task will allocate memory for the TMALI_EVENT_QUEUE, install DCI ISRs, initialize static variables and data structures, and then enter an end-less loop in which it transfers the data from the DCI to the TMALI queue, throttled by the semaphore semDciWait.",0
  The DPU-SSI shall provide the capability for an application program to enable/disable the VME Slave Interrupt on the SCM for the SSI Interface.,"Data Transfer to QueueDuring initialization, the TMALI CSC installs an ISR hook routine, tmaliTransferToQueueISR(),  into the DCI Driver which is invoked when:* the DCI interface reaches the programmed frame limit in the Ping-Pong buffer, or* the DCI interface detects a data receipt timeout.",0
"  The DPU-1553 CSC shall address hardware modules as defined in document 1400, Company X Specification for the Company X Communication/Memory Module.","Public FunctionsThis routine is called by any CSC in order to report an error or event that should be included in DPU housekeeping.  If this routine is called from interrupt context a static global variable, ccmISRError, is set so that the error can be enqueued later (see ccmCtrlTask()).  This is done since the error/event queue is semaphore-protected and a semaphore cannot be taken in an ISR.  The error queue semaphore has priority inversion set to reduce conflicts between multiple callers should a priority inversion situation arise. This routine also replaces frequently occuring errors with a special repeat error code.  The repeat error code is a special error code that follows a normally reported error code to indicate that the normally reported error code previously reported has occurred more than once in the last high rate reporting period",0
Each MODIS Standard Product shall contain ECS core metadata with the content and format specified in DID 311.,"Command HandlingCommands are dequeued from the Command Queue and executed by the Command Dispatch Task, ccmCmdTask().  This task blocks on a semaphore which is given by ccmCmdEnq(). The ccmCmdTask() wakes on the semaphore and calls ccmCmdProcess() to process waiting commands.  The ccmCmdProcess() function subsequently retrieves waiting commands from the Command Queue and invokes ccmCmdDispatch() to verify the expected length of the command and execute it.  If command echo is enabled, ccmCmdDispatch() will call ccmHkMkCmdEcho() to blindly echo the command back to the ground.  Counts for both rejected and executed commands are maintained. If the command sent to ccmCmdEnq() is either a 1 Hz Clock Time message or an Attitude message from the spacecraft, the command will not be forwarded to the Command Queue, but instead will be executed directly while still in interrupt context.  Attitude messages are forwarded to dpaCommandSend(), while the 1 Hz Clock Time messages parameters are passed to tisTimeSync() in order to synchronize the current time.  Any other non DPU or spacecraft observatory messages are quietly discarded without reporting an error.In order to guarantee that ccmCmdTask() task reports in with the CCM Control Task periodically in absence of a ground command, the semaphore has a timeout value of 20 seconds.  If the semaphore times out, the task will verify no commands are on the Command Queue, and then report in to the CCM Control Task by calling ccmTaskReport().",0
  The DPU-BOOT CSC shall attempt to complete its normal execution sequence following detection of any failure.,"Event ProcessingThe Event Processor Task, after receiving a Mode command from the ICU, configures the DPU DCI hardware, responds to the ICU with a Mode Ready message then receives detector events by calling functions tmaliWait() and tmaliNextEvent().  The Event Processor Task will collect detector events for the time period specified in the Mode command then issue a Mode Complete message to the ICU.  After issuing the Mode Complete message, the Event Processor Task will enter the Idle state.",0
 The DPU-TMALI shall configure the ping-pong frame limit at startup as specified by TMALI_PP_LIMIT provided during initialization.  The default value shall be M frames and shall be capable of being modified dynamically.,"Receiving Commands from the SpacecraftThe DPU/SCU interface specifies that commands for the DPU will be transmitted from the SCU to the DPU on a separate MIL-STD-1553 subaddress.  The SCU Interface Command Reader ISR, scuiCmdReadISR(). consists of an ISR installed on a specific MIL-STD-1553 subaddress corresponding to the command subaddress for the INSTRUMENT X DPU. This ISR is installed at initialization by scuiInit().  Upon interrupt, the scuiCmdReadISR() reads a single telecommand from the 1553 bus, checks the length and checksum, and then forwards valid commands to the Command and Control CSC for dispatch via ccmCmdEnq().  Errors are reported by incrementing an invalid command counter.",0
"  The DPU-DPA shall collect event mode data, preserving the time and spatial resolution in the specified event window.",Shall verify that the Spacecraft_indicator contained in the Level1A_Parameters is consistent with the Spacecraft_indicator found in the Level 0 file header.  ,0
 The DPU-TMALI  shall provide TMALI_HK to the DPU-CCM on request.,Hardware InterfacesThe SSI Driver CSC accesses each of the registers on the Company X Communications module using D16 VME access.,0
The DPU-BOOT CSC shall wait a minimum of C msecs after a write to EEPROM before performing a read from EEPROM.,"Public FunctionsThis routine returns OK, or ERROR and sets errno if the passed parameter is NULL.  The following error codes may be returned in errno ",0
  The DPU-BOOT CSC shall attempt to complete its normal execution sequence following detection of any failure.,"Telemetry Output to the Spacecraft 1553 BusThe SCU, which is a MIL-STD-1553 Bus Controller (BC), periodically reads the STPDU contained in the fifteen telemetry subaddresses, and then writes to the telemetry done subaddress.  When the telemetry done subaddress is written, the scuiTlmDoneISR() is called which gives a semaphore to awaken the scuiTask().  The software provides fault tolerance by automatically awaking after approximately two polling periods.  This timeout is automatically adjusted any time the SCU Poll Rate value is changed by command.",0
  The DPU-TMALI shall provide a function which sets the current event bit ordering mode in the DCI driver.,"Analog to Digital Converter Driver CSCThe Analog to Digital Converter (ADC) Driver CSC is a new driver which controls and retrieves data from the ADC hardware.  The key elements of the ADC driver include:* A list (array of ADC_LIST_ENTRY) which maintains the setup information and current value (ADC_VALUE) for each of the 24 ADC values. * An API function, adcUpdateNext(), which causes a single ADC_VALUE to be updated every other call to the driver.  A value is updated every other call since each value requires a multiplexer settle time as well as an ADC conversion time.  In order to keep the driver simple, the responsibility for implementing the correct settle time and conversion time rests with the application.* An API function, adcGet(), which returns a copy of the current list of ADC_VALUEs.",0
" The channel boundary engineering mode shall create an array of look-up table (LUT) channel boundaries, PROD_CHAN_BOUND, from a flat field, and PROD_MN_DATA, using the algorithm described in Appendix C.",Data Capture Interface Driver CSCThe Data Capture Interface (DCI) Driver CSC is a new driver which provides a standard VxWorks driver interface to the DCI hardware.  The driver features two modes: a test mode and a normal mode.,0
"  The Bootstrap CSC shall address hardware modules as defined in document 1400, Company X Specification for the Company X Communication/Memory Module.","Transmit Message Mode(FIOSSIBGTXMSGENABLE) and Inter-Block Gap interruptsThe SSI Driver CSC supports a message mode to facilitate application level communication.  This mode uses the Inter-Block Gap interrupt generated by the hardware to synchronize message transmission. When in a messaging mode, the driver enables an internal Byte Count queue provides a synchronization mechanism for sending messages.  This Byte Count queue is updated with the message size as Inter-Block Gap interrupts are received. The Transmit Message Mode uses the BGTX interrupt, the Tx FIFO Empty Interrupt, the write() call, and an internal Byte Count queue to synchronize the transmission of messages over SSI.  In this mode, the maxBytes parameter passed to write() is enqueued to the Byte Count queue.  When a period of time equal to or greater than the Interblock Gap time has expired, the BGTX interrupt will be asserted.  At this time, the driver will respond and initiate a new transfer by setting a Byte Transfer Limit for this block and enabling the Tx FIFO Empty Interrupt.  The Byte Transfer Limit corresponds to the entry on the Byte Count queue.  When all bytes in the current block have been sent up to the Byte Transfer Limit, the Tx FIFO ISR will disable itself and reset the Byte Transfer Limit to zero. An application may use this mode by calling write() with a buffer pointer and maxBytes in order to transfer a message of a particular length.",0
Each Software process shall handle input data sets with the following error attributes: Corrupted data as indicated by Quality Assurance (QA) flags also located within the file.,Shall write Verify_MODIS_log_msgs to Log_messages when errors occur in the Verify_MODIS_header_info process. ,0
  The DPU-DPA shall be capable of collecting detector events over the full  FOV.,"Telescope Module Access Library and Interface CSCThe TMALI CSC includes the following components:* A queue, TMALI_EVENT_QUEUE, implemented using a ring buffer, which contains the detector events which have been received over the data capture interface from the DCI Driver, but which have not yet been retrieved by the DPA CSC;* An API which facilitates the retrieval of detector events from the queue by the DPA CSC.  The API consists of the tmaliNextEvent() and tmaliWait() functions.* An set of API functions used by the DPA CSC to configure the DCI interface, including tmaliBitArrangementSet(), tmaliDciFrameDepthGet(), tmaliDciFrameDepthSet(), tmaliDciWindowSet(), tmaliDataTimeoutSet(), and tmaliDataTimeoutGet().* An API housekeeping function, tmaliHkGet(), which gathers  CSC housekeeping data at the request of the Command and Control Task.* The task tmaliTask() and an ISR tmaliTransferToQueueISR() work together via a semaphore to synchronize the transfer of data from the DCI to the  queueAn error handling ISR, tmaliDciErrorReportedISR(), is installed as a hook routine to the DCI Driver, and is used to keep track of the number of errors reported by the DCI driver.",0
 The DPU-TMALI shall allocate a ring buffer of size specified by TMALI_BUFFER_SIZE provided during initialization for storing incoming frames of data.  The default buffer size shall be 15 MB.,"Data Transfer to QueueWhen the tmaliTransferToQueueISR() ISR is invoked, it gives a semaphore to awaken tmaliTask() that will transfer data to the  queue over the VME bus.  The tmaliTask() uses the read() function in the DCI Driver, which implements a data transfer using a high speed assembly language routine.  Because the TMALI ring buffer is implemented as an array, the tmaliTask() function must first examine the TMALI_EVENT_QUEUE to determine whether the data resident in the DCI buffer can be retrieved using a single read() call, or whether two calls are required in order to correctly handle the wrap-around case at the end of the ring buffer.  In addition, the tmaliTask() function must perform an error check to verify that there is sufficient space to receive the data available in the Ping-Pong buffer.  If there is insufficient space for the complete set of frames, the entire contents of the readable Ping-Pong buffer are discarded and the error S_TMALI_QUEUE_FULL is reported using ccmErrEnq mechanism.  Such discarded data constitutes an integral number of CCD frames, since the DCI hardware design ensures that Ping-Pong transitions occur at CCD frame boundaries.  This policy of discarding the newer data supports the scientific viewpoint that events collected right after a burst have more scientific value than events collected later.",0
"  The Intensifier Characteristics Engineering mode shall produce a pulse-height histogram, PROD_INTENSE_CHAR.",Setting DCI Bit ArrangementThe bit arrangement of the DCI control/status register can be set via tmaliBitArrangementSet().,0
  The DPU-DPA shall be capable of providing DPA_HK on request.,"Initialization The task invokes the initialization function scuiInit() which sets an instance variable, allocates ring buffers and semaphores for the Low and High Priority Telemetry Queues, initializes a buffer and semaphore for pending RT-RT command messages, creates the scuiTask() wakeup semaphore, initializes internal data structures, opens and initializes file descriptors for each of the required MIL-STD-1553 subaddresses and installs ISRs.  When the CCM CSC spawns the scuiTask(), it will block on a semaphore (ccmSemScuiSpawn) awaiting SCUI initialization.  Once initialization is complete, the SCUI CSC will signal successful initialization by giving the semaphore, and then write an empty STPDU to the 1553 shared memory.",0
  The DPU-ADC shall write to the SCM registers in B-bit words only.,Shall detect corrupt converted_instrument_scan_data.converted_mirror_encoder_data.  ,0
  The DPU-ADC shall read from the SCM registers in B-bit words only.,"DRAM BITPart of the memory is tested in Boot Sequence 1, and part of the memory is tested during Boot Sequence 2.  During Boot Sequence 1, ? KB of DRAM is tested before the Bootstrap is copied to this area.  During Boot Sequence 2, the  remaining memory is tested in ? KB blocks. The DRAM BIT first writes the address of each word in a block to that word in the block.   Then the test flushes the cache and reads back the entire block.  If a single-bit error occurs on the read-back, the location is read again.  If another single-bit error occurs, the test assumes a hard error and marks the whole block bad.  If a multiple-bit error occurs, the whole block is marked bad.  If the value read back does not match the address, the whole block is marked bad.  This same process is repeated with the ones complement of the address. The Bootstrap stores the results of the DRAM BIT in EEPROM as a series of x consecutive y-bit words.  Each bit in a result word represents the result of testing a ? KB block of DRAM.  These bits are mapped to DRAM by proceeding from least-significant bit (LSb) to most-significant bit (MSb) as the addresses of the memory blocks increase.  A set bit indicates that a block of DRAM has failed.  A clear bit indicates that a block of DRAM has passed the test.",0
The DPU-BOOT CSC shall enable EDAC on the SCM.,The L1A/Geolocation software shall follow the coding standards established by the MODIS project in MODIS Software Development Standards and Guidelines  ,0
 The DPU-TMALI shall be capable of making data available from the DCI to DPU-DPA.  DPU-TMALI will populate a ring buffer with frames of data for application task retrieval.,"Time Interface ConfigurationThe TIS CSC provides three functions for use by the CCM command dispatcher to control these values:* tis1ppsSet()  select active A PPS signal,* tisSyncModeSet()  set whether manual clock jamming is enabled, and        tisTimeSet()  manually jam a value into the DPU clock.",0
  The Bootstrap Monitor of the DPU-BOOT CSC shall output an error message to the RS-232 interface if an incorrect number of command arguments are entered.,"Ring buffer data structureThe  CSC maintains a FIFO implemented as a ring buffer to temporarily store the data received from the DCI before it is processed. The ring buffer uses two pointers called pIn and pOut to keep track of the data in the buffer. The pointers were defined such that reading from the buffer is the simplest operation and only a single compare is needed to verify if the buffer is empty. The buffer only stores Events so the pointers point to these four byte entities. As the DCI specifies all data in bytes, sizes have to be converted before reading data.",0
  Tthe DPU-CCM shall create DPU_HK_START and forward it to DPU-SCUI at bootup.,Public FunctionsThis routine is spawned by the Command and Control Task to initialize and execute the DPA Event Processing Task.,0
 The DPU-CCM shall notify the ICU upon completion of boot and flight software initialization.,Watchdog LibraryThis function strobes the system watchdog to prevent a watchdog reset.,0
  The DPU-DCI shall write to the DCI Memory in B-bit words only.,Shall detect corrupt converted_instrument_scan_data.converted_mirror_encoder_data.  ,0
  The DPU-TIS shall provide the capability for application programs to access the SC_TIME from the SCM.,Hardware InterfacesThe SSI Driver CSC accesses each of the registers on the Company X Communications module using D16 VME access.,0
" The channel boundary engineering mode shall create an array of look-up table (LUT) channel boundaries, PROD_CHAN_BOUND, from a flat field, and PROD_MN_DATA, using the algorithm described in Appendix C.","Public FunctionsOperationally, the DPU uses the Jam bit in the DCI CSR to indicate whether the DPU is actively syncing its clock with the spacecraft or not.  This function sets the Jam bit if autoSync is FALSE, and negates the Jam bit otherwise. THIS FUNCTION ALTERS THE VALUE OF THE DCI CSR AND SHOULD NOT BE INVOKED WHEN DCI INTERRUPTS ARE ACTIVE.",0
"  When commanded to event mode by the ICU,  the DPU-DPA shall be capable of collecting time-tagged photon events and producing a PROD_EVENT.","Unmask VME Interrupts and Disallow Nested InterruptsThe device drivers do not automatically unmask VME interrupts at the processor.  This must be done separately since some VME interrupts may share an IRQ level. Finally, nested interrupt capability should be disabled since allowing for nested interrupts was not considered in the design of this FSW.  This is done by verifying that SYS_INT_MASK_0 and SYS_INT_MASK_1 are both defined to 0xffffffff in config.h.",0
 The DPU-SCUI shall receive command messages in the form of Telecommand Packets from the SCU and make them available to the DPU-CCM.,Control and MonitoringThe DPU produces eight types of housekeeping packets.,0
  The Bootstrap Monitor of the DPU-BOOT CSC shall validate commands entered for syntax and number of arguments.,"Telemetry Output to the Spacecraft 1553 BusThe SCU, which is a MIL-STD-1553 Bus Controller (BC), periodically reads the STPDU contained in the fifteen telemetry subaddresses, and then writes to the telemetry done subaddress.  When the telemetry done subaddress is written, the scuiTlmDoneISR() is called which gives a semaphore to awaken the scuiTask().  The software provides fault tolerance by automatically awaking after approximately two polling periods.  This timeout is automatically adjusted any time the SCU Poll Rate value is changed by command.",0
  The DPU-EDAC shall contain a background task which walks DRAM to trip single-bit errors (SBEs).,"Telemetry Output to the Spacecraft 1553 BusThe SCU, which is a MIL-STD-1553 Bus Controller (BC), periodically reads the STPDU contained in the fifteen telemetry subaddresses, and then writes to the telemetry done subaddress.  When the telemetry done subaddress is written, the scuiTlmDoneISR() is called which gives a semaphore to awaken the scuiTask().  The software provides fault tolerance by automatically awaking after approximately two polling periods.  This timeout is automatically adjusted any time the SCU Poll Rate value is changed by command.",0
  The DPU-CCM shall process real-time non-deferred commands within B ms of receipt from the ICU or the SCU.,"Public FunctionsThis routine initializes the interface to the ICU.  This routine opens SSI Driver port, installs the SSI interface interrupt callbacks, and enables Transmit Message Mode in the SSI Driver.",0
  The DPU-BOOT CSC shall attempt to complete its normal execution sequence following detection of any failure.,Standard I/O InterfaceSSI ioctl() commands.,0
 The DPU-SCUI shall time stamp the secondary header of the Source Packets with the current SC_TIME retrieved from the DPU-TIS module.,SCU Interface CSCThe SCU Interface (SCUI) CSC is a Level 3 reuse component from the INSTRUMENT Y project.  The SCUI CSC is primarily responsible for implementing the application protocol with the SCU. The SCUI CSC provides CCSDS packetization services and manages the interface between the DPU and the SCU.,0
  The DPU-DPA will obtain the initial tracking frame time from the ICU.,Shall verify that the Spacecraft_indicator contained in the Level1A_Parameters is consistent with the Spacecraft_indicator found in the Level 0 file header.  ,0
  The DPU-SSI shall provide the capability for an application program to enable/disable the VME Slave Interrupt on the SCM for the SSI Interface.,"Standard I/O InterfaceThe write primitive does not block.  The buffer passed to write is written directly to the active portion of the ping pong buffer by the driver.  This primitive is valid only in TEST mode.  The write call will set errno to S_dci_MODE_ERROR and return ERROR if the driver is in NORMAL mode.  In TEST mode, the driver returns the number of bytes written.",0
  The DPU-SSI shall read from the SSI registers in 16-bit words only.,"Receiving Commands from the SpacecraftThe DPU/SCU interface specifies that commands for the DPU will be transmitted from the SCU to the DPU on a separate MIL-STD-1553 subaddress.  The SCU Interface Command Reader ISR, scuiCmdReadISR(). consists of an ISR installed on a specific MIL-STD-1553 subaddress corresponding to the command subaddress for the INSTRUMENT X DPU. This ISR is installed at initialization by scuiInit().  Upon interrupt, the scuiCmdReadISR() reads a single telecommand from the 1553 bus, checks the length and checksum, and then forwards valid commands to the Command and Control CSC for dispatch via ccmCmdEnq().  Errors are reported by incrementing an invalid command counter.",0
"Each software process shall be able to process input data sets with the following nominal attributes: Time transitions, including Greenwich Meridian crossing, leap year, beginning of the year, beginning of the millennium, and/or startof data collection not on a granule boundary.  Terminator crossing , International Date Line crossing, and/or Earth pole within a granule.  Day, Night, or mixed  mode data.","Sending Messages to the ICUIn order to send messages to the ICU, the DPU FSW tasks call icuiEnq().  The calling application passes the function code of the message to be sent, as well as a pointer to a data structure containing the message parameters associated with the given function code.  The icuiEnq() function formats the message according to the ICU/DPU ICD using icuiMsgFormat(), and then writes the message to SSI Driver transmitter buffer by calling the driver write() function. A mutual exclusion semaphore, icuiSemWrite, protects the SSI Driver from being written by multiple tasks simultaneously.  A timeout parameter lets the caller control how long it is willing to block on this semaphore if there is an access conflict.",0
 The DPU-CCM shall notify the ICU upon completion of boot and flight software initialization.,HousekeepingThe TMALI CSC collects housekeeping data that can be retrieved via a call to tmaliHkGet().   TMALI CSC housekeeping is returned via the TMALI_HK data structure.,0
" At startup, the DPU-RTOS shall execute the BIT device RAM tests (cold boot only), install device drivers, execute the BIT driver loopback tests (cold boot only), and then spawn the application flight software.",The L1A/Geolocation software shall use all applicable mandatory SDPTK 5.2 routines and any additional SDPTK routines that are useful.  ,0
"  The DPU-BOOT CSC shall include a CPU BIT consisting of a branch test, a fixed point test, a floating point test, an interrupt test, a timer test, and a register test.","Telemetry Output to the Spacecraft 1553 BusThe SCU, which is a MIL-STD-1553 Bus Controller (BC), periodically reads the STPDU contained in the fifteen telemetry subaddresses, and then writes to the telemetry done subaddress.  When the telemetry done subaddress is written, the scuiTlmDoneISR() is called which gives a semaphore to awaken the scuiTask().  The software provides fault tolerance by automatically awaking after approximately two polling periods.  This timeout is automatically adjusted any time the SCU Poll Rate value is changed by command.",0
  The DPU-BIT shall test the Error Detection and Correction (EDAC) on the Company X Communication/Memory Module by reading preprogrammed error locations in PROM.,Error Detection and Correction CSCThe Error Detection and Correction (EDAC) CSC is a Level 1 reuse component from the SSFF and INSTRUMENT Y projects.  The EDAC CSC consists of a set of Interrupt Service Routines (ISRs) and a Memory Scrubber Task.  The design of the INSTRUMENT Y EDAC CSC is described in document CIDPSDS-01.The only design change was to add logic to check for excessive external (SCM) EDAC interrupts.,0
 The DPU-CCM shall provide a mechanism for other CSCs to report errors for inclusion in the DPU_HK.,"Data ProcessingThe DCX CSC is a task which receives data packages from other tasks, compresses the data using the VBTWL algorithm, and then forwards the compressed data package to the SCUI CSC.",0
 The DPU-DPA shall be able to perform tracking based on data collected from the detector by calculating the spacecraft drift using successive tracking frames using the algorithm described in Appendix C.,"DRAM BITPart of the memory is tested in Boot Sequence 1, and part of the memory is tested during Boot Sequence 2.  During Boot Sequence 1, ? KB of DRAM is tested before the Bootstrap is copied to this area.  During Boot Sequence 2, the  remaining memory is tested in ? KB blocks. The DRAM BIT first writes the address of each word in a block to that word in the block.   Then the test flushes the cache and reads back the entire block.  If a single-bit error occurs on the read-back, the location is read again.  If another single-bit error occurs, the test assumes a hard error and marks the whole block bad.  If a multiple-bit error occurs, the whole block is marked bad.  If the value read back does not match the address, the whole block is marked bad.  This same process is repeated with the ones complement of the address. The Bootstrap stores the results of the DRAM BIT in EEPROM as a series of x consecutive y-bit words.  Each bit in a result word represents the result of testing a ? KB block of DRAM.  These bits are mapped to DRAM by proceeding from least-significant bit (LSb) to most-significant bit (MSb) as the addresses of the memory blocks increase.  A set bit indicates that a block of DRAM has failed.  A clear bit indicates that a block of DRAM has passed the test.",0
  The DPU-BOOT CSC shall provide the capability to automatically load a configuration of DPU-RTOS from EEPROM to DRAM and start its execution.,"Public FunctionsSets the poll rate and buffer rate to the given values.  If the values are out of range, the prior values are retained and an error is reported.  The scuiTask() semaphore timeout (scuiTaskTimeout) is automatically adjusted based on the given poll rate, by setting the timeout to approximately  the poll rate (not that the timeout is expressed in clock ticks, and so the resolution is low and only approximates  of the poll rate).",0
  The DPU-RTOS shall install an hook routine which is invoked on system exception which shall attempt to record the interrupt vector to the LAST_BOOT_IVEC location in EEPROM prior to reboot.,"Receiving Commands from the SpacecraftThe DPU/SCU interface specifies that commands for the DPU will be transmitted from the SCU to the DPU on a separate MIL-STD-1553 subaddress.  The SCU Interface Command Reader ISR, scuiCmdReadISR(). consists of an ISR installed on a specific MIL-STD-1553 subaddress corresponding to the command subaddress for the INSTRUMENT X DPU. This ISR is installed at initialization by scuiInit().  Upon interrupt, the scuiCmdReadISR() reads a single telecommand from the 1553 bus, checks the length and checksum, and then forwards valid commands to the Command and Control CSC for dispatch via ccmCmdEnq().  Errors are reported by incrementing an invalid command counter.",0
  The DPU-DCI shall provide the capability for an application program to receive data at a rate of A bytes per second over the DCI interface.,HousekeepingThe TMALI CSC collects housekeeping data that can be retrieved via a call to tmaliHkGet().   TMALI CSC housekeeping is returned via the TMALI_HK data structure.,0
" The DPU-SCUI shall be capable of preparing one STPDU for delivery to the SCU every M milliseconds, or shall indicate a No Data condition to the SCU by maintaining an un-incremented ST_PDU Transfer Request Counter field.","Public FunctionsThis routine provides a means to set the data timeout used by the DCI, the value requested indicates the timeout in milliseconds.  The initial value for the frame depth setting is determined by the parameter provided when starting the tmaliTask.  The maximum value to which the timeout can be commanded is X seconds, an attempt to set the timeout to a number larger than this maximum will result in setting the timeout to the default value of X milliseconds",0
  The DPU-BOOT CSC shall include a DRAM BIT consisting of two write/read/compare tests.  The first test shall write the address of each memory location to that location.  The second test shall write the complement of each memory location to that location.,"Sending Messages to the ICUSome special processing and checking is required in this function to handle the transmission of the ACK/NAK message.  When a command arrives from the ICU, the icuiCmdReceiveISR() will verify the message checksum and then send an ACK/NAK message to the ICU.  It is possible that an application is in the midst of sending a message to the ICU at the time a command interrupt occurs.  However, since it is not possible for an ISR to take a semaphore, an additional mechanism is required in order to provide mutual exclusion between a task an the ISR.  To accommodate this problem, the icuiEnq() function first determines whether it is being invoked from interrupt context.  If so, it then tests the value of a static variable, icuiEnqBusy.  If the variable is set, the function will save the given ACK/NAK message parameters in static variables and return.  If the variable is not set, the function will continue as normal (avoiding the semTake() and semGive() calls).  In normal execution, the icuiEnqBusy variable is set on entry and negated on exit, after which the static variables containing the ACK/NAK message parameters will be checked to determine whether an ACK/NAK is pending.",0
" At startup, the DPU-RTOS shall execute the BIT device RAM tests (cold boot only), install device drivers, execute the BIT driver loopback tests (cold boot only), and then spawn the application flight software.","Command HandlingThe DPU accepts commands via two interfaces  from the Spacecraft via the MIL-STD-1553 interface, and from the ICU via the SSI interface.  Any of the DPU commands can be sent from the SCU or the ICU.  The source for a command from the DPU is one of the following:* ICU  command is generated and sent by the ICU via the SSI.* SCU  command is generated and sent by the SCU via the 1553.* G-ICU  command is generated on the ground and sent to the DPU via the ICU/SSI.* G-SCU  command is generated on the ground and sent to the DPU via the SCU/1553.",0
 The DPU-CCM shall record an error to the LAST_BOOT_IVEC location in EEPROM and discontinue strobing the Watchdog Timer should an unrecoverable software error occur.  An unrecoverable software error is defined as an error that causes a loss of commandability or ground communication.,Telescope Module Access Library and Interface CSCThe Telescope Module Access Library and Interface (TMALI) CSC manages the detector event queue and provides an API for the retrieval of detector events from that queue to the data processing algorithms.,0
"  The DPU-BOOT CSC shall include a CPU BIT consisting of a branch test, a fixed point test, a floating point test, an interrupt test, a timer test, and a register test.","Command HandlingThe DPU accepts commands via two interfaces  from the Spacecraft via the MIL-STD-1553 interface, and from the ICU via the SSI interface.  Any of the DPU commands can be sent from the SCU or the ICU.  The source for a command from the DPU is one of the following:* ICU  command is generated and sent by the ICU via the SSI.* SCU  command is generated and sent by the SCU via the 1553.* G-ICU  command is generated on the ground and sent to the DPU via the ICU/SSI.* G-SCU  command is generated on the ground and sent to the DPU via the SCU/1553.",0
  The DPU-DCI shall write to the DCI Memory in B-bit words only.,External Program InterfacesReads the BIT results from the location pointed to by pBitResults (which is assumed to be in EEPROM) into the BIT results data structure in DRAM.,0
 The DPU-CCM shall record an error to the LAST_BOOT_IVEC location in EEPROM and discontinue strobing the Watchdog Timer should an unrecoverable software error occur.  An unrecoverable software error is defined as an error that causes a loss of commandability or ground communication.,"Standard I/O Interface The write primitive does not block.  The write() primitive is managed by the tyLib function, tyWrite() when the driver is not in BGTX Message Mode.  The size of the Tx ring buffer is specified in the call to ssiDevCreate() as part of the device instantiation. This routine returns either the number of bytes written, or ERROR.",0
" The DPU-CCM shall spawn tasks for DPU-CCM, DPU-DPA, DPU-DCX, DPU-SCUI, and DPU-TMALI at bootup.","Development PlatformThe DPU FSW will be implemented in the ANSI C programming language, with some PowerPC assembly used in the Bootstrap and to implement the VME data transfer in the DCI Driver.  The host (development) platform and operating system is Sun/Solaris from Sun Microsystems, Inc.  The target platform is the RAD6000 processor which has a POWER (PowerPC-like) architecture, and executes the VxWorks 5.3.1 real-time operating system.  The cross compiler and debugger is MULTI/C/C++ 1.8.9 from Green Hills Software, Inc.",0
  The DPU-BIT shall test the Error Detection and Correction (EDAC) on the Company X Communication/Memory Module by reading preprogrammed error locations in PROM.,"Checksum LibraryA number of checksum algorithms are required by various system and application software modules.  In order to avoid duplication of code, the various checksum algorithms are encapsulated into a checksum library. ",0
"  The DPU-CCM shall, in rejecting a command, report an error in DPU_HK indicating  the byte-code of the command being rejected in the LSB of the errno as described in 03691-DPUSDP-01.  ","Data Transfer to QueueDuring initialization, the TMALI CSC installs an ISR hook routine, tmaliTransferToQueueISR(),  into the DCI Driver which is invoked when:* the DCI interface reaches the programmed frame limit in the Ping-Pong buffer, or* the DCI interface detects a data receipt timeout.",0
"  The DPU-BOOT CSC shall complete Stage 1 BIT, and load DPU-RTOS in less than A seconds following a hardware reset if CTS is not asserted.","Time Interface ConfigurationThe DPU hardware provides two configuration options to the software:* selection of the active A PPS signal, and* the option to manually jam a value into the clock registers without the A PPS signal.",0
  The DPU-RTOS shall include the capability to dynamically load object modules from the EEPROM.,Install Exception Handlersa default interrupt handler and is installed into element five (5) of the system interrupt table.,0
  The DPU-ADC shall read from the SCM registers in B-bit words only.,"Data Processing Algorithm CSCThe DPA CSC includes the following components:* Instrument Y Processor Task  creates histogrammed Instrument Ys, performs Tracking (choose guide stars, drift correction, shift-and-add), creates the Reference, Accumulation, and Data Product buffers, and provides a task heartbeat to the CCM task.",0
  The DPU-BOOT CSC shall provide the capability to automatically load a configuration of DPU-RTOS from EEPROM to DRAM and start its execution.,Intensifier Characteristics (IC) Engineering ModeThe purpose of Intensifier Characteristics Engineering Mode is to assess detector health and performance. Detector events produced in Full Frame High Resolution detector format are collected and histogrammed for a commanded integration time to produce a pulse-height histogram.,0
" At startup, the DPU-RTOS shall execute the BIT device RAM tests (cold boot only), install device drivers, execute the BIT driver loopback tests (cold boot only), and then spawn the application flight software.",Error Detection and Correction CSCThe Error Detection and Correction (EDAC) CSC is a Level 1 reuse component from the SSFF and INSTRUMENT Y projects.  The EDAC CSC consists of a set of Interrupt Service Routines (ISRs) and a Memory Scrubber Task.  The design of the INSTRUMENT Y EDAC CSC is described in document CIDPSDS-01.The only design change was to add logic to check for excessive external (SCM) EDAC interrupts.,0
" The DPU-SCUI shall detect the condition in which the SCU fails to read one or more MIL-STD-1553B subaddresses during the transmission of a STPDU, shall cancel the write on those subaddresses, record new data to those subaddresses, and report an error to the DPU-CCM.","Public FunctionsThis routine returns a copy of the local copy of the spacecraft time maintained in the DPU hardware, and the UT Delta from the most recent Clock Message which is maintained in a static variable.  The caller may pass in NULL for either parameter.  If NULL is passed for both parameters, the function performs no action and returns OK.",0
  The DPU-TMALI shall place the starting address of the event ring buffer in TMALI_HK.,"Public FunctionsThis routine provides a means to set the data timeout used by the DCI, the value requested indicates the timeout in milliseconds.  The initial value for the frame depth setting is determined by the parameter provided when starting the tmaliTask.  The maximum value to which the timeout can be commanded is X seconds, an attempt to set the timeout to a number larger than this maximum will result in setting the timeout to the default value of X milliseconds",0
  The DPU-RTOS shall include the capability to dynamically load object modules from the EEPROM.,"initial boot sequencethe initial boot sequence, identified as Boot Sequence 1.  This processing takes place when the Bootstrap executes from Programmable Read-Only Memory (PROM).  Boot Sequence 1 is composed primarily of 4 steps as follows.First, in this sequence, EEPROM is updated.  Then, CPU BIT and a portion of DRAM BIT is performed.  Next, DRAM is cleared.  Lastly, Boot Sequence 2 is copied to DRAM and executed. During this sequence, the rest of DRAM is tested if skipBit is not set.  Load parameters are put into registers r13, r14, r15 and r16.  DRAM is cleared up to memSize.  Lastly, either the DPU-RTOS or the Bootstrap Monitor is loaded and executed according to the load parameters.",0
The image mode shall shift successive frames according to the calculated spacecraft drift and co-add the frame into an accumulated image.,Ring buffer data structureThe pIn and pOut pointers are defined  as follows:* pIn- last location filled with data* pOut- last empty location,0
All searchable product-specific metadata in MODIS standard products shall be formatted as specified in DID 311.,"Error Collection and ReportingIn order to insure that error counts are not lost due to rollover, ccmErrEnq(), checks to insure that the count for a given error has not gone above 250 in one high rate housekeeping reporting period.  If the error count exceeds 250 for a particular reporting period, ccmErrEnq() will enqueue S_ccm_ERR_REPEAT error with the current error count and will clear its error tracking mechanism.",0
" The DPU-ICUI shall install an ISR to be invoked on the SSI receiver interblock gap interrupt, for the receiving and processing of commands from the ICU.","Error Collection and ReportingAt boot time, no error queue exists because it has yet to be created.  Errors that occur in this early stage of error reporting are assigned directly to the global task variable errno.  The reader may refer to the VxWorks Programmers Guide, section 2.3.7 for more information on errno.  If errno is set after the error queues are created, it is queued to the Error Queue by calling ccmErrEnq(). ",0
 The DPU-CCM shall use DPU-ICUI to communicate with the ICU.,"remaining DPU FSW tasksFollowing startup, the Command and Control Task spawns the remaining DPU FSW tasks, which are described below:* The Command Dispatch Task (ccmCmdTask) is an Application Framework Software task which is responsible for dispatching commands which arrive from the ICU or the SCU.  Commands are executed directly by this task by calling the applicable CSC function* The SCU Interface Task (scuiDPTask) receives telemetry data from other tasks, converts them to CCSDS Version1 Source Packets, forms Company X Telemetry Protocol Data Units (STPDUs) from the Source Packets, and transmits the STPDUs to the SCU via the MIL-STD-1553B Interface.* The Telescope Module Event Transfer Task (tmaliTask) is an Application Framework Software task which is responsible for transferring data from the DCI ping/pong buffers to the TMALI data buffer in response to a DCI frame limit or data timeout interrupt.* The Data Compression Task (dcxTask) receives telemetry data from other tasks, uses a lossless data compression algorithm to compress the data, and then enqueues the data to the SCU Interface Task.* The Data Processing Algorithms Tasks (dpaIMTask and dpaEPTask) process incoming detector events according to the commanded mode, create data products, and enqueue those data products to the Data Compression Task (if compression is enabled) or to the SCU Interface Task.* The Error Detection and Correction Memory Scrubber Task (edacTask) cycles through the text and data segments of the DPU to trigger the correction of single-bit errors which may have occurred, in order to help prevent the occurrence of uncorrectable multiple-bit errors.",0
The image mode shall shift successive frames according to the calculated spacecraft drift and co-add the frame into an accumulated image.,Control and MonitoringThe DPU produces eight types of housekeeping packets.,0
"The DPU-BOOT CSC shall perform successive writes to a word page of EEPROM within C msecs, or wait a minimum of D usecs between successive writes.","Public FunctionsThis routine gets housekeeping data stored for the TMALI CSC including some DCI parameters and resets the tmali internal counters to zero.  When the caller supplied pointer to a TMALI_HK structure is NIL no data is returned but the tmali internal counters are still reset to zero.Two of the four error counters are updated within an ISR context, this requires a task switch safe implementation of these counters.  Within VxWorks this could be solved using a counting semaphore.  In the TMALI CSC design a faster method was used by using a free running error counter and a careful update of the reported number of errors, using an extra temporary variable.  As the increment and assignment of the 32 bit unsigned integers themselves are atomic operations the resulting counters are task safe and no error events are lost.  This means that the sum of the errors reported by the tmaliHkGet() function is equal to the total numbers of errors that occurred, no error reports are lost due to the update of the internal structures.",0
  The DPU-RTOS shall provide a function to allow an application program to write to the Real-Time Clock registers on the RAD6000SC CPU Module.,Shall detect corrupt converted_instrument_scan_data.converted_mirror_encoder_data.  ,0
  The DPU-CCM shall maintain counts of both the number of commands successfully received and rejected and report the parameters in DPU_HK.,"remaining DPU FSW tasksFollowing startup, the Command and Control Task spawns the remaining DPU FSW tasks, which are described below:* The Command Dispatch Task (ccmCmdTask) is an Application Framework Software task which is responsible for dispatching commands which arrive from the ICU or the SCU.  Commands are executed directly by this task by calling the applicable CSC function* The SCU Interface Task (scuiDPTask) receives telemetry data from other tasks, converts them to CCSDS Version1 Source Packets, forms Company X Telemetry Protocol Data Units (STPDUs) from the Source Packets, and transmits the STPDUs to the SCU via the MIL-STD-1553B Interface.* The Telescope Module Event Transfer Task (tmaliTask) is an Application Framework Software task which is responsible for transferring data from the DCI ping/pong buffers to the TMALI data buffer in response to a DCI frame limit or data timeout interrupt.* The Data Compression Task (dcxTask) receives telemetry data from other tasks, uses a lossless data compression algorithm to compress the data, and then enqueues the data to the SCU Interface Task.* The Data Processing Algorithms Tasks (dpaIMTask and dpaEPTask) process incoming detector events according to the commanded mode, create data products, and enqueue those data products to the Data Compression Task (if compression is enabled) or to the SCU Interface Task.* The Error Detection and Correction Memory Scrubber Task (edacTask) cycles through the text and data segments of the DPU to trigger the correction of single-bit errors which may have occurred, in order to help prevent the occurrence of uncorrectable multiple-bit errors.",0
The image mode shall shift successive frames according to the calculated spacecraft drift and co-add the frame into an accumulated image.,"Built-In Test CSCThe Built-In Test (BIT) CSC is a Level 2 reuse component from the SSFF and INSTRUMENT Y projects.  The detailed design of the BIT CSC follows. The Built-In Tests CSC, identified DPU-BIT, performs the Stage 2 Built-In Tests (BIT).  The Stage 2 BIT includes a test of the SCM EDAC circuit, a checksum test on SCM PROM, a MIL-STD-1553B internal BIT, and a memory test of the DCI Data Buffers. The results of the BIT are recorded in the SYS_CNFG_AREA in EEPROM and are also maintained in DRAM.  If an error occurs in one of the functions performing the BIT, the test result will be reported as a failure in the test itself.",0
  The DPU-DCI shall report errors to an application program by setting the ERRNO task variable and returning ERROR.,"Time RetrievalThe DPU maintains a local copy of the spacecraft clock and current UT Delta in order that the DPU FSW can timestamp data products and packets.  The TIS CSC provides a function, tisTimeGet(), which retrieves a copy of both the current DPU clock value and the most recent UT Delta value.  Time is communicated among DPU FSW applications via the TIS_TIME data structure.",0
  The DPU-SSI shall provide the capability for an application program to install a callback routine to respond to the receive IBG Interrupt.,"Telescope Module Access Library and Interface CSCThe TMALI CSC includes the following components:* A queue, TMALI_EVENT_QUEUE, implemented using a ring buffer, which contains the detector events which have been received over the data capture interface from the DCI Driver, but which have not yet been retrieved by the DPA CSC;* An API which facilitates the retrieval of detector events from the queue by the DPA CSC.  The API consists of the tmaliNextEvent() and tmaliWait() functions.* An set of API functions used by the DPA CSC to configure the DCI interface, including tmaliBitArrangementSet(), tmaliDciFrameDepthGet(), tmaliDciFrameDepthSet(), tmaliDciWindowSet(), tmaliDataTimeoutSet(), and tmaliDataTimeoutGet().* An API housekeeping function, tmaliHkGet(), which gathers  CSC housekeeping data at the request of the Command and Control Task.* The task tmaliTask() and an ISR tmaliTransferToQueueISR() work together via a semaphore to synchronize the transfer of data from the DCI to the  queueAn error handling ISR, tmaliDciErrorReportedISR(), is installed as a hook routine to the DCI Driver, and is used to keep track of the number of errors reported by the DCI driver.",0
  The DPU-ADC shall create a fixed analog conversion scan list containing the A DPU analog values (active values plus one ground reference value).,Checksum LibraryThis function performs a checksum on a specified memory range.  The checksum is performed as a 32-bit additive checksum.,0
  The DPU-RTOS shall install an hook routine which is invoked on system exception which shall attempt to record the interrupt vector to the LAST_BOOT_IVEC location in EEPROM prior to reboot.,"Standard I/O InterfaceThe read() primitive does not block.  A read is performed on the active portion of the H/W ping pong buffer using the RAD 6000 move-multiple instruction, referred to here after as a block move.  For optimum performance, the block move is implemented in assembler.  The number of bytes read is returned to the caller.",0
  The DPU-TIS shall provide the capability for application programs to access the current UT_DELTA.,"Time Interface ConfigurationThe TIS CSC utilizes the manual jam bit in the DCI CSR to indicate whether automatic time synchronization is enabled or disabled.  If automatic time synchronization is enabled, and a command is issued to manually jam the DPU clock, the command will be rejected - see tisTimeSet().",0
Each MODIS standard data product shall be produced within the data volume and processing load allocation shown in Table B-1.,The L1A/Geolocation software shall use all applicable mandatory SDPTK routines and any additional SDPTK routines that are useful.  ,0
Each MODIS standard data product shall be produced within the data volume and processing load allocation shown in Table B-1.,"Checksum LibraryA number of checksum algorithms are required by various system and application software modules.  In order to avoid duplication of code, the various checksum algorithms are encapsulated into a checksum library. ",0
 The DPU-DPA shall be able to perform tracking based on data collected from the detector by calculating the spacecraft drift using successive tracking frames using the algorithm described in Appendix C.,"ACS Message ProcessingThe SCUI task will send the ACS message to the DPA by calling the function dpaACSReceive().  Because the SCUI task will be calling dpaACSReceive() from an ISR, dpaACSReceive() must return quickly.  If commanded by the ICU in the Mode command, the ACS message will be saved along with the event data product.  To return quickly, dpaACSReceive() will place the ACS message in a data queue then return.  The Event Processor Task will remove the ACS messages from the queue and send them to the spacecraft.",0
The DPU-BOOT CSC shall initialize Error Detection and Correction (EDAC) on the RSC by clearing DRAM.,Real-Time Clock InterfaceThis routine gets the value of the Real-Time Clock (RTC) Registers and places the results in variables rtcu and rtcl.,0
 The DPU-SCUI shall communicate with the SCU according to the protocol defined in document 1143-EI-S19121.,Setting DCI Bit ArrangementThe bit arrangement of the DCI control/status register can be set via tmaliBitArrangementSet().,0
  The DPU-ADC shall create a fixed analog conversion scan list containing the A DPU analog values (active values plus one ground reference value).,Shall write Level0_header_log_msgs to Log_messages if the Spacecraft_indicator verification fails.  ,0
  The DPU-EDAC shall record the number of MBEs that have been detected in DRAM since boot and the address of the last two MBEs.,"Memory Upload and Download HandlingData can be upload to several types of locations, including* DRAM* EEPROM* hardware registers, and* EEPROM filesystem.ial D_MEM_DAT_UPLD command specify the target location.  If the destination is the EEPROM filesystem, a block number is provided in lieu of a memory address , which is used by the DPU FSW to formulate a filename of the form eefs1:DPU_blk.##, where ## is the block number.  In this case, once the entirety of the uploaded data is received by the DPU FSW, the uploaded data is then written to that file in the EEPROM filesystem.  If a file already exists with that name, it is overwritten.  The EEPROM filesystem can be reinitialized using the command D_MEM_DISK_INIT.",0
"  The DPU-ICUI shall compute a CHKS_16 for DPU_CMDs received from the ICU.  If the expected checksum is not computed, the command will be discarded, an error will be enqueued to DPU-CCM, and a NAK message transmitted to the ICU within a second.","Bootstrap MonitorThe Bootstrap Monitor checks entered commands for syntax and number of arguments, and displays an error message to the RS-232 interface if an invalid command or argument is entered.  A complete listing of these messages is given in document 7384-BSPS-01.",0
 The DPU-SCUI shall be capable of receiving a telecommand from the SCU every N ms and forward it to DPU-CCM for processing.,"Event ProcessingIf the Mode command is Instrument Y Mode, the detector events are spatially filtered to the Instrument Y window specified in the Mode command then the corresponding pixel in the Ping or Pong buffer is incremented.  If specified in the Mode command, pixels will be binned at AxA or BxB.  Also, if specified in the Mode command, a tracking frame data product will be produced for every Ping/Pong tracking frame. Instrument Y and Event Mode may be commanded simultaneously in the Mode command. If the ICU sends an XRT Position command, the Instrument Y mode and Event Mode windows will be resized to match the new window sizes in the command.",0
"  At the end of a download, the Bootstrap Monitor of the DPU-BOOT CSC shall compute a CHKS_32 on the X stored in EEPROM and compare it against the CHKS_32 sent with the X during the transfer.  The Bootstrap Monitor shall output to to the RS-232 interface both CHKS_32s and a message indicating whether the download was successful.","Public FunctionsThis routine provides a means to set the data timeout used by the DCI, the value requested indicates the timeout in milliseconds.  The initial value for the frame depth setting is determined by the parameter provided when starting the tmaliTask.  The maximum value to which the timeout can be commanded is X seconds, an attempt to set the timeout to a number larger than this maximum will result in setting the timeout to the default value of X milliseconds",0
Each software process shall trap and properly process all exceptions that may produce an abnormal terminationand report all such events using the SDPTK error message functions.,"Transmitting Telemetry to the SpacecraftThe SCUI CSC receives telemetry as input Data Packages via queues populated by other tasksthe Science Data Processing Task, the Data Compression Task, and the Command and Control Task.  The SCUI CSC has a High Priority Queue and a Low Priority Queue.  The two queues are implemented in an identical manner with the exception that the scuiTask() gives processing preference to the High Priority Queue.  The purpose of the High Priority Queue is to provide a means by which the Parameterized Finding Chart and DPU housekeeping can be transmitted to the SCU ahead of the potentially large amounts of buffered science data.",0
Each software process shall trap and properly process all exceptions that may produce an abnormal terminationand report all such events using the SDPTK error message functions.,Shall generate data_input_status_messages if errors are encountered in reading Level_2_Data. ,0
  The DPU-SSI shall provide the capability for an application program to set the Inter-Block Gap (IBG) Timeout for transmitted and received messages.,"Command and Control CSCThe Command and Control (CCM) CSC is a Level 2 reuse component from the INSTRUMENT Y project.  The Command and Control CSC includes the following components:* A Control Task, ccmCtrlTask(), which initializes the DPU FSW and spawns other tasks at bootup, schedules the production of DPU housekeeping data packets, monitors the execution of other tasks, and schedules the execution of other periodic tasks such as the heartbeat message and the watchdog strobe; and* A Command Dispatch Task, ccmCmdTask(), which receives and dispatches real-time commands received from the SCU or the ICU.Major data structures include:* A Static Data table that keeps track of the operational state.  Data included in this table includes housekeeping production rates, CCM specific flags, and the number of commands executed.* A Command Queue into which commands are placed when they arrive, via interrupt, from the ICU or the SCU.* An Error/Event Queue which accumulates error and event codes which are reported by the DPU FSW.  These error and event codes are removed from the queue and placed into a telemetry packet at a given interval and included in DPU housekeeping data.DPUSDS5.12.1.1.1Flight Software InitializationThe Command and Control CSC is initialized by spawning the CCM Control Task, ccmCtrlTask(), from the operating system startup task, usrRoot().  After the task is spawned it calls a function, ccmInit(), which creates the error/event queue, instantiates needed semaphores and installs various ISRs.  Finally, it spawns the remaining tasks which comprise the DPU FSW. When the CCM Control Task starts up, it reads DPU configuration startup defaults from the SYSTEM_CONFIG_AREA in EEPROM.  If the SYSTEM_CONFIG_AREA checksum is bad, hard-coded defaults are used.  The CCM Control Task initializes the remaining CSCs by calling the applicable initialization function, or if the CSC has an associated task, by spawning the task using the VxWorks function, taskSpawn().  When the CCM Control Task initializes a CSC, it passes the startup defaults read from EEPROM as parameters to the task initialization function. In addition to its task initialization activities, ccmInit(), also initializes the command length verification table by calling ccmCmdLengthInit().  The command processor uses the created table to verify expected command lengths for newly received commands.",0
 The DPU-DCI shall provide an application program with the ability to toggle the hardware interface between Normal mode and Test mode.,"Performing Analog-to-Digital ConversionsThe ADC Driver maintains an array of ADC_LIST_ENTRY data structures which contain the hardware multiplexer setup information for each of the x analog inputs, and the current value (ADC_VALUE) of each analog input.  To update a single value in the list, an application must call the update function adcUpdateNext().  The ADC hardware only has a single A/D channel, and so to perform an A/D conversion the hardware requires a multiplexer setup and corresponding settle time, as well as the normal A/D conversion time.  Therefore, it takes two calls to adcUpdateNext() to update a single value in the list.  To keep the driver simple and to avoid embedding hard waits in the driver, the application is required to implement the setup and conversion time by spacing successive calls to the adcUpdateNext() function appropriately.",0
  The DPU-DCI shall provide an application program with the ability to read and write the hardware ping-pong buffers when in Test Mode.,"Memory Upload and Download HandlingIf more than 65535 bytes need to be uploaded, the upload file must be broken up into multiple smaller files, each less than or equal to 65535 bytes, and then each of the virtual uploads should be sent in series.  Because of the sequence numbers, the DPU FSW can receive individual upload commands out of sequence.  There is no time limit for the accomplishment of a single virtual upload, and so a long upload can continue across ground contacts.  If an upload is in progress, the last sequence number can be sent to the DPU FSW and it will report the list of missing sequence numbers via event number S_ccm_MISSING_SEQNO.  If an upload is in progress and needs to be cancelled, it can be discarded by issuing the D_MEM_DAT_CNCL command.",0
"  The DPU-TIS shall provide the capability for an application program to set the value of the SC_TIME register(s) on the SCM and enable the 1PPS clock jam register, if automatic time synchronization is enabled.","Instrument Control Unit Interface CSCThe Instrument Control Unit Interface (ICUI) CSC is a new component that provides support for application-level communication with the INSTRUMENT X ICU.  The ICUI CSC is primarily responsible for implementing the application protocol with the ICU as defined in document DPUICD-01. In order to meet these objectives, ICUI provides: * An ICU Interface Message Send Function, icuiEnq(), which provides an API by which other CSCs can send messages to the ICU.* An ICU Interface Command Reader ISR, icuiCmdReceiveISR(), which receives Telecommands from the ICU and forwards them to the Command and Control Task for processing.* An ICU Interface Housekeeping Function, icuiHkGet(), which gathers ICU Interface housekeeping data at the request of the Command and Control Task.",0
"  The DPU-CCM shall check the length of a received DPU_CMD against an expected value from a lookup table indexed by FUNCTION code.  If the received value does not match the expected, then the command will be discarded, and an error will be enqueued.","Transmitting Telemetry to the SpacecraftThe SCUI CSC receives telemetry as input Data Packages via queues populated by other tasksthe Science Data Processing Task, the Data Compression Task, and the Command and Control Task.  The SCUI CSC has a High Priority Queue and a Low Priority Queue.  The two queues are implemented in an identical manner with the exception that the scuiTask() gives processing preference to the High Priority Queue.  The purpose of the High Priority Queue is to provide a means by which the Parameterized Finding Chart and DPU housekeeping can be transmitted to the SCU ahead of the potentially large amounts of buffered science data.",0
  The DPU-DPA shall be capable of collecting detector events over the full  FOV.,"Full-Frame (FF) Engineering ModeThe purpose of Full-Frame Engineering Mode is to monitor the health of the detector to locate hot spots and dead pixels. Detector events produced in Full Frame High Resolution detector format are received and histogrammed for a commanded integration time.  The entire Instrument Y is transmitted to the ground.  This mode can use high resolution (all pixels) or low resolution imaging (BxB , DxD pixel binning).",0
 The DPU-TMALI shall be capable of making data available from the DCI to DPU-DPA.  DPU-TMALI will populate a ring buffer with frames of data for application task retrieval.,Ring buffer data structureThe pIn and pOut pointers are defined  as follows:* pIn- last location filled with data* pOut- last empty location,0
  The DPU-BOOT CSC shall create a record of the CPU BIT in the SYSTEM_BLOCK.,Ring buffer data structureThe pIn and pOut pointers are defined  as follows:* pIn- last location filled with data* pOut- last empty location,0
The DPU-BOOT CSC shall test and clear DRAM on power-on using the COLD_MEM_SIZE obtained from the SYSTEM_BLOCK.,"Ring buffer data structureThe  CSC maintains a FIFO implemented as a ring buffer to temporarily store the data received from the DCI before it is processed. The ring buffer uses two pointers called pIn and pOut to keep track of the data in the buffer. The pointers were defined such that reading from the buffer is the simplest operation and only a single compare is needed to verify if the buffer is empty. The buffer only stores Events so the pointers point to these four byte entities. As the DCI specifies all data in bytes, sizes have to be converted before reading data.",0
  The DPU-RTOS shall provide the capability to invoke user-installed Interrupt Service Routines (ISRs) in response to internal and external (VME) interrupts.,"Standard I/O InterfaceThe write primitive does not block.  The buffer passed to write is written directly to the active portion of the ping pong buffer by the driver.  This primitive is valid only in TEST mode.  The write call will set errno to S_dci_MODE_ERROR and return ERROR if the driver is in NORMAL mode.  In TEST mode, the driver returns the number of bytes written.",0
"  The DPU-ICUI shall check the length of a received DPU_CMD against the message length determined by the Inter-Block Gap.  If the received value does not match, then the command will be discarded, and an error will be enqueued to DPU-CCM, and a NAK message transmitted to the ICU within a second.","Instrument Control Unit Interface CSCThe Instrument Control Unit Interface (ICUI) CSC is a new component that provides support for application-level communication with the INSTRUMENT X ICU.  The ICUI CSC is primarily responsible for implementing the application protocol with the ICU as defined in document DPUICD-01. In order to meet these objectives, ICUI provides: * An ICU Interface Message Send Function, icuiEnq(), which provides an API by which other CSCs can send messages to the ICU.* An ICU Interface Command Reader ISR, icuiCmdReceiveISR(), which receives Telecommands from the ICU and forwards them to the Command and Control Task for processing.* An ICU Interface Housekeeping Function, icuiHkGet(), which gathers ICU Interface housekeeping data at the request of the Command and Control Task.",0
  The DPU-CCM shall forward ACS_MSGs to the DPU-DPA for processing immediately upon receipt (I.e. shall not enqueue the message to the command dispatcher queue).,"Shall create ECS_standard_global_metadata and MODISL1A_specific_global_metadata for each completed Level1A_data product, using Level0_open_metadata and selected metadata contained in MODIS_scan.  ",0
"A MODIS Computer Software Configuration Item (CSCI) is any independently tracked and configured unit of software within the MODIS SDP S/W, including processes, scripts, and utility libraries.  Each CSCI in the MODIS SDP S/W shall run in the ECS production environment.","Command HandlingWhen a command arrives from the SCU (via the 1553 interface) or the ICU (via the SSI interface), the respective ISR will enqueue the command packet into a Command Queue, and then give the semaphore to awaken the ccmCmdTask().  Since it is possible for the DPU to send a command to itself, commands may arrive at interrupt context or task context.  Therefore the CCM maintains two queues  one for interrupt context which is not semaphore protected, and one for task context which is semaphore protected.",0
  The DPU-TIS shall provide the capability for an application program to select the active 1PPS signal.,"InitializationThe SCUI CSC is initialized when the scuiTask() is spawned by the CCM CSC.  Initialization parameters which are passed into the scuiTask() include:* Poll Rate  rate at which the S/C will poll the DPU for telemetry.  The rate is specified in Hz, and has a default of X Hz based on the INSTRUMENT X-DPU poll rate in the Company X 1553 ICD.* Buffer Rate  value used to rate buffer data to the S/C.  The rate is specified in bits per telemetry poll, and has a default of 7664 which is equal to one STPDU per poll (*** bytes per STPDU times V bits/byte).  This default value effectively disables rate buffering.* Size of Low Priority Queue  size in bytes of the low priority telemetry queue.  If the amount requested cannot be allocated, the buffer will be allocated at  the amount of memory contained in the largest free memory block.Size of High Priority Queue  size in bytes of the high priority telemetry queue. If the amount requested cannot be allocated, the buffer will be allocated at  the amount of memory contained in the largest free memory block.",0
  The DPU-DCI shall read from the DCI Registers in C-bit words only,"Time Synchronization CSCThe Time Synchronization (TIS) CSC is a new component which provides services to maintain time synchronization between the DPU and the spacecraft, and which provides an API for retrieval of the current system time.",0
  The  raw event list engineering mode shall collect events for transmission to the ground.,"Event ProcessingThe Event Processor Task, after receiving a Mode command from the ICU, configures the DPU DCI hardware, responds to the ICU with a Mode Ready message then receives detector events by calling functions tmaliWait() and tmaliNextEvent().  The Event Processor Task will collect detector events for the time period specified in the Mode command then issue a Mode Complete message to the ICU.  After issuing the Mode Complete message, the Event Processor Task will enter the Idle state.",0
  The DPU-DCI shall report errors to an application program by setting the ERRNO task variable and returning ERROR.,InitializationThe TIS CSC is initialized by calling the tisInit() function.  The TIS CSC does not have an associated operating system task.  The TIS CSC will initialize the DPU hardware to perform or not perform automatic time synchronization with the spacecraft as indicated by an initialization parameter passed to the tisInit() function.  There are two 1 PPS signals between the DPU and the Spacecraft (a primary and alternate);  the TIS CSC will select the active 1 PPS signal according to the parameter passed to the tisInit() function.,0
  The DPU-SSI shall provide the capability for an application to determine the number of bytes in a message received from the ICU.,"Time Synchronization CSCThe Time Synchronization (TIS) CSC is a new component which provides services to maintain time synchronization between the DPU and the spacecraft, and which provides an API for retrieval of the current system time.",0
" The channel boundary engineering mode shall create an array of look-up table (LUT) channel boundaries, PROD_CHAN_BOUND, from a flat field, and PROD_MN_DATA, using the algorithm described in Appendix C.","Ring buffer data structureThe  CSC maintains a FIFO implemented as a ring buffer to temporarily store the data received from the DCI before it is processed. The ring buffer uses two pointers called pIn and pOut to keep track of the data in the buffer. The pointers were defined such that reading from the buffer is the simplest operation and only a single compare is needed to verify if the buffer is empty. The buffer only stores Events so the pointers point to these four byte entities. As the DCI specifies all data in bytes, sizes have to be converted before reading data.",0
  The DPU-DCI shall read from the DCI Registers in C-bit words only,"Time Synchronization CSCThe Time Synchronization (TIS) CSC is a new component which provides services to maintain time synchronization between the DPU and the spacecraft, and which provides an API for retrieval of the current system time.",0
"  The DPU-DPA shall command DPU-TMALI to reorder EVENT data bits as a function of the Detector Electronics Output Format (Science Mode 3, Full-Frame High Res), and the commanded DPU science or engineering mode.  ",Standard I/O InterfaceSSI ioctl() commands.,0
  The Bootstrap Monitor of the DPU-BOOT CSC shall provide the capability to load a configuration of the DPU-RTOS from EEPROM to DRAM and start its execution on command.,The L1A/Geolocation software shall use HDF Version 4.1r1 for reading and writing all HDF files.  ,0
 The DPU-ICUI shall use DPU-SSI to communicate with the SSI Interface.,"Memory Upload and Download HandlingData can be upload to several types of locations, including* DRAM* EEPROM* hardware registers, and* EEPROM filesystem.ial D_MEM_DAT_UPLD command specify the target location.  If the destination is the EEPROM filesystem, a block number is provided in lieu of a memory address , which is used by the DPU FSW to formulate a filename of the form eefs1:DPU_blk.##, where ## is the block number.  In this case, once the entirety of the uploaded data is received by the DPU FSW, the uploaded data is then written to that file in the EEPROM filesystem.  If a file already exists with that name, it is overwritten.  The EEPROM filesystem can be reinitialized using the command D_MEM_DISK_INIT.",0
 The DPU-CCM shall provide a command to reboot the DPU.,"Public FunctionsThis routine provides a means to get the current data timeout value used by the DCI.  The returned value is the current timeout in milliseconds.The timeout is discussed in document 036911400, section 4.3.2.4.1.3.",0
  The DPU-CCM shall interpret and execute/dispatch real-time DPU_CMDs.,"Error Collection and ReportingAt boot time, no error queue exists because it has yet to be created.  Errors that occur in this early stage of error reporting are assigned directly to the global task variable errno.  The reader may refer to the VxWorks Programmers Guide, section 2.3.7 for more information on errno.  If errno is set after the error queues are created, it is queued to the Error Queue by calling ccmErrEnq(). ",0
" The DPU-SCUI shall cancel the write to each subaddress if the SCU fails to read a pending STPDU after a timeout specified by a value calculated based on the SCU_POLL_RATE parameter provided during initialization, shall record new data to those subaddresses, and report an error to the DPU-CCM.  The SCU_POLL RATE parameter shall have a default setting of J ms and shall be capable of being modified dynamically.",Real-Time Clock InterfaceThis routine gets the value of the Real-Time Clock (RTC) Registers and places the results in variables rtcu and rtcl.,0
"  The Bootstrap CSC shall address hardware modules as defined in document 1400, Company X Specification for the Company X Communication/Memory Module.","Public FunctionsThis routine returns a copy of the local copy of the spacecraft time maintained in the DPU hardware, and the UT Delta from the most recent Clock Message which is maintained in a static variable.  The caller may pass in NULL for either parameter.  If NULL is passed for both parameters, the function performs no action and returns OK.",0
  The DPU-RTOS shall provide a function to allow an application program to write to the Real-Time Clock registers on the RAD6000SC CPU Module.,InitializationThe DPA CSC is initialized by spawning the tasks dpaEventTask() and dpaInstrument YTask().  After the tasks are spawned they create the needed memory buffers.  The dpaEventTask() then enters the Idle state waiting for a Mode command from the ICU.  The dpaInstrument YTask also enters the Idle state waiting to process either the Ping or Pong buffer.  The default setting for compression (on or off) is retrieved from EEPROM.,0
The DPU-BOOT CSC shall disable write-protection of the EEPROM on the SCM.,"Time Interface ConfigurationThe TIS CSC utilizes the manual jam bit in the DCI CSR to indicate whether automatic time synchronization is enabled or disabled.  If automatic time synchronization is enabled, and a command is issued to manually jam the DPU clock, the command will be rejected - see tisTimeSet().",0
  The DPU-RTOS shall include the capability to dynamically load object modules from the EEPROM.,Telescope Module Access Library and Interface CSCThe Telescope Module Access Library and Interface (TMALI) CSC manages the detector event queue and provides an API for the retrieval of detector events from that queue to the data processing algorithms.,0
  The DPU-BIT shall perform two write/read/compare tests on the RAM for the DCI Data Buffers.  The first test shall write the address of each location to that location.  The second test shall write the ones complement of the values used in the first test.,Checksum LibraryThis function performs a checksum on a specified memory range.  The checksum is performed as a 32-bit additive checksum.,0
  The centroid confirmation engineering mode shall produce a PROD_CENTROID_CONF.  This mode shall divide a full frame image into a certain regions.  Each region shall be processed to form an 8x8 confirmation image.  The certain confirmation images shall be sent to the solid state recorder as one data product.,"Time SynchronizationThe time contained in the Clock Message is specified to be valid on the rising edge of the next 1PPS signal.  When the DPU receives the Clock Message, the 1553 ISR calls the tisTimeSync() function, forwarding the data portion of the clock message to the TIS CSC via the TIS_CLK_MSG data structure..  The tisTimeSync() function will immediately copy the spacecraft clock value to the DPU clock hardware registers. The DPU hardware is designed to latch in the new time on the rising edge of the next 1 PPS signal (the act of writing a new time to the hardware registers arms the latch function in the hardware).  Once the new time is latched, the hardware automatically disables the time latch function to avoid the potential of latching in an old time at the next 1 PPS signal.will be received within one second.  In the unlikely event a UT Delta is discarded, an event message is enqueued to ccmErrEnq() for informational purposes.",0
Each MODIS standard data product shall be produced within the data volume and processing load allocation shown in Table B-1.,InitializationThe TIS CSC is initialized by calling the tisInit() function.  The TIS CSC does not have an associated operating system task.  The TIS CSC will initialize the DPU hardware to perform or not perform automatic time synchronization with the spacecraft as indicated by an initialization parameter passed to the tisInit() function.  There are two 1 PPS signals between the DPU and the Spacecraft (a primary and alternate);  the TIS CSC will select the active 1 PPS signal according to the parameter passed to the tisInit() function.,0
 The DPU-CCM shall record an error to the LAST_BOOT_IVEC location in EEPROM and discontinue strobing the Watchdog Timer should an unrecoverable software error occur.  An unrecoverable software error is defined as an error that causes a loss of commandability or ground communication.,"Public FunctionsThis routine gets housekeeping data stored for the TMALI CSC including some DCI parameters and resets the tmali internal counters to zero.  When the caller supplied pointer to a TMALI_HK structure is NIL no data is returned but the tmali internal counters are still reset to zero.Two of the four error counters are updated within an ISR context, this requires a task switch safe implementation of these counters.  Within VxWorks this could be solved using a counting semaphore.  In the TMALI CSC design a faster method was used by using a free running error counter and a careful update of the reported number of errors, using an extra temporary variable.  As the increment and assignment of the 32 bit unsigned integers themselves are atomic operations the resulting counters are task safe and no error events are lost.  This means that the sum of the errors reported by the tmaliHkGet() function is equal to the total numbers of errors that occurred, no error reports are lost due to the update of the internal structures.",0
  The Bootstrap Monitor of the DPU-BOOT CSC shall provide the capability to load a configuration of the DPU-RTOS from EEPROM to DRAM and start its execution on command.,"Install Exception Handlers Certain conditions can cause the VxWorks? exception handler to reboot the DPU.  These conditions include a Data Storage Interrupt from within an interrupt context, a Multiple-Bit Error (MBE), and a deferred-work queue overrun.  Under these circumstances, interrupting devices on the Company X Communication/Memory Module must be stopped prior to jumping back to the Bootstrap.  This can be done by installing a hook routine to perform the cleanup in sysHwInit() using the function rebootHookAdd().  However, to avoid the need to cleanup interrupts, an exception handler is installed which forces a watchdog reset, which will effectively clean up the pending interrupt problem.  The exception hook saves the contents of the Exception Stack Frame to EEPROM and waits for a watchdog timeout.  The following call is added to the usrRoot() function in usrConfig.c:",0
  The DPU-ADC shall read from the SCM registers in B-bit words only.,"Unmask VME Interrupts and Disallow Nested InterruptsThe device drivers do not automatically unmask VME interrupts at the processor.  This must be done separately since some VME interrupts may share an IRQ level. Finally, nested interrupt capability should be disabled since allowing for nested interrupts was not considered in the design of this FSW.  This is done by verifying that SYS_INT_MASK_0 and SYS_INT_MASK_1 are both defined to 0xffffffff in config.h.",0
  The DPU-CCM shall utilize bootup default values stored in the SYSTEM_CONFIG_AREA in EEPROM when initializing the FSW,"Error Collection and ReportingIn order to insure that error counts are not lost due to rollover, ccmErrEnq(), checks to insure that the count for a given error has not gone above 250 in one high rate housekeeping reporting period.  If the error count exceeds 250 for a particular reporting period, ccmErrEnq() will enqueue S_ccm_ERR_REPEAT error with the current error count and will clear its error tracking mechanism.",0
  The DPU-RTOS shall provide a function to allow an application program to write to the Real-Time Clock registers on the RAD6000SC CPU Module.,"Public FunctionsThis routine provides a means to set the data timeout used by the DCI, the value requested indicates the timeout in milliseconds.  The initial value for the frame depth setting is determined by the parameter provided when starting the tmaliTask.  The maximum value to which the timeout can be commanded is X seconds, an attempt to set the timeout to a number larger than this maximum will result in setting the timeout to the default value of X milliseconds",0
 The DPU-TMALI shall allocate a ring buffer of size specified by TMALI_BUFFER_SIZE provided during initialization for storing incoming frames of data.  The default buffer size shall be 15 MB.,"Public FunctionsThis routine returns a copy of the local copy of the spacecraft time maintained in the DPU hardware, and the UT Delta from the most recent Clock Message which is maintained in a static variable.  The caller may pass in NULL for either parameter.  If NULL is passed for both parameters, the function performs no action and returns OK.",0
All searchable product-specific metadata in MODIS standard products shall be formatted as specified in DID 311.,Shall generate data_input_status_messages and set scan_quality_flags if corrupted data values are detected.  ,0
"  At the end of a download, the Bootstrap Monitor of the DPU-BOOT CSC shall compute a CHKS_32 on the X stored in EEPROM and compare it against the CHKS_32 sent with the X during the transfer.  The Bootstrap Monitor shall output to to the RS-232 interface both CHKS_32s and a message indicating whether the download was successful.","Public FunctionsThis function gets the frame depth of the Ping-Pong buffers used by the DCI CSC.  The frame depth determines how many frames are read into the selected Ping-Pong buffer before interrupting.  The initial value for the frame depth setting is determined by the parameter provided when stating the tmaliTask.  The returned value is the current active value, this may differ from the last commanded value as the commanded value only takes effect when data is transferred from the hardware Ping-Pong buffer to the TMALI queue (in response to a frame or timeout interrupt, see section 5.13.2.3).",0
  The DPU-DCI shall read from the DCI Registers in C-bit words only,"Public FunctionsThis function sets the frame depth of the Ping-Pong buffers used by the DCI CSC.  The frame depth determines how many frames are read into the selected Ping-Pong buffer before interrupting.  The initial value for the frame depth setting is determined by the parameter provided when starting the tmaliTask.  The maximum value to which the frame depth can be commanded is 64 frames, an attempt to command the frame depth to a value larger than this maximum will result in setting the timeout to the default value of V frames.The actual setting of the frame depth could be delayed by a small amount of time if there is activity on the DCI bus, and is typically changed when the DCI has just reported a frame level reached or timeout condition.  This minimizes the chance of changing the setting while the hardware is close to detecting a frame event.  Changing the frame depth while the DCI CSC is processing data could cause unpredictable results.  When a new tmaliDciFrameDepthSet command is send before the previous setting has been activated the new request will overwrite the previous request and the DCI will be commanded to the new value at the first available opportunity.",0
" The channel boundary engineering mode shall create an array of look-up table (LUT) channel boundaries, PROD_CHAN_BOUND, from a flat field, and PROD_MN_DATA, using the algorithm described in Appendix C.","Public FunctionsOperationally, the DPU uses the Jam bit in the DCI CSR to indicate whether the DPU is actively syncing its clock with the spacecraft or not.  This function sets the Jam bit if autoSync is FALSE, and negates the Jam bit otherwise. THIS FUNCTION ALTERS THE VALUE OF THE DCI CSR AND SHOULD NOT BE INVOKED WHEN DCI INTERRUPTS ARE ACTIVE.",0
"  The DPU-1553 CSC shall address hardware modules as defined in document 1400, Company X Specification for the Company X Communication/Memory Module.","Public FunctionsThis routine initializes the interface to the ICU.  This routine opens SSI Driver port, installs the SSI interface interrupt callbacks, and enables Transmit Message Mode in the SSI Driver.",0
  The DPU-RTOS shall provide a function to allow an application program to read from the Real-Time Clock registers on the RAD6000SC CPU Module.,The L1A/Geolocation software shall use HDF Version 4.1r1 for reading and writing all HDF files.  ,0
  The DPU-ADC shall create a fixed analog conversion scan list containing the A DPU analog values (active values plus one ground reference value).,SCU Interface CSCThis CSC performs rate-buffering of the downlink telemetry to the SCU according to a commandable parameter.  The rate at which the SCU polls the DPU is also commandable.  The CSC installs an ISR to collect telecommands from the SCU via the MILSTD1553B Interface.,0
 The DPU-SCUI shall communicate with the SCU according to the protocol defined in document 1143-EI-S19121.," Startup SequenceThe DPU FSW is booted using PROM-resident bootstrap software.  The bootstrap software performs a basic set of built-in tests, then copies the DPU FSW from EEPROM to DRAM and executes it.  In flight, there are two methods which can trigger the DPU FSW to boot:* power-on (cold boot), or* watchdog reset (warm boot, commanded reboot).",0
"The DPU-BOOT CSC shall perform successive writes to a word page of EEPROM within C msecs, or wait a minimum of D usecs between successive writes.","Time Interface ConfigurationThe TIS CSC utilizes the manual jam bit in the DCI CSR to indicate whether automatic time synchronization is enabled or disabled.  If automatic time synchronization is enabled, and a command is issued to manually jam the DPU clock, the command will be rejected - see tisTimeSet().",0
"A MODIS Computer Software Configuration Item (CSCI) is any independently tracked and configured unit of software within the MODIS SDP S/W, including processes, scripts, and utility libraries.  Each CSCI shall be coded according to thestandards specified in the MODIS Software Development Standards and Guidelines, SDST-022 .","Public FunctionsThe routine formats the given data into a CCSDS Telecommand Packet and writes it to the 1553 bus shared memory for transmission to the SCU.  If a message is already pending in the 1553 shared memory, the pending messages will be replaced in 1553 shared memory with the new message, and an error will be reported.",0
  The DPU-CCM shall process real-time non-deferred commands within B ms of receipt from the ICU or the SCU.,Real-Time Clock InterfaceThis routine gets the value of the Real-Time Clock (RTC) Registers and places the results in variables rtcu and rtcl.,0
 The DPU-TMALI shall install a callback routine to respond to the DCI Error Interrupt.,"Instrument Y ProcessingThe Instrument Y Processor Task will perform tracking by breaking the exposure up into 10-second sub-exposures which are shifted and added into a final histogrammed Instrument Y.  Tracking is performed by choosing guide stars from the first 10-second Instrument Y of an exposure.  Then in each subsequent Instrument Y, these guide stars are found and the drift is determined by comparing the two Instrument Ys. The Instrument Y is then shifted by the determined drift and added to the previous Instrument Ys in the accumulation buffer.",0
  The DPU-BIT shall perform MIL-STD-1553B internal BIT.,"Error Collection and ReportingThe DPU-CCM CSC provides a centralized error reporting interface, ccmErrEnq(), that other FSW tasks use to report errors.  Each time it wakes, ccmTask() checks to see if it is time to form an error/event packet for transmission to the ground.  If so, ccmTask() calls ccmHkMkError() to actually create the packet and forward it to DPU-SCUI for transmission to the ground.",0
  The DPU-DPA shall be capable of collecting detector events over the full  FOV.,"Control and Monitoringthe CCM Control Task initializes the DPU FSW. It is the responsibility of the CCM Control Task to establish a successful boot.  It does so by blocking on temporary semaphores, each with a 5 second timeout, after spawning the SCU Interface Task and the CCM Command Task.  If both of these tasks report a successful initialization by giving the semaphore, the CCM Control Task toggles the BC_INDEX parameter in EEPROM to indicate a successful boot.  If either task does not report a successful initialization, the CCM Control Task disables the watchdog strobe to effect a reboot of the DPU.  The rationale for selecting the successful initialization of these two tasks as the definition of a successful boot is that the DPU FSW requires these tasks, as a minimum, to establish ground contact and provide commandability.Once this initialization is complete, the task blocks on a binary semaphore which is given by the SCUI Command ISR upon arrival of the 1 Hz Clock Message.  In the event a Clock Message does not arrive, the semaphore will time out after 1.5 seconds.  The CCM Control Task remains alive to create and transmit DPU housekeeping at the appropriate intervals, perform various periodic processing tasks, and to process memory dump commands.The final call to ccmErrEnq() is performed in order that if an error occurs in an interrupt service routine, a global variable is set to the value of the errno which is then enqueued into the Error/Event Queue as part of this tasks normal processing.",0
  The DPU-BOOT CSC shall provide the capability to automatically load a configuration of DPU-RTOS from EEPROM to DRAM and start its execution.,"Data ProcessingData requiring compression is received via the dcxEnq() function, which has an API definition which matches the scuiEnq() API.  The DCX CSC handles the PKG_CTRL flags as described below:* PKG_COMPRESS  this flag is set to indicate if the package is actually compressed.* PKG_PRIORITY_HIGH  this flag is ignored by the DCX CSC but is forwarded to the SCUI CSC.* PKG_SEGMENT  this flag is ignored by the DCX CSC but is forwarded to the SCUI CSC.PKG_CHECKSUM  if set, the dcxEnq() function will compute a checksum which is appended to the data, and then the flag is negated.  The checksum will be compressed with the rest of the data, so that when the data is decompressed on the ground, the checksum can be recomputed and compared to provide a good indication of whether the decompressed copy of the data matches the original data set.",0
  The DPU-BOOT CSC shall provide the capability to automatically load a configuration of DPU-RTOS from EEPROM to DRAM and start its execution.,"Channel Boundary (CB) Engineering ModeThe purpose of Channel Boundary Mode is to derive the optimum channel boundary settings from a flat field. Detector events produced in the M,N detector mode are collected and histogrammed for a commanded integration time.  The pseudo Instrument Y is transmitted to the ground.  Channel boundaries are derived from the Instrument Y and transmitted to the ICU and the ground.  Channel boundaries are sent by the ICU to the BPE and used in the detector event centroiding process.",0
"A MODIS Computer Software Configuration Item (CSCI) is any independently tracked and configured unit of software within the MODIS SDP S/W, including processes, scripts, and utility libraries.  Each CSCI in the MODIS SDP S/W shall run in the ECS production environment.","Checksum LibraryA number of checksum algorithms are required by various system and application software modules.  In order to avoid duplication of code, the various checksum algorithms are encapsulated into a checksum library. ",0
" The DPU-DPA shall produce a Parameterized Finding Chart, PROD_FINDING_CHART, that is so many bytes.","Sending Messages to the ICUSome special processing and checking is required in this function to handle the transmission of the ACK/NAK message.  When a command arrives from the ICU, the icuiCmdReceiveISR() will verify the message checksum and then send an ACK/NAK message to the ICU.  It is possible that an application is in the midst of sending a message to the ICU at the time a command interrupt occurs.  However, since it is not possible for an ISR to take a semaphore, an additional mechanism is required in order to provide mutual exclusion between a task an the ISR.  To accommodate this problem, the icuiEnq() function first determines whether it is being invoked from interrupt context.  If so, it then tests the value of a static variable, icuiEnqBusy.  If the variable is set, the function will save the given ACK/NAK message parameters in static variables and return.  If the variable is not set, the function will continue as normal (avoiding the semTake() and semGive() calls).  In normal execution, the icuiEnqBusy variable is set on entry and negated on exit, after which the static variables containing the ACK/NAK message parameters will be checked to determine whether an ACK/NAK is pending.",0
 The DPU-SCUI shall rate-buffer the delivery of STPDUs to the SCU according to the SCU_BUFFER_RATE parameter provided during initialization.  The default value shall provide data to the SCU at a rate of X Kbps and shall be capable of being modified dynamically.,Public FunctionsThis routine is spawned by the Command and Control Task to initialize and execute the DPA Instrument Y Processing Task.,0
"A MODIS Computer Software Configuration Item (CSCI) is any independently tracked and configured unit of software within the MODIS SDP S/W, including processes, scripts, and utility libraries.  Each CSCI shall be coded according to thestandards specified in the MODIS Software Development Standards and Guidelines, SDST-022 .","Time SynchronizationThe time contained in the Clock Message is specified to be valid on the rising edge of the next 1PPS signal.  When the DPU receives the Clock Message, the 1553 ISR calls the tisTimeSync() function, forwarding the data portion of the clock message to the TIS CSC via the TIS_CLK_MSG data structure..  The tisTimeSync() function will immediately copy the spacecraft clock value to the DPU clock hardware registers. The DPU hardware is designed to latch in the new time on the rising edge of the next 1 PPS signal (the act of writing a new time to the hardware registers arms the latch function in the hardware).  Once the new time is latched, the hardware automatically disables the time latch function to avoid the potential of latching in an old time at the next 1 PPS signal.will be received within one second.  In the unlikely event a UT Delta is discarded, an event message is enqueued to ccmErrEnq() for informational purposes.",0
  The DPU-DPA shall be capable of collecting detector events over the full  FOV.,"process input data sets with the following nominal attributes: * Time transitions, including Greenwich Meridian crossing, leap year, beginning of the year, beginning of the millennium, and/or start of data collection not on a granule boundary. * Terminator crossing , International Date Line crossing, and/or Earth pole within a granule. Day, Night, or mixed  mode data.  ",0
  The DPU-DCI shall write to the DCI Registers in C-bit words only,"Telemetry Output to the Spacecraft 1553 BusThe SCU, which is a MIL-STD-1553 Bus Controller (BC), periodically reads the STPDU contained in the fifteen telemetry subaddresses, and then writes to the telemetry done subaddress.  When the telemetry done subaddress is written, the scuiTlmDoneISR() is called which gives a semaphore to awaken the scuiTask().  The software provides fault tolerance by automatically awaking after approximately two polling periods.  This timeout is automatically adjusted any time the SCU Poll Rate value is changed by command.",0
 The DPU-DCI shall provide an application program with the ability to toggle the hardware interface between Normal mode and Test mode.,"External Program InterfacesPerforms the SCM EDAC test, PROM checksum test, and device loopback tests for those devices which support it.",0
 The DPU-CCM shall use DPU-EEPRM to access the EEPROM.,"interrupt service routine (ISR)The DPU responds to interrupts via an interrupt service routine (ISR).  VME interrupts are prioritized; however the DPU does not allow nested interrupts, and so any interrupts which occur while servicing another interrupt will pend until the current ISR has returned.",0
" There shall be four engineering modes associated with the detector: raw event list mode, channel boundary mode, centroid confirmation mode, and intensifier characteristics mode.","InitializationThe ICUI CSC is initialized by calling icuiInit().  The icuiInit() function opens the SSI interface port to the ICU, installs the transmit and receive ISRs, and enables Transmit Message Mode in the SSI Driver CSC.  The icuiInit() function is called by the CCM Control Task at bootup.",0
  The Bootstrap Monitor of the DPU-BOOT CSC shall output an error message to the RS-232 interface if an invalid command argument option is entered.,Shall incorporate level1a_scan_flags into scan_quality flags.  ,0
  The DPU compression software shall forward compressed data  to DPU-SCUI.,"Public FunctionsThis routine provides a means to get the current data timeout value used by the DCI.  The returned value is the current timeout in milliseconds.The timeout is discussed in document 036911400, section 4.3.2.4.1.3.",0
All searchable product-specific metadata in MODIS standard products shall be formatted as specified in DID 311.,"initial boot sequencethe initial boot sequence, identified as Boot Sequence 1.  This processing takes place when the Bootstrap executes from Programmable Read-Only Memory (PROM).  Boot Sequence 1 is composed primarily of 4 steps as follows.First, in this sequence, EEPROM is updated.  Then, CPU BIT and a portion of DRAM BIT is performed.  Next, DRAM is cleared.  Lastly, Boot Sequence 2 is copied to DRAM and executed. During this sequence, the rest of DRAM is tested if skipBit is not set.  Load parameters are put into registers r13, r14, r15 and r16.  DRAM is cleared up to memSize.  Lastly, either the DPU-RTOS or the Bootstrap Monitor is loaded and executed according to the load parameters.",0
"  The DPU-ICUI shall check the length of a received DPU_CMD against the message length determined by the Inter-Block Gap.  If the received value does not match, then the command will be discarded, and an error will be enqueued to DPU-CCM, and a NAK message transmitted to the ICU within a second.","Error Collection and ReportingIn order to insure that error counts are not lost due to rollover, ccmErrEnq(), checks to insure that the count for a given error has not gone above 250 in one high rate housekeeping reporting period.  If the error count exceeds 250 for a particular reporting period, ccmErrEnq() will enqueue S_ccm_ERR_REPEAT error with the current error count and will clear its error tracking mechanism.",0
  The DPU-BIT shall test the Error Detection and Correction (EDAC) on the Company X Communication/Memory Module by reading preprogrammed error locations in PROM.,"Centroiding Confirmation (CC) Engineering ModeThe purpose of Centroiding Confirmation Engineering Mode is to determine the validity of derived channel boundaries. Detector events are collected and histogrammed for a commanded integration time.  The full field is divided into 8x8 sub-Instrument Ys, each of ExEcentroided (by 8) pixels.  These sub-Instrument Ys are then modulo binned to produce a set of 8x8 pixels pseudo-Instrument Ys.  The Instrument Ys are column (y axis) ordered, as are the pixels within them.  These pseudo Instrument Ys are transmitted to the ground.",0
  The  raw event list engineering mode shall collect events for transmission to the ground.,"Standard I/O InterfaceThe read() primitive does not block.  The read() primitive is implemented by simply passing its parameters to the tyLib function tyRead().The size of the Rx ring buffer is specified in the call to ssiDevCreate() as part of the device instantiation.This routine returns either the number of bytes read, or ERROR.",0
  The DPU-ADC shall read from the SCM registers in B-bit words only.,Intensifier Characteristics (IC) Engineering ModeThe purpose of Intensifier Characteristics Engineering Mode is to assess detector health and performance. Detector events produced in Full Frame High Resolution detector format are collected and histogrammed for a commanded integration time to produce a pulse-height histogram.,0
 The DPU-DPA shall be able to perform tracking based on data collected from the detector by calculating the spacecraft drift using successive tracking frames using the algorithm described in Appendix C.,Real-Time Clock InterfaceThis routine gets the value of the Real-Time Clock (RTC) Registers and places the results in variables rtcu and rtcl.,0
"  The DPU-CCM shall monitor the status of DPU-SCUI, DPU-CCM, DPU-DCX, DPU-TMALI, and DPU-DPA by examining their TASK_INFO and report this information in DPU_HK.","Public FunctionsThis routine is used to format messages for transmission to the ICU and to place those messages on the SSI Driver Transmitter Queue. The functionCode parameter is used to create the CCSDS Packet APID and the Message Identifier (refer to document DPUICD-01).  A mutual exclusion semaphore, icuiSemWrite, protects the SSI Driver from being written by multiple tasks simultaneously.  The timeout parameter lets the caller control how long it is willing to block on this semaphore if there is an access conflict.This routine may be called at interrupt context to transmit an ACK/NAK message.  In that case, the semaphore is not taken since it is not valid to take a semaphore at interrupt context.  Refer to discussion of the design to accommodate the ACK/NAK message.",0
The DPU-BOOT CSC shall disable write-protection of the EEPROM on the SCM.,"Public FunctionsThis routine provides a means to get the current data timeout value used by the DCI.  The returned value is the current timeout in milliseconds.The timeout is discussed in document 036911400, section 4.3.2.4.1.3.",0
  The DPU-DPA shall calculate drift with respect to the reference frame based on the established guide stars then perform a shift-and-add of the image mode data.,"Receiving Commands from the ICUThe interface to the ICU is via a synchronous serial interface (SSI) bus, which utilizes an inter-block gap (IBG) to delineate complete messages from one another.  The DPU hardware produces an interrupt when it detects an IBG, and the SSI Driver provides a mechanism by which an application can install an interrupt hook routine to respond to an IBG interrupt.  Upon initialization, the ICUI CSC installs a hook routine into the SSI Driver called icuiCommandReceiveISR(), which verifies the checksum of an incoming command, transmits an ACK/NAK message to the ICU, and then enqueues the command for later processing by calling ccmCmdEnq().  ",0
"  The DPU-CCM shall produce DPU_HK at a commandable rate, with a default of 10 seconds.",Shall generate data_input_status_messages if errors are encountered in reading Level_1B_Data.  ,0
Each software process shall perform quality checks on the input and output data and report on the degree to which the product conforms to instrument specification or science data accuracy specifications.,"Public FunctionsThis function gets the frame depth of the Ping-Pong buffers used by the DCI CSC.  The frame depth determines how many frames are read into the selected Ping-Pong buffer before interrupting.  The initial value for the frame depth setting is determined by the parameter provided when stating the tmaliTask.  The returned value is the current active value, this may differ from the last commanded value as the commanded value only takes effect when data is transferred from the hardware Ping-Pong buffer to the TMALI queue (in response to a frame or timeout interrupt, see section 5.13.2.3).",0
The DPU-BOOT CSC shall test and clear DRAM on power-on using the COLD_MEM_SIZE obtained from the SYSTEM_BLOCK.,"Data ProcessingThe DCX CSC is a task which receives data packages from other tasks, compresses the data using the VBTWL algorithm, and then forwards the compressed data package to the SCUI CSC.",0
  The DPU-TMALI shall provide a function which sets the current event bit ordering mode in the DCI driver.,Install Exception HandlersThis routine installs a hook routine for the Power Failure Interrupt.  The hook routine will be called from the interrupt context.  This function returns OK always.,0
  The DPU-CCM shall forward CLK_MSGs to the DPU-TIS for processing immediately upon receipt (I.e. shall not enqueue the message to the command dispatcher queue).,"remaining DPU FSW tasksFollowing startup, the Command and Control Task spawns the remaining DPU FSW tasks, which are described below:* The Command Dispatch Task (ccmCmdTask) is an Application Framework Software task which is responsible for dispatching commands which arrive from the ICU or the SCU.  Commands are executed directly by this task by calling the applicable CSC function* The SCU Interface Task (scuiDPTask) receives telemetry data from other tasks, converts them to CCSDS Version1 Source Packets, forms Company X Telemetry Protocol Data Units (STPDUs) from the Source Packets, and transmits the STPDUs to the SCU via the MIL-STD-1553B Interface.* The Telescope Module Event Transfer Task (tmaliTask) is an Application Framework Software task which is responsible for transferring data from the DCI ping/pong buffers to the TMALI data buffer in response to a DCI frame limit or data timeout interrupt.* The Data Compression Task (dcxTask) receives telemetry data from other tasks, uses a lossless data compression algorithm to compress the data, and then enqueues the data to the SCU Interface Task.* The Data Processing Algorithms Tasks (dpaIMTask and dpaEPTask) process incoming detector events according to the commanded mode, create data products, and enqueue those data products to the Data Compression Task (if compression is enabled) or to the SCU Interface Task.* The Error Detection and Correction Memory Scrubber Task (edacTask) cycles through the text and data segments of the DPU to trigger the correction of single-bit errors which may have occurred, in order to help prevent the occurrence of uncorrectable multiple-bit errors.",0
"  At the end of a download, the Bootstrap Monitor of the DPU-BOOT CSC shall compute a CHKS_32 on the X stored in EEPROM and compare it against the CHKS_32 sent with the X during the transfer.  The Bootstrap Monitor shall output to to the RS-232 interface both CHKS_32s and a message indicating whether the download was successful.",Standard I/O InterfaceSSI ioctl() commands.,0
"The DPU-BOOT CSC shall perform successive writes to a word page of EEPROM within C msecs, or wait a minimum of D usecs between successive writes.","Public FunctionsThis routine provides a means for the CCM task to send the Stop Mode command from the ICU to the DPA software. The Stop Mode command shall be used to command the DPU to immediately stop processing events, complete the current data product, purge events from the DPU hardware, and enter Idle Mode.  The data product will include the actual exposure time and the number of frames.  In response to this command, the DPU shall issue a Mode Complete command to the ICU after finishing the before-mentioned tasks.",0
The DPU-BOOT CSC shall initialize Error Detection and Correction (EDAC) on the RSC by clearing DRAM.,"Telemetry Output to the Spacecraft 1553 BusThe SCU, which is a MIL-STD-1553 Bus Controller (BC), periodically reads the STPDU contained in the fifteen telemetry subaddresses, and then writes to the telemetry done subaddress.  When the telemetry done subaddress is written, the scuiTlmDoneISR() is called which gives a semaphore to awaken the scuiTask().  The software provides fault tolerance by automatically awaking after approximately two polling periods.  This timeout is automatically adjusted any time the SCU Poll Rate value is changed by command.",0
  The DPU-RTOS shall provide a function to allow an application program to read from the Real-Time Clock registers on the RAD6000SC CPU Module.,Shall report errors as parameter_input_status_messages in log status message file through the use of SDP functions.  ,0
  The DPU-BIT shall perform two write/read/compare tests on the RAM for the MIL-STD-1553B.  The first test shall construct and write half-word (16-bit) values obtained by adding the upper and lower half-words of each each memory address.  The second test shall construct and write the ones complement of the half-word values used in the first test.,"InitializationThe SCUI CSC is initialized when the scuiTask() is spawned by the CCM CSC.  Initialization parameters which are passed into the scuiTask() include:* Poll Rate  rate at which the S/C will poll the DPU for telemetry.  The rate is specified in Hz, and has a default of X Hz based on the INSTRUMENT X-DPU poll rate in the Company X 1553 ICD.* Buffer Rate  value used to rate buffer data to the S/C.  The rate is specified in bits per telemetry poll, and has a default of 7664 which is equal to one STPDU per poll (*** bytes per STPDU times V bits/byte).  This default value effectively disables rate buffering.* Size of Low Priority Queue  size in bytes of the low priority telemetry queue.  If the amount requested cannot be allocated, the buffer will be allocated at  the amount of memory contained in the largest free memory block.Size of High Priority Queue  size in bytes of the high priority telemetry queue. If the amount requested cannot be allocated, the buffer will be allocated at  the amount of memory contained in the largest free memory block.",0
"  The DPU-DPA shall command DPU-TMALI to reorder EVENT data bits as a function of the Detector Electronics Output Format (Science Mode 3, Full-Frame High Res), and the commanded DPU science or engineering mode.  ","Setting Data Timeout in DCIDuring nominal operation, frames arrive approximately every 11 msecs.  The DCI hardware will generate an interrupt if event data has been received in one of the Ping-Pong buffers, and a configurable amount of time has passed during which no additional events have been received.  A data timeout interrupt is not an error, but rather typically indicates that the current exposure has been completed.  The data timeout interrupt allows the TMALI CSC to retrieve the trailing events from the DCI Ping-Pong buffer.  The function tmaliDciTimeoutSet() provides an API to the DCI Driver to allow the timeout setting to be altered.",0
 The DPU-SCUI shall communicate with the SCU according to the protocol defined in document 1143-EI-S19121.,"Event ProcessingIf the Mode command is Instrument Y Mode, the detector events are spatially filtered to the Instrument Y window specified in the Mode command then the corresponding pixel in the Ping or Pong buffer is incremented.  If specified in the Mode command, pixels will be binned at AxA or BxB.  Also, if specified in the Mode command, a tracking frame data product will be produced for every Ping/Pong tracking frame. Instrument Y and Event Mode may be commanded simultaneously in the Mode command. If the ICU sends an XRT Position command, the Instrument Y mode and Event Mode windows will be resized to match the new window sizes in the command.",0
Each MODIS standard data product shall be produced within the data volume and processing load allocation shown in Table B-1.,"Public FunctionsThis function gets the frame depth of the Ping-Pong buffers used by the DCI CSC.  The frame depth determines how many frames are read into the selected Ping-Pong buffer before interrupting.  The initial value for the frame depth setting is determined by the parameter provided when stating the tmaliTask.  The returned value is the current active value, this may differ from the last commanded value as the commanded value only takes effect when data is transferred from the hardware Ping-Pong buffer to the TMALI queue (in response to a frame or timeout interrupt, see section 5.13.2.3).",0
  The DPU-CCM shall strobe the Watchdog timer  by writing to the SCM_WDR at an interval of 1 second.,"Development PlatformThe DPU FSW will be implemented in the ANSI C programming language, with some PowerPC assembly used in the Bootstrap and to implement the VME data transfer in the DCI Driver.  The host (development) platform and operating system is Sun/Solaris from Sun Microsystems, Inc.  The target platform is the RAD6000 processor which has a POWER (PowerPC-like) architecture, and executes the VxWorks 5.3.1 real-time operating system.  The cross compiler and debugger is MULTI/C/C++ 1.8.9 from Green Hills Software, Inc.",0
"  When commanded to event mode by the ICU,  the DPU-DPA shall be capable of collecting time-tagged photon events and producing a PROD_EVENT.","Checksum Library This function performs a checksum on a specified memory range.  The checksum is performed as an 8-bit additive checksum, but the accumulated value is stored in a 16-bit variable.",0
  The DPU-BOOT CSC shall provide the capability to automatically load a configuration of DPU-RTOS from EEPROM to DRAM and start its execution.,Shall write Verify_MODIS_log_msgs to Log_messages when errors occur in the Verify_MODIS_header_info process. ,0
  The DPU-BOOT CSC shall log detected BIT failures to the SYSTEM_BLOCK.,Shall verify that the Spacecraft_indicator contained in the Level1A_Parameters is consistent with the Spacecraft_indicator found in the Level 0 file header.  ,0
 The DPU-TMALI  shall provide TMALI_HK to the DPU-CCM on request.,"Public FunctionsThis task initializes the TMALI CSC and then continues to read data from the DCI and store it in the TMALI buffer each time the DCI driver signals that data is available in the Ping-Pong buffer.  The availability of data in the DCI Ping-Pong buffer is signaled to the tmaliTask using a semaphore.  Unless a fatal error is detected during initialization this task will never terminate.The specified 3 parameters specify the size of the TMALI queue and the initial parameters for the DCI, if the specified values are outside the allowed range default values will be used.The specified QueueSize is the allocated buffersize (in 4 byte EVENTS), the ring buffer is full when QueueSize-1 EVENTS are stored in the buffer.",0
  The DPU-EDAC shall record the number of MBEs that have been detected in DRAM since boot and the address of the last two MBEs.,"Transmitting Telemetry to the SpacecraftThe SCUI CSC receives telemetry as input Data Packages via queues populated by other tasksthe Science Data Processing Task, the Data Compression Task, and the Command and Control Task.  The SCUI CSC has a High Priority Queue and a Low Priority Queue.  The two queues are implemented in an identical manner with the exception that the scuiTask() gives processing preference to the High Priority Queue.  The purpose of the High Priority Queue is to provide a means by which the Parameterized Finding Chart and DPU housekeeping can be transmitted to the SCU ahead of the potentially large amounts of buffered science data.",0
"  The DPU-RTOS shall exclude failed DRAM from the system memory pool based on the contents of the BIT_DRAM results in the SYSTEM_BLOCK.  The system memory table does not include the Interrupt Vector Table (IVT), nor the text and data segment.","Public FunctionsThis function sets the frame depth of the Ping-Pong buffers used by the DCI CSC.  The frame depth determines how many frames are read into the selected Ping-Pong buffer before interrupting.  The initial value for the frame depth setting is determined by the parameter provided when starting the tmaliTask.  The maximum value to which the frame depth can be commanded is 64 frames, an attempt to command the frame depth to a value larger than this maximum will result in setting the timeout to the default value of V frames.The actual setting of the frame depth could be delayed by a small amount of time if there is activity on the DCI bus, and is typically changed when the DCI has just reported a frame level reached or timeout condition.  This minimizes the chance of changing the setting while the hardware is close to detecting a frame event.  Changing the frame depth while the DCI CSC is processing data could cause unpredictable results.  When a new tmaliDciFrameDepthSet command is send before the previous setting has been activated the new request will overwrite the previous request and the DCI will be commanded to the new value at the first available opportunity.",0
" The DPU-ICUI shall install an ISR to be invoked on the SSI receiver interblock gap interrupt, for the receiving and processing of commands from the ICU.","Channel Boundary (CB) Engineering ModeThe purpose of Channel Boundary Mode is to derive the optimum channel boundary settings from a flat field. Detector events produced in the M,N detector mode are collected and histogrammed for a commanded integration time.  The pseudo Instrument Y is transmitted to the ground.  Channel boundaries are derived from the Instrument Y and transmitted to the ICU and the ground.  Channel boundaries are sent by the ICU to the BPE and used in the detector event centroiding process.",0
  The DPU-BOOT CSC shall log detected BIT failures to the SYSTEM_BLOCK.,"Structural DesignThe TIS CSC provides a library of functions to* initialize the DPU clock hardware at startup,* maintain synchronization of the DPU clock with the Spacecraft clock,* provide a function for use by other applications to retrieve the current values of the DPU clock and the UT Delta, and provide functions for use by the CCM command dispatcher to alter the configuration of the clock interface.",0
 The DPU-TMALI shall allocate a ring buffer of size specified by TMALI_BUFFER_SIZE provided during initialization for storing incoming frames of data.  The default buffer size shall be 15 MB.,"Error RecoveryExcept for the modification described in Sections 5.2.3.6, no further modifications to the existing task error-handling mechanisms are required. VxWorks? uses a global mechanism for returning status codes when errors occur.  This is accomplished  by using the task variable, errno (stored in the task control block).  Most VxWorks? functions return a STATUS value.  This value can either be OK or ERROR.  If a function returns ERROR, then the errno variable must indicate a specific error code.",0
"A MODIS Computer Software Configuration Item (CSCI) is any independently tracked and configured unit of software within the MODIS SDP S/W, including processes, scripts, and utility libraries.  Each CSCI within the MODIS SDP S/W systemshall employ the Earth Science Data and Information System (ESDIS)-supplied SDPTK mandatory functions to access the DAAC production environment and services.","Bootstrap MonitorThe Bootstrap Monitor checks entered commands for syntax and number of arguments, and displays an error message to the RS-232 interface if an invalid command or argument is entered.  A complete listing of these messages is given in document 7384-BSPS-01.",0
" The DPU-SCUI shall be capable of preparing one STPDU for delivery to the SCU every M milliseconds, or shall indicate a No Data condition to the SCU by maintaining an un-incremented ST_PDU Transfer Request Counter field."," Startup SequenceThe DPU FSW is booted using PROM-resident bootstrap software.  The bootstrap software performs a basic set of built-in tests, then copies the DPU FSW from EEPROM to DRAM and executes it.  In flight, there are two methods which can trigger the DPU FSW to boot:* power-on (cold boot), or* watchdog reset (warm boot, commanded reboot).",0
 The DPU-TMALI  shall provide TMALI_HK to the DPU-CCM on request.,"Public FunctionsThis routine provides a means to set the data timeout used by the DCI, the value requested indicates the timeout in milliseconds.  The initial value for the frame depth setting is determined by the parameter provided when starting the tmaliTask.  The maximum value to which the timeout can be commanded is X seconds, an attempt to set the timeout to a number larger than this maximum will result in setting the timeout to the default value of X milliseconds",0
"  The DPU-CCM shall check the length of a received DPU_CMD against an expected value from a lookup table indexed by FUNCTION code.  If the received value does not match the expected, then the command will be discarded, and an error will be enqueued.",Synchronous Serial Interface Driver CSCThe Synchronous Serial Interface (SSI) Driver CSC is a new driver which provides an application layer interface to the SSI hardware.  The SSI Driver CSC is implemented on top of the VxWorks tyLib library to manage its ring buffers.   The driver features a standard I/O interface which utilizes an extended ioctl() command set to support unique SSI hardware attributes.  This driver is patterned after the older VxWorks 5.2 serial driver architecture rather than the newer Tornado serial driver architecture due to the lack of programmer control over I/O in the newer Tornado driver architecture. ,0
  The DPU-BOOT CSC shall provide a monitor which accepts commands over the RS-232 interface.,"Sending Messages to the ICUSome special processing and checking is required in this function to handle the transmission of the ACK/NAK message.  When a command arrives from the ICU, the icuiCmdReceiveISR() will verify the message checksum and then send an ACK/NAK message to the ICU.  It is possible that an application is in the midst of sending a message to the ICU at the time a command interrupt occurs.  However, since it is not possible for an ISR to take a semaphore, an additional mechanism is required in order to provide mutual exclusion between a task an the ISR.  To accommodate this problem, the icuiEnq() function first determines whether it is being invoked from interrupt context.  If so, it then tests the value of a static variable, icuiEnqBusy.  If the variable is set, the function will save the given ACK/NAK message parameters in static variables and return.  If the variable is not set, the function will continue as normal (avoiding the semTake() and semGive() calls).  In normal execution, the icuiEnqBusy variable is set on entry and negated on exit, after which the static variables containing the ACK/NAK message parameters will be checked to determine whether an ACK/NAK is pending.",0
 The DPU-TMALI  shall provide TMALI_HK to the DPU-CCM on request.,"Standard I/O InterfaceThe write primitive does not block.  The buffer passed to write is written directly to the active portion of the ping pong buffer by the driver.  This primitive is valid only in TEST mode.  The write call will set errno to S_dci_MODE_ERROR and return ERROR if the driver is in NORMAL mode.  In TEST mode, the driver returns the number of bytes written.",0
  The DPU-BIT shall perform two write/read/compare tests on the RAM for the DCI Data Buffers.  The first test shall write the address of each location to that location.  The second test shall write the ones complement of the values used in the first test.,"InitializationThe ICUI CSC is initialized by calling icuiInit().  The icuiInit() function opens the SSI interface port to the ICU, installs the transmit and receive ISRs, and enables Transmit Message Mode in the SSI Driver CSC.  The icuiInit() function is called by the CCM Control Task at bootup.",0
Each MODIS standard data product shall be produced within the data volume and processing load allocation shown in Table B-1.,Install Exception HandlersThis routine is a default interrupt handler and is installed into element six (6) of the system interrupt table.,0
  The DPU-ADC shall write to the SCM registers in B-bit words only.,"Public FunctionsThis routine is spawned by the Command and Control Task to initialize and execute the SCU Interface Data Processor Task.  This task initializes the SCUI CSC and then enters an infinite loop to process telemetry and produce STPDUs.  Once initialized, the task is awakened by a semaphore given when the SCU writes the telemetry done subaddress.",0
  The DPU-TMALI shall provide a function which sets the current event bit ordering mode in the DCI driver.,"Receiving Commands from the ICUThe interface to the ICU is via a synchronous serial interface (SSI) bus, which utilizes an inter-block gap (IBG) to delineate complete messages from one another.  The DPU hardware produces an interrupt when it detects an IBG, and the SSI Driver provides a mechanism by which an application can install an interrupt hook routine to respond to an IBG interrupt.  Upon initialization, the ICUI CSC installs a hook routine into the SSI Driver called icuiCommandReceiveISR(), which verifies the checksum of an incoming command, transmits an ACK/NAK message to the ICU, and then enqueues the command for later processing by calling ccmCmdEnq().  ",0
  The Bootstrap Monitor of the DPU-BOOT CSC shall provide the capability to load a configuration of the DPU-RTOS from EEPROM to DRAM and start its execution on command.,"Public FunctionsThis routine is used to format messages for transmission to the ICU and to place those messages on the SSI Driver Transmitter Queue. The functionCode parameter is used to create the CCSDS Packet APID and the Message Identifier (refer to document DPUICD-01).  A mutual exclusion semaphore, icuiSemWrite, protects the SSI Driver from being written by multiple tasks simultaneously.  The timeout parameter lets the caller control how long it is willing to block on this semaphore if there is an access conflict.This routine may be called at interrupt context to transmit an ACK/NAK message.  In that case, the semaphore is not taken since it is not valid to take a semaphore at interrupt context.  Refer to discussion of the design to accommodate the ACK/NAK message.",0
  The DPU-BOOT CSC shall display a message via RS-232 on detection of a BIT failure.,"Initialization The task invokes the initialization function scuiInit() which sets an instance variable, allocates ring buffers and semaphores for the Low and High Priority Telemetry Queues, initializes a buffer and semaphore for pending RT-RT command messages, creates the scuiTask() wakeup semaphore, initializes internal data structures, opens and initializes file descriptors for each of the required MIL-STD-1553 subaddresses and installs ISRs.  When the CCM CSC spawns the scuiTask(), it will block on a semaphore (ccmSemScuiSpawn) awaiting SCUI initialization.  Once initialization is complete, the SCUI CSC will signal successful initialization by giving the semaphore, and then write an empty STPDU to the 1553 shared memory.",0
All searchable product-specific metadata in MODIS standard products shall be formatted as specified in DID 311.,"Public FunctionsInitializes the TIS CSC by initializing the hardware register convenience pointers and selecting the commanded 1PPS signal, and enables or disables automatic time synchronization with the S/C according to the passed parameter. THIS FUNCTION ALTERS THE VALUE OF THE DCI CSR AND SHOULD NOT BE INVOKED WHEN DCI INTERRUPTS ARE ACTIVE.",0
  The DPU-DPA will obtain the initial tracking frame time from the ICU.,Public FunctionsThis routine is spawned by the Command and Control Task to initialize and execute the DPA Event Processing Task.,0
"Each software process shall be able to process input data sets with the following nominal attributes: Time transitions, including Greenwich Meridian crossing, leap year, beginning of the year, beginning of the millennium, and/or startof data collection not on a granule boundary.  Terminator crossing , International Date Line crossing, and/or Earth pole within a granule.  Day, Night, or mixed  mode data.","Public FunctionsThis routine provides a means to set the bit arrangement used by the DCI.  When bSpecialArrangement is TRUE, the DCI is set to special bit arrangement mode, otherwise the default mode of no rearrangement is set.",0
" The channel boundary engineering mode shall create an array of look-up table (LUT) channel boundaries, PROD_CHAN_BOUND, from a flat field, and PROD_MN_DATA, using the algorithm described in Appendix C.",Control and MonitoringThe DPU produces eight types of housekeeping packets.,0
"  The DPU-DPA shall collect event mode data, preserving the time and spatial resolution in the specified event window.",Generic VME Driver CSCThe Generic VME (GVME) Driver CSC is a Level 1 reuse component from the INSTRUMENT Y project.  The GVME Driver provides a set of convenience routines which are useful when accessing registers and memory in the VME memory space.,0
 The DPU-SCUI  shall be capable of packing created CCSDS Source Packets into STPDUs using segmented (grouped) packets for transfer to the SCU as defined by CCSDS-102.0-B-4 and in accordance with interface control document 1143-EI-S19121.,Checksum LibraryThis function performs a checksum on a specified memory range.  The checksum is performed as a 32-bit additive checksum.,0
  The DPU-SSI shall read from the SSI registers in 16-bit words only.,Data Capture Interface Driver CSCThe Data Capture Interface (DCI) Driver CSC is a new driver which provides a standard VxWorks driver interface to the DCI hardware.  The driver features two modes: a test mode and a normal mode.,0
The DPU-BOOT CSC shall test and clear DRAM on power-on using the COLD_MEM_SIZE obtained from the SYSTEM_BLOCK.,Shall write Verify_CCSDS_log_msgs to Log_messages when errors occur in the Verify_CCSDS_header_info process.  ,0
  The DPU-CCM shall quietly discard any unrecognized observatory messages (I.e. messages which do not have a DPU command APID).,"InitializationThe SCUI CSC is initialized when the scuiTask() is spawned by the CCM CSC.  Initialization parameters which are passed into the scuiTask() include:* Poll Rate  rate at which the S/C will poll the DPU for telemetry.  The rate is specified in Hz, and has a default of X Hz based on the INSTRUMENT X-DPU poll rate in the Company X 1553 ICD.* Buffer Rate  value used to rate buffer data to the S/C.  The rate is specified in bits per telemetry poll, and has a default of 7664 which is equal to one STPDU per poll (*** bytes per STPDU times V bits/byte).  This default value effectively disables rate buffering.* Size of Low Priority Queue  size in bytes of the low priority telemetry queue.  If the amount requested cannot be allocated, the buffer will be allocated at  the amount of memory contained in the largest free memory block.Size of High Priority Queue  size in bytes of the high priority telemetry queue. If the amount requested cannot be allocated, the buffer will be allocated at  the amount of memory contained in the largest free memory block.",0
" The DPU-SCUI shall cancel the write to each subaddress if the SCU fails to read a pending STPDU after a timeout specified by a value calculated based on the SCU_POLL_RATE parameter provided during initialization, shall record new data to those subaddresses, and report an error to the DPU-CCM.  The SCU_POLL RATE parameter shall have a default setting of J ms and shall be capable of being modified dynamically.",Shall generate data_input_status_messages and set scan_quality_flags if corrupted data values are detected.  ,0
 The DPU-TMALI shall install a callback routine to respond to the DCI Error Interrupt.,"Public FunctionsThis routine gets housekeeping data stored for the TMALI CSC including some DCI parameters and resets the tmali internal counters to zero.  When the caller supplied pointer to a TMALI_HK structure is NIL no data is returned but the tmali internal counters are still reset to zero.Two of the four error counters are updated within an ISR context, this requires a task switch safe implementation of these counters.  Within VxWorks this could be solved using a counting semaphore.  In the TMALI CSC design a faster method was used by using a free running error counter and a careful update of the reported number of errors, using an extra temporary variable.  As the increment and assignment of the 32 bit unsigned integers themselves are atomic operations the resulting counters are task safe and no error events are lost.  This means that the sum of the errors reported by the tmaliHkGet() function is equal to the total numbers of errors that occurred, no error reports are lost due to the update of the internal structures.",0
Each software process shall trap and properly process all exceptions that may produce an abnormal terminationand report all such events using the SDPTK error message functions.,Hardware InterfacesThe SSI Driver CSC accesses each of the registers on the Company X Communications module using D16 VME access.,0
  The DPU-TMALI shall provide a function which sets the current event bit ordering mode in the DCI driver.,"Time Interface ConfigurationThe DPU hardware provides two configuration options to the software:* selection of the active A PPS signal, and* the option to manually jam a value into the clock registers without the A PPS signal.",0
  The DPU-DCI shall provide an application program with the ability to read and write the hardware ping-pong buffers when in Test Mode.,InitializationThe DPA CSC is initialized by spawning the tasks dpaEventTask() and dpaInstrument YTask().  After the tasks are spawned they create the needed memory buffers.  The dpaEventTask() then enters the Idle state waiting for a Mode command from the ICU.  The dpaInstrument YTask also enters the Idle state waiting to process either the Ping or Pong buffer.  The default setting for compression (on or off) is retrieved from EEPROM.,0
"  The Intensifier Characteristics Engineering mode shall produce a pulse-height histogram, PROD_INTENSE_CHAR.","Memory Upload and Download HandlingIf more than 65535 bytes need to be uploaded, the upload file must be broken up into multiple smaller files, each less than or equal to 65535 bytes, and then each of the virtual uploads should be sent in series.  Because of the sequence numbers, the DPU FSW can receive individual upload commands out of sequence.  There is no time limit for the accomplishment of a single virtual upload, and so a long upload can continue across ground contacts.  If an upload is in progress, the last sequence number can be sent to the DPU FSW and it will report the list of missing sequence numbers via event number S_ccm_MISSING_SEQNO.  If an upload is in progress and needs to be cancelled, it can be discarded by issuing the D_MEM_DAT_CNCL command.",0
"  The DPU-DPA shall collect event mode data, preserving the time and spatial resolution in the specified event window.",SCU Interface CSCThis CSC performs rate-buffering of the downlink telemetry to the SCU according to a commandable parameter.  The rate at which the SCU polls the DPU is also commandable.  The CSC installs an ISR to collect telecommands from the SCU via the MILSTD1553B Interface.,0
"  The DPU-BOOT CSC shall include a CPU BIT consisting of a branch test, a fixed point test, a floating point test, an interrupt test, a timer test, and a register test.","Public FunctionsThe routine formats the given data into a CCSDS Telecommand Packet and writes it to the 1553 bus shared memory for transmission to the SCU.  If a message is already pending in the 1553 shared memory, the pending messages will be replaced in 1553 shared memory with the new message, and an error will be reported.",0
" There shall be four engineering modes associated with the detector: raw event list mode, channel boundary mode, centroid confirmation mode, and intensifier characteristics mode.","Hardware InterfacesThe DPU-BOOTSTRAP must interface directly with the EEPROM on the Company X Communication Module.  The DPU-BOOTSTRAP accesses EEPROM as ?-bit words only.  The specific timing requirements of the EEPROM are satisfied in one of three ways:* the timing requirements are met by inserting specific wait loops (typical),* the timing requirements are met by use of the EEPROM Driver (DOWNLOAD command), andthe timing requirements are met implicitly by the amount of time which will be required to execute the intervening instructions regardless of the CPU speed setting (DRAM test logic).",0
  The DPU-SSI shall provide the capability for an application program to enable/disable the VME Slave Interrupt on the SCM for the SSI Interface.," Startup SequenceThe DPU FSW is booted using PROM-resident bootstrap software.  The bootstrap software performs a basic set of built-in tests, then copies the DPU FSW from EEPROM to DRAM and executes it.  In flight, there are two methods which can trigger the DPU FSW to boot:* power-on (cold boot), or* watchdog reset (warm boot, commanded reboot).",0
  The DPU-DCI shall write to the DCI Registers in C-bit words only,"Error Collection and ReportingAt boot time, no error queue exists because it has yet to be created.  Errors that occur in this early stage of error reporting are assigned directly to the global task variable errno.  The reader may refer to the VxWorks Programmers Guide, section 2.3.7 for more information on errno.  If errno is set after the error queues are created, it is queued to the Error Queue by calling ccmErrEnq(). ",0
"  The Bootstrap Monitor of the DPU-BOOT CSC shall provide the capability to write to Dynamic Random Access Memory (DRAM), the VME bus, and the Input/Output Channel Controller (IOCC) on command.","Event ProcessingThe Event Processor Task, after receiving a Mode command from the ICU, configures the DPU DCI hardware, responds to the ICU with a Mode Ready message then receives detector events by calling functions tmaliWait() and tmaliNextEvent().  The Event Processor Task will collect detector events for the time period specified in the Mode command then issue a Mode Complete message to the ICU.  After issuing the Mode Complete message, the Event Processor Task will enter the Idle state.",0
 The DPU compression software shall report errors to the DPU-CCM for inclusion in the DPU Housekeeping information.,"Memory Upload and Download HandlingData can be upload to several types of locations, including* DRAM* EEPROM* hardware registers, and* EEPROM filesystem.ial D_MEM_DAT_UPLD command specify the target location.  If the destination is the EEPROM filesystem, a block number is provided in lieu of a memory address , which is used by the DPU FSW to formulate a filename of the form eefs1:DPU_blk.##, where ## is the block number.  In this case, once the entirety of the uploaded data is received by the DPU FSW, the uploaded data is then written to that file in the EEPROM filesystem.  If a file already exists with that name, it is overwritten.  The EEPROM filesystem can be reinitialized using the command D_MEM_DISK_INIT.",0
" There shall be four engineering modes associated with the detector: raw event list mode, channel boundary mode, centroid confirmation mode, and intensifier characteristics mode.","Checksum Library This function performs a checksum on a specified memory range.  The checksum is performed as an 8-bit additive checksum, but the accumulated value is stored in a 16-bit variable.",0
"  The Bootstrap CSC shall address hardware modules as defined in document 1400, Company X Specification for the Company X Communication/Memory Module.",Checksum LibraryThis function performs a checksum on a specified memory range.  The checksum is performed as a 32-bit additive checksum.,0
  The centroid confirmation engineering mode shall produce a PROD_CENTROID_CONF.  This mode shall divide a full frame image into a certain regions.  Each region shall be processed to form an 8x8 confirmation image.  The certain confirmation images shall be sent to the solid state recorder as one data product.,"External Program InterfacesPerforms the SCM EDAC test, PROM checksum test, and device loopback tests for those devices which support it.",0
" The DPU-SCUI  shall provide the capability to handle high priority data.  High priority data shall be processed before low priority data.  In the condition  that low priority data is being processed when new high priority data arrives, DPU-SCUI shall finish processing the low priority data and then  immediately shift all resources to processing the high priority data.","Memory Upload and Download HandlingIf more than 65535 bytes need to be uploaded, the upload file must be broken up into multiple smaller files, each less than or equal to 65535 bytes, and then each of the virtual uploads should be sent in series.  Because of the sequence numbers, the DPU FSW can receive individual upload commands out of sequence.  There is no time limit for the accomplishment of a single virtual upload, and so a long upload can continue across ground contacts.  If an upload is in progress, the last sequence number can be sent to the DPU FSW and it will report the list of missing sequence numbers via event number S_ccm_MISSING_SEQNO.  If an upload is in progress and needs to be cancelled, it can be discarded by issuing the D_MEM_DAT_CNCL command.",0
  The DPU-BOOT CSC shall attempt to complete its normal execution sequence following detection of any failure.,"Control and Monitoringthe CCM Control Task initializes the DPU FSW. It is the responsibility of the CCM Control Task to establish a successful boot.  It does so by blocking on temporary semaphores, each with a 5 second timeout, after spawning the SCU Interface Task and the CCM Command Task.  If both of these tasks report a successful initialization by giving the semaphore, the CCM Control Task toggles the BC_INDEX parameter in EEPROM to indicate a successful boot.  If either task does not report a successful initialization, the CCM Control Task disables the watchdog strobe to effect a reboot of the DPU.  The rationale for selecting the successful initialization of these two tasks as the definition of a successful boot is that the DPU FSW requires these tasks, as a minimum, to establish ground contact and provide commandability.Once this initialization is complete, the task blocks on a binary semaphore which is given by the SCUI Command ISR upon arrival of the 1 Hz Clock Message.  In the event a Clock Message does not arrive, the semaphore will time out after 1.5 seconds.  The CCM Control Task remains alive to create and transmit DPU housekeeping at the appropriate intervals, perform various periodic processing tasks, and to process memory dump commands.The final call to ccmErrEnq() is performed in order that if an error occurs in an interrupt service routine, a global variable is set to the value of the errno which is then enqueued into the Error/Event Queue as part of this tasks normal processing.",0
  The DPU-BIT shall test the Error Detection and Correction (EDAC) on the Company X Communication/Memory Module by reading preprogrammed error locations in PROM.,Watchdog LibraryThe DPU contains a hardware watchdog which must be strobed periodically in order to prevent a DPU reboot.  ,0
